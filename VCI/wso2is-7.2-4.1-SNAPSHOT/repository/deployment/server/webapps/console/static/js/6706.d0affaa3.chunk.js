"use strict";(self.webpackChunk_wso2is_console=self.webpackChunk_wso2is_console||[]).push([[6706],{86692:(e,n,t)=>{t.d(n,{Z:()=>o});var r=t(96124),i=t(6833);const o=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=arguments.length>1?arguments[1]:void 0,t=arguments.length>2?arguments[2]:void 0,o={headers:{Accept:"application/json","Content-Type":"application/json"},method:i.f2.GET,params:{attributes:t,filter:n},url:("".concat(window.AppUtils.getServerOriginWithTenant(!1),"/api/server/v1/meta/api-resource-collections/:id"),"".concat(window.AppUtils.getServerOriginWithTenant(!1),"/api/server/v1/meta/api-resource-collections"))},a=(0,r.Z)(e?o:null,{shouldRetryOnError:!1}),l=a.data,s=a.error;return{data:l,error:s,isLoading:!s&&!l,isValidating:a.isValidating,mutate:a.mutate}}},76706:(e,n,t)=>{t.d(n,{Z:()=>ie});var r=t(87449),i=t(17652),o=t(38480),a=t(27044),l=t(53080),s=t(264),c=t(3001),u=t(69837),d=t(17308),m=t(26653),p=t(5466),f=t(43800),v=t(50342),b=t(17901),y=t(90302),g=t(21257),h=t(47513),E=t(65170),Z=t(38088),O=t(64704),w=t(50699),S=t(80305),N=t(4438),A=t(86126),C=t(44194),R=t(10479),j=t(47245),x=t(86692),z=t(23852),T=function(e){return e.TENANT="tenant",e.ORGANIZATION="organization",e}({}),k=t(83476),P=t(51835),I=t.n(P),_=t(27975),L=t.n(_),M=t(55900),G=t.n(M),U=t(21555),V=t.n(U),D=t(3621),F=t.n(D),q=t(5062),J=t.n(q),W=t(47527),$={};$.styleTagTransform=J(),$.setAttributes=V(),$.insert=G().bind(null,"head"),$.domAPI=L(),$.insertStyleElement=F();I()(W.Z,$);W.Z&&W.Z.locals&&W.Z.locals;function B(e){return B="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},B(e)}function H(e){return function(e){if(Array.isArray(e))return ne(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||ee(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function K(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function Q(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?K(Object(t),!0).forEach((function(n){X(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):K(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function X(e,n,t){return(n=function(e){var n=function(e,n){if("object"!=B(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,n||"default");if("object"!=B(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"==B(n)?n:n+""}(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function Y(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var r,i,o,a,l=[],s=!0,c=!1;try{if(o=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;s=!1}else for(;!(s=(r=o.call(t)).done)&&(l.push(r.value),l.length!==n);s=!0);}catch(e){c=!0,i=e}finally{try{if(!s&&null!=t.return&&(a=t.return(),Object(a)!==a))return}finally{if(c)throw i}}return l}}(e,n)||ee(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ee(e,n){if(e){if("string"==typeof e)return ne(e,n);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?ne(e,n):void 0}}function ne(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,r=Array(n);t<n;t++)r[t]=e[t];return r}var te="tenant-permissions",re="organization-permissions";const ie=function(e){var n,t,P,I,_,L,M=e.isReadOnly,G=e.defaultExpandedIfPermissionsAreSelected,U=e.initialValues,V=e.onPermissionsChange,D=e["data-componentid"],F=void 0===D?"create-console-role-wizard-basic-info-form":D,q=(0,R.$)().t,J=(0,x.Z)(!0,"type eq tenant","apiResources").data,W=(0,x.Z)(!0,"type eq organization","apiResources").data,$=(0,j.v9)((function(e){return e.config.ui.features})),B=Y((0,C.useState)([]),2),K=B[0],X=B[1],ee=Y((0,C.useState)(U||{organization:{},tenant:{}}),2),ne=ee[0],ie=ee[1],oe=(0,g.z)().isSubOrganization;(0,C.useEffect)((function(){if(U&&(ie(U),G)){var e=[];(0,w.Z)(U.tenant)||e.push(te),(0,w.Z)(U.organization)||e.push(re),X(e)}}),[U]);var ae=(0,C.useMemo)((function(){var e=(0,S.Z)($,(function(e){return(0,N.Z)(e,["subFeatures"])})),n=(0,Z.Z)((0,E.Z)((0,A.Z)($),(function(e){return Object.entries(e.subFeatures||{})})));return Q(Q({},e),n)}),[$]),le=(0,C.useMemo)((function(){var e;if(!J)return null;var n=(0,h.Z)(J),t=[];return t.push(z.S.ROLE_V1_API_RESOURCES_COLLECTION_NAME),n.apiResourceCollections=null==n||null===(e=n.apiResourceCollections)||void 0===e?void 0:e.filter((function(e){var n,r;return!t.includes(null==e?void 0:e.name)&&((null==ae||null===(n=ae[null==e?void 0:e.name])||void 0===n?void 0:n.enabled)||(null==ae||null===(r=ae[y.r.CONSOLE_FEATURE_MAP[null==e?void 0:e.name]])||void 0===r?void 0:r.enabled))})),n}),[J,ae]),se=(0,C.useMemo)((function(){var e;if(!W)return null;var n=(0,h.Z)(W),t=[];return t.push(z.S.ORG_ROLE_V1_API_RESOURCES_COLLECTION_NAME),n.apiResourceCollections=null==n||null===(e=n.apiResourceCollections)||void 0===e?void 0:e.filter((function(e){return!t.includes(null==e?void 0:e.name)})),n}),[W]),ce=function(e){return function(n,t){X(t?[].concat(H(K),[e]):K.filter((function(n){return n!==e})))}},ue=function(e,n){var t=(0,h.Z)(ne);n===T.TENANT?e.target.checked?t.tenant=((null==le?void 0:le.apiResourceCollections)||[]).reduce((function(e,n){return e[n.id]={permissions:(0,k.Z)(n.apiResources.read),read:!0,write:!1},e}),{}):t.tenant={}:e.target.checked?t.organization=((null==se?void 0:se.apiResourceCollections)||[]).reduce((function(e,n){return e[n.id]={permissions:(0,k.Z)(n.apiResources.read),read:!0,write:!1},e}),{}):t.organization={},ie(t),de(t)},de=function(e){var n=new Set;Object.keys(e).forEach((function(t){var r=e[t];Object.keys(r).forEach((function(e){var t=r[e];t.permissions&&t.permissions.length>0&&t.permissions.forEach((function(e){n.add(JSON.stringify(e))}))}))}));var t=Array.from(n).map((function(e){return JSON.parse(e)}));V(t)},me=function(e,n,t){var r=n.id,i=n.apiResources,o=(0,h.Z)(ne);e.target.checked?o[t][r]={permissions:(0,k.Z)(i.read),read:!0,write:!1}:delete o[t][r],ie(o),de(o)},pe=function(e,n,t,r){var i=n.id,o=n.apiResources,a=(0,h.Z)(ne);a[r][i]={permissions:(0,k.Z)(o[t]),read:"read"===t,write:"write"===t},ie(a),de(a)};return C.createElement("div",{className:"create-console-role-wizard-permissions-form","data-componentid":F},!oe()&&C.createElement("div",{className:"accordion-container"},C.createElement(u.Z,{elevation:0,expanded:K.includes(te),onChange:ce(te),className:"tenant-permissions-accordion"},C.createElement(m.Z,{expandIcon:C.createElement(b.v4,null),"aria-controls":"tenant-permissions-content",id:"tenant-permissions-header"},C.createElement(p.Z,{readOnly:M,disabled:M,color:"primary",checked:Object.keys(ne.tenant).length===(null==le||null===(n=le.apiResourceCollections)||void 0===n?void 0:n.length),onChange:function(e){ue(e,T.TENANT)},inputProps:{"aria-label":"Select all tenant permissions"}}),C.createElement(v.Z,{className:"permissions-accordion-label"},q("consoleSettings:roles.add.tenantPermissions.label")),C.createElement(v.Z,{variant:"body2"},null==le||null===(t=le.apiResourceCollections)||void 0===t?void 0:t.length," Permissions")),C.createElement(d.Z,null,C.createElement(a.Z,{component:f.Z,elevation:0},C.createElement(r.Z,{className:"permissions-table",size:"small","aria-label":"tenant permissions table"},C.createElement(i.Z,null,null==le||null===(P=le.apiResourceCollections)||void 0===P?void 0:P.map((function(e){var n;return C.createElement(l.Z,{key:e.id,className:"permissions-table-data-row"},C.createElement(o.Z,{padding:"checkbox"},C.createElement(p.Z,{readOnly:M,disabled:M,color:"primary",checked:Object.keys(ne.tenant).includes(e.id),onChange:function(n){return me(n,e,T.TENANT)},inputProps:{"aria-label":"Select ".concat(e.displayName," permission")}})),C.createElement(o.Z,{component:"th",scope:"row"},e.displayName),C.createElement(o.Z,{align:"right"},C.createElement(c.Z,{disabled:M,value:Object.keys(ne.tenant).includes(e.id)?null!==(n=(0,O.Z)(ne.tenant,e.id))&&void 0!==n&&n.write?"write":"read":null,exclusive:!0,onChange:function(n,t){t&&pe(0,e,t,T.TENANT)},"aria-label":"text alignment",size:"small"},C.createElement(s.Z,{value:"read","aria-label":"left aligned"},q("consoleSettings:roles.permissionLevels.view")),C.createElement(s.Z,{value:"write","aria-label":"right aligned"},q("consoleSettings:roles.permissionLevels.edit")))))})))))))),C.createElement("div",{className:"accordion-container"},C.createElement(u.Z,{elevation:0,expanded:K.includes(re),onChange:ce(re),className:"organization-permissions-accordion"},C.createElement(m.Z,{expandIcon:C.createElement(b.v4,null),"aria-controls":"panel1bh-content",id:"panel1bh-header"},C.createElement(p.Z,{readOnly:M,disabled:M,color:"primary",checked:Object.keys(ne.organization).length===(null==se||null===(I=se.apiResourceCollections)||void 0===I?void 0:I.length),onChange:function(e){ue(e,T.ORGANIZATION)},inputProps:{"aria-label":"Select all organization permissions"}}),C.createElement(v.Z,{className:"permissions-accordion-label"},q("consoleSettings:roles.add.organizationPermissions.label")),C.createElement(v.Z,{variant:"body2"},null==se||null===(_=se.apiResourceCollections)||void 0===_?void 0:_.length," Permissions")),C.createElement(d.Z,null,C.createElement(a.Z,{component:f.Z,elevation:0},C.createElement(r.Z,{className:"permissions-table",size:"small","aria-label":"organization permissions table"},C.createElement(i.Z,null,null==se||null===(L=se.apiResourceCollections)||void 0===L?void 0:L.map((function(e){var n;return C.createElement(l.Z,{key:e.id,className:"permissions-table-data-row"},C.createElement(o.Z,{padding:"checkbox"},C.createElement(p.Z,{readOnly:M,disabled:M,color:"primary",checked:Object.keys(ne.organization).includes(e.id),onChange:function(n){return me(n,e,T.ORGANIZATION)},inputProps:{"aria-label":"Select ".concat(e.displayName," permission")}})),C.createElement(o.Z,{component:"th",scope:"row"},e.displayName),C.createElement(o.Z,{align:"right"},C.createElement(c.Z,{disabled:M,value:Object.keys(ne.organization).includes(e.id)?null!==(n=(0,O.Z)(ne.organization,e.id))&&void 0!==n&&n.write?"write":"read":null,exclusive:!0,onChange:function(n,t){pe(0,e,t,T.ORGANIZATION)},"aria-label":"text alignment",size:"small"},C.createElement(s.Z,{value:"read","aria-label":"left aligned"},q("consoleSettings:roles.permissionLevels.view")),C.createElement(s.Z,{value:"write","aria-label":"right aligned"},q("consoleSettings:roles.permissionLevels.edit")))))})))))))))}},83476:(e,n,t)=>{t.d(n,{Z:()=>r});const r=function(e){return e.map((function(e){return e.scopes.map((function(e){return{value:e.name}}))})).reduce((function(e,n){return e.concat(n)}),[])}},47527:(e,n,t)=>{t.d(n,{Z:()=>l});var r=t(81611),i=t.n(r),o=t(83948),a=t.n(o)()(i());a.push([e.id,".create-console-role-wizard-permissions-form{margin-top:20px}.create-console-role-wizard-permissions-form .oxygen-accordion{border:1px solid var(--oxygen-palette-divider);margin:10px 0}.create-console-role-wizard-permissions-form .oxygen-accordion .permissions-accordion-label{width:40%;flex-shrink:0}.create-console-role-wizard-permissions-form .oxygen-accordion .permissions-table .permissions-table-data-row:last-child td,.create-console-role-wizard-permissions-form .oxygen-accordion .permissions-table .permissions-table-data-row:last-child th{border:none}.create-console-role-wizard-permissions-form .oxygen-accordion .oxygen-accordion-summary .MuiAccordionSummary-content{display:flex;flex-direction:row;flex-wrap:nowrap;align-content:center;align-items:center;justify-content:flex-start}.create-console-role-wizard-permissions-form .accordion-container .oxygen-accordion.Mui-expanded:first-of-type{margin-top:10px}",""]);const l=a}}]);