"use strict";(self.webpackChunk_wso2is_console=self.webpackChunk_wso2is_console||[]).push([[4999],{98499:(e,t,n)=>{n.d(t,{X:()=>U});var r=n(76271),a=n(41355),o=n(21257),i=n(61339),s=n(58613),l=n(86105),c=n(6833),u=n(82406),d=n(20494),m=n(44194),f=n(10479),v=n(47245),p=n(89141),g=n(62508),h=n(9544),E=n(73237),A=n(31463),S=n(13731),I=n(92283),y=n(83953);const O=function(){var e=(0,m.useContext)(y.Z);if(!e)throw new Error("useUserManagement must be used within a UserManagementProvider");return e};function b(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,i,s=[],l=!0,c=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);l=!0);}catch(e){c=!0,a=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(c)throw a}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return R(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?R(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function R(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var U=function(e){var t=e.user,n=e.handleUserUpdate,y=e.connectorProperties,R=e.isLoading,U=e.isReadOnly,_=void 0!==U&&U,N=e.isReadOnlyUserStore,T=void 0!==N&&N,C=(0,f.$)().t,M=O(),P=M.activeTab,k=M.updateActiveTab,w=(0,v.I0)(),D=(0,o.z)().isSuperOrganization,L=(0,s.Z)().isLoading,F=b((0,m.useState)(!1),2),G=F[0],Z=F[1],B=b((0,m.useState)(!1),2),V=B[0],$=B[1],x=b((0,m.useState)(!1),2),j=x[0],z=x[1],Q=b((0,m.useState)(!1),2),Y=Q[0],X=Q[1],W=b((0,m.useState)(null),2),H=W[0],J=W[1],K=b((0,m.useState)(!1),2),q=K[0],ee=K[1],te=(0,v.v9)((function(e){var t;return null===(t=e.config.ui.features)||void 0===t?void 0:t.users})),ne=(0,l.cr)(te,I._F.FEATURE_DICTIONARY.get(I.Oq.UserGroups));(0,m.useEffect)((function(){D()&&ae()}),[t]),(0,m.useEffect)((function(){var e;null!==(e=t[a.k.scim.systemSchema])&&void 0!==e&&e.managedOrg&&ee(!0)}),[t]);var re=function(e){w((0,u.V_)(e))},ae=function(){z(!0),(0,i.U)().then((function(e){var n=r.h.getState().profile.profileInfo.userName,a=null==e?void 0:e.realmConfig.adminUser;J(a),n===a&&Z(!0),(null==t?void 0:t.userName)===a&&$(!0)})).catch((function(e){X(!0),e.response&&e.response.data&&(e.response.data.description||e.response.data.detail)?w((0,u.V_)({description:e.response.data.description||e.response.data.detail,level:c.QU.ERROR,message:C("users:userSessions.notifications.getAdminUser.error.message")})):w((0,u.V_)({description:C("users:userSessions.notifications.getAdminUser.genericError.description"),level:c.QU.ERROR,message:C("users:userSessions.notifications.getAdminUser.genericError.message")}))})).finally((function(){z(!1)}))},oe=(0,m.useMemo)((function(){var e,r=[];return r.push({menuItem:C("users:editUser.tab.menuItems.0"),render:function(){var e;return m.createElement(d.M$.Pane,{controlledSegmentation:!0,attached:!1},m.createElement(E.I,{adminUsername:H,onAlertFired:re,user:t,handleUserUpdate:n,isReadOnly:_,connectorProperties:y,isReadOnlyUserStoresLoading:L,isReadOnlyUserStore:T,isUserManagedByParentOrg:q,adminUserType:I.lu.INTERNAL,allowDeleteOnly:"true"===(null===(e=t[a.k.scim.systemSchema])||void 0===e?void 0:e.isReadOnlyUser),editUserDisclaimerMessage:m.createElement(p.Z,null,m.createElement(p.Z.Row,{columns:1},m.createElement(p.Z.Column,{mobile:12,tablet:12,computer:6},m.createElement(d.v0,{type:"info",content:C("extensions:manage.users.editUserProfile.disclaimerMessage")}),m.createElement(g.Z,{hidden:!0}))))}))}}),(ne||1!==(null==t||null===(e=t.userName)||void 0===e?void 0:e.split("/").length))&&r.push({menuItem:C("users:editUser.tab.menuItems.1"),render:function(){return m.createElement(d.M$.Pane,{controlledSegmentation:!0,attached:!1},m.createElement(h.V,{onAlertFired:re,user:t,handleUserUpdate:n,isReadOnly:_}))}}),r.push({menuItem:C("users:editUser.tab.menuItems.2"),render:function(){return m.createElement(d.M$.Pane,{controlledSegmentation:!0,attached:!1},m.createElement(A.e,{user:t}))}},{menuItem:C("users:editUser.tab.menuItems.3"),render:function(){return m.createElement(d.M$.Pane,{controlledSegmentation:!0,attached:!1},m.createElement(S.Y,{user:t,showSessionTerminationButton:!j&&!Y&&(V&&G||!V&&G||!V&&!G)}))}}),r}),[t,ne,y,j,Y,V,G,_,L,T,q]);return m.createElement(d.M$,{activeIndex:P,isLoading:R,onTabChange:function(e,t){k(t.activeIndex)},panes:oe})}},83953:(e,t,n)=>{n.d(t,{Z:()=>a});var r=(0,n(44194).createContext)(null);r.displayName="UserManagementContext";const a=r},44999:(e,t,n)=>{n.r(t),n.d(t,{default:()=>k});var r=n(82160),a=n(55007),o=n(52820),i=n(64961),s=n(60486),l=n(40838),c=n(41355),u=n(48704),d=n(64643),m=n(4717),f=n(47149),v=n(58613),p=n(86105),g=n(6833),h=n(82406),E=n(16590),A=n(20494),S=n(44194),I=n(10479),y=n(59673),O=n(47245),b=n(26154),R=n(37077),U=n(92e3),_=n(98499),N=n(82555),T=n(2802),C=n(6643);function M(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,i,s=[],l=!0,c=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);l=!0);}catch(e){c=!0,a=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(c)throw a}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return P(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?P(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function P(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}const k=function(){var e,t,n,P,k,w,D,L,F,G,Z,B=(0,I.$)().t,V=(0,O.I0)(),$=(0,v.Z)(),x=$.mutateUserStoreList,j=$.isUserStoreReadOnly,z=$.readOnlyUserStoreNamesList,Q=(0,O.v9)((function(e){return e.config.ui.features})),Y=(0,O.v9)((function(e){return e.profile.profileInfo})),X=(0,a.EV)(null==Q||null===(e=Q.users)||void 0===e||null===(e=e.scopes)||void 0===e?void 0:e.update),W=(0,p.cr)(null==Q?void 0:Q.users,N._F.FEATURE_DICTIONARY.get("USER_UPDATE")),H=(0,p.cr)(null==Q?void 0:Q.users,N._F.FEATURE_DICTIONARY.get("USER_SHARED_PROFILES")),J=M((0,S.useState)(!1),2),K=J[0],q=J[1],ee=M((0,S.useState)(void 0),2),te=ee[0],ne=ee[1],re=M((0,S.useState)(!1),2),ae=re[0],oe=re[1],ie=l.m.location.pathname.split("/"),se=ie[ie.length-1],le=(0,U.vU)(se),ce=le.data,ue=le.isLoading,de=le.isValidating,me=le.mutate,fe=le.error,ve=(0,m.XJ)(f.v.ACCOUNT_MANAGEMENT_CATEGORY_ID).data,pe=(0,m.XJ)(f.v.USER_ONBOARDING_CONNECTOR_ID).data,ge=(0,m.XJ)(f.v.OTHER_SETTINGS_CONNECTOR_CATEGORY_ID).data,he=(0,S.useMemo)((function(){return ce||(0,g.I)()}),[ce]),Ee=void 0===(null==he||null===(t=he.name)||void 0===t?void 0:t.familyName)&&void 0===(null==he||null===(n=he.name)||void 0===n?void 0:n.givenName),Ae=(0,S.useMemo)((function(){var e,t,n=(null==he||null===(e=he.userName)||void 0===e?void 0:e.split("/").length)>1?null==he||null===(t=he.userName)||void 0===t?void 0:t.split("/")[0]:u.w.primaryUserstoreName;return j(n)}),[he,z]),Se=!W||!X||Ae||(null===(P=he[c.k.scim.systemSchema])||void 0===P?void 0:P.userSourceId)||"true"===(null===(k=he[c.k.scim.systemSchema])||void 0===k?void 0:k.isReadOnlyUser)||(null===(w=he[c.k.scim.systemSchema])||void 0===w?void 0:w.managedOrg)&&!H;(0,S.useEffect)((function(){x()}),[]),(0,S.useEffect)((function(){var e=[];ve&&ve.map((function(t){t.id!==f.v.ACCOUNT_DISABLING_CONNECTOR_ID&&t.id!==f.v.ADMIN_FORCE_PASSWORD_RESET_CONNECTOR_ID||t.properties.map((function(t){e.push(t)}))})),pe&&pe.map((function(t){t.id!==f.v.SELF_SIGN_UP_CONNECTOR_ID&&t.id!==f.v.USER_EMAIL_VERIFICATION_CONNECTOR_ID||t.properties.map((function(t){t.name!==f.v.ACCOUNT_LOCK_ON_CREATION&&t.name!==f.v.ASK_PASSWORD_EMAIL_OTP&&t.name!==f.v.ASK_PASSWORD_SMS_OTP&&t.name!==f.v.EMAIL_VERIFICATION_OTP||e.push(t)}))})),ge&&ge.map((function(t){t.id===f.v.USER_CLAIM_UPDATE_CONNECTOR_ID&&t.properties.map((function(t){t.name!==f.v.ENABLE_EMAIL_VERIFICATION&&t.name!==f.v.ENABLE_MOBILE_VERIFICATION&&t.name!==f.v.ENABLE_MOBILE_VERIFICATION_BY_PRIVILEGED_USER||e.push(t)}))})),ne(e)}),[ve,pe,ge]),(0,S.useEffect)((function(){fe&&(fe.response&&fe.response.data&&fe.response.data.description?V((0,h.V_)({description:fe.response.data.description,level:g.QU.ERROR,message:B("console:manage.notifications.getProfileInfo.error.message")})):V((0,h.V_)({description:B("console:manage.notifications.getProfileSchema.genericError.description"),level:g.QU.ERROR,message:B("console:manage.notifications.getProfileSchema.genericError.message")})))}),[fe]);var Ie=function(){me(),C.QH.isAuthenticatedUser(null==Y?void 0:Y.userName,null==he?void 0:he.userName)&&V((0,o.G)())},ye=function(){return!Ee&&C.QH.resolveUserListSubheaderName(he)};return fe?S.createElement(A.$J,{action:S.createElement(r.Z,{variant:"text",onClick:E.CommonUtils.refreshPage},B("console:common.placeholders.brokenPage.action")),image:(0,i.jF)().brokenPage,imageSize:"tiny",subtitle:[B("console:common.placeholders.brokenPage.subtitles.0"),B("console:common.placeholders.brokenPage.subtitles.1")],title:B("console:common.placeholders.brokenPage.title")}):S.createElement(T.Z,null,S.createElement(A.O9,{isLoading:ue||de,loadingStateOptions:{count:5,imageType:"circular"},title:S.createElement(S.Fragment,null,void 0!==(null==he?void 0:he.active)?S.createElement(S.Fragment,null,null!=he&&he.active?S.createElement(A.GI,{trigger:S.createElement(b.Z,{className:"mr-2 ml-0 vertical-aligned-baseline",size:"small",name:"circle",color:"green"}),content:B("common:enabled"),inverted:!0}):S.createElement(A.GI,{trigger:S.createElement(b.Z,{className:"mr-2 ml-0 vertical-aligned-baseline",size:"small",name:"circle",color:"orange"}),content:B("common:disabled"),inverted:!0}),(0,p.WX)(null==he?void 0:he.userName)):S.createElement(S.Fragment,null,(0,p.WX)(null==he?void 0:he.userName))),pageTitle:"Edit User",description:S.createElement("div",null,ye(),(null===(D=he[c.k.scim.systemSchema])||void 0===D?void 0:D.userSourceId)&&S.createElement(R.Z,{className:"profile-user-source-label"},S.createElement(A.dn,{className:"mt-1 mb-0",square:!0,inline:!0,size:"default",transparent:!0,icon:function(e){switch(e){case"Google":return(0,d.nI)().google;case"facebook":return(0,d.nI)().facebook;case"Github":return(0,d.nI)().github;case"Microsoft":return(0,d.nI)().microsoft;case"Apple":return(0,d.nI)().apple;default:return(0,d.nI)().enterprise}}(null===(L=he[c.k.scim.systemSchema])||void 0===L?void 0:L.idpType),verticalAlign:"middle"}),S.createElement(R.Z.Detail,{className:"mt-1 ml-0 mb-1"},null===(F=he[c.k.scim.systemSchema])||void 0===F?void 0:F.userSourceId)),(null===(G=he[c.k.scim.systemSchema])||void 0===G?void 0:G.userSource)&&S.createElement(R.Z,{className:ye()?"profile-user-source-label":"profile-user-source-label ml-0"},S.createElement(A.dn,{className:"mt-1 mb-0",square:!0,inline:!0,size:"default",transparent:!0,icon:(0,i.Uz)().userStore,verticalAlign:"middle"}),S.createElement(R.Z.Detail,{className:"mt-1 ml-0 mb-1"},null===(Z=he[c.k.scim.systemSchema])||void 0===Z?void 0:Z.userSource))),image:S.createElement(A.Yt,{editable:!Se,hoverable:!Se,name:(0,p.nk)(he),size:"tiny",image:null==he?void 0:he.profileUrl,onClick:function(){return!Se&&q(!0)}}),backButton:{"data-testid":"user-mgt-edit-user-back-button",onClick:function(){window.location.href.includes(s.$.getPaths().get("ADMINISTRATORS"))?l.m.push(s.$.getPaths().get("ADMINISTRATORS")):l.m.push(s.$.getPaths().get("USERS"))},text:window.location.href.includes(s.$.getPaths().get("ADMINISTRATORS"))?B("pages:usersEdit.backButton",{type:"Administrators"}):B("pages:usersEdit.backButton",{type:"Users"})},titleTextAlign:"left",bottomMargin:!1},S.createElement(_.X,{user:he,handleUserUpdate:Ie,connectorProperties:te,isLoading:ue||de,isReadOnly:Se,isReadOnlyUserStore:Ae}),K&&S.createElement(A.Oi,{open:K,name:(0,p.nk)(he),emails:(0,p.r1)(null==he?void 0:he.emails),onClose:function(){return q(!1)},closeOnDimmerClick:!1,onCancel:function(){return q(!1)},onSubmit:function(e,t){var n={Operations:[{op:"replace",value:{profileUrl:t}}],schemas:["urn:ietf:params:scim:api:messages:2.0:PatchOp"]};oe(!0),(0,U.gS)(null==he?void 0:he.id,n).then((function(){V((0,h.V_)({description:B("user:profile.notifications.updateProfileInfo.success.description"),level:g.QU.SUCCESS,message:B("user:profile.notifications.updateProfileInfo.success.message")})),Ie()})).catch((function(e){e.response&&e.response.data&&(e.response.data.description||e.response.data.detail)?V((0,h.V_)({description:e.response.data.description||e.response.data.detail,level:g.QU.ERROR,message:B("user:profile.notifications.updateProfileInfo.error.message")})):V((0,h.V_)({description:B("user:profile.notifications.updateProfileInfo.genericError.description"),level:g.QU.ERROR,message:B("user:profile.notifications.updateProfileInfo.genericError.message")}))})).finally((function(){q(!1),oe(!1)}))},imageUrl:null==Y?void 0:Y.profileUrl,isSubmitting:ae,heading:B("console:common.modals.editAvatarModal.heading"),submitButtonText:B("console:common.modals.editAvatarModal.primaryButton"),cancelButtonText:B("console:common.modals.editAvatarModal.secondaryButton"),translations:{gravatar:{errors:{noAssociation:{content:S.createElement(y.c,{i18nKey:"console:common.modals.editAvatarModal.content.gravatarerrors.noAssociation.content"},"It seems like the selected email is not registered on Gravatar. Sign up for a Gravatar account by visiting\xa0",S.createElement("a",{href:"https://www.gravatar.com"},"Gravatar Official Website"),"\xa0or use one of the following."),header:B("console:common.modals.editAvatarModal.content.gravatar.errors.noAssociation.header")}},heading:B("console:common.modals.editAvatarModal.content.gravatar.heading")},hostedAvatar:{heading:B("console:common.modals.editAvatarModal.content.hostedAvatar.heading"),input:{errors:{http:{content:B("console:common.modals.editAvatarModal.content.hostedAvatar.input.errors.http.content"),header:B("console:common.modals.editAvatarModal.content.hostedAvatar.input.errors.http.header")},invalid:{content:B("console:common.modals.editAvatarModal.content.hostedAvatar.input.errors.invalid.content"),pointing:B("console:common.modals.editAvatarModal.content.hostedAvatar.input.errors.invalid.pointing")}},hint:B("console:common.modals.editAvatarModal.content.hostedAvatar.input.hint"),placeholder:B("console:common.modals.editAvatarModal.content.hostedAvatar.input.placeholder"),warnings:{dataURL:{content:B("console:common.modals.editAvatarModal.content.hostedAvatar.input.warnings.dataURL.content"),header:B("console:common.modals.editAvatarModal.content.hostedAvatar.input.warnings.dataURL.header")}}}},systemGenAvatars:{heading:B("console:common.modals.editAvatarModal.content.systemGenAvatars.heading"),types:{initials:B("console:common.modals.editAvatarModal.content.systemGenAvatars.types.initials")}}}})))}},2802:(e,t,n)=>{n.d(t,{Z:()=>s});var r=n(44194),a=n(83953);function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,i,s=[],l=!0,c=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);l=!0);}catch(e){c=!0,a=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(c)throw a}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return i(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}const s=function(e){var t=e.children,n=o((0,r.useState)(0),2),i=n[0],s=n[1];return r.createElement(a.Z.Provider,{value:{activeTab:i,updateActiveTab:s}},t)}}}]);