"use strict";(self.webpackChunk_wso2is_console=self.webpackChunk_wso2is_console||[]).push([[7895],{57895:(e,n,t)=>{t.r(n),t.d(n,{default:()=>Ue});var o=t(92336),a=t(31549),r=t(133),i=t(14517),c=t(44194);const s=(0,c.forwardRef)(((e,n)=>{var{className:t}=e,c=(0,o.__rest)(e,["className"]);return(0,a.jsx)(r.Z,Object.assign({ref:n,className:(0,i.Z)("oxygen-alert","OxygenAlert-root",t)},c))}));var l=t(5315);const u=(0,c.forwardRef)(((e,n)=>{var{className:t}=e,r=(0,o.__rest)(e,["className"]);return(0,a.jsx)(l.Z,Object.assign({ref:n,className:(0,i.Z)("oxygen-alert-title","OxygenAlertTitle-root",t)},r))}));var m=t(17199),d=t(78370);const h=(0,c.forwardRef)(((e,n)=>{var{className:t}=e,r=(0,o.__rest)(e,["className"]);return(0,a.jsx)(d.Z,Object.assign({ref:n,className:(0,i.Z)("oxygen-button","OxygenButton-root",t)},r))}));var f,p,b;f='/**\n * Copyright (c) 2023, WSO2 LLC. (https://www.wso2.com).\n *\n * WSO2 LLC. licenses this file to you under the Apache License,\n * Version 2.0 (the "License"); you may not use this file except\n * in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing,\n * software distributed under the License is distributed on an\n * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\n * KIND, either express or implied. See the License for the\n * specific language governing permissions and limitations\n * under the License.\n */\n.oxygen-button.MuiButton-containedPrimary.Mui-disabled {\n  cursor: default;\n  opacity: 0.45;\n  box-shadow: none;\n  pointer-events: none;\n}',p=document.getElementsByTagName("head")[0],(b=document.createElement("style")).setAttribute("type","text/css"),b.appendChild(document.createTextNode(f)),p.appendChild(b);var g=t(55007),v=t(40838),w=t(86105),k=t(20494),E=t(50699),y=t(10479),x=t(47245),S=t(39114),A=t(89141),C=t(2292),T=t(76271),N=t(43939),O=t(6833),I=t(33241),Z=C.AsgardeoSPAClient.getInstance().httpRequest.bind(C.AsgardeoSPAClient.getInstance());const _=function(e,n){var t={headers:{Accept:"application/json","Content-Type":"application/json"},method:O.f2.POST,url:"".concat(T.h.getState().config.endpoints.webhooks,"/").concat(e,"/").concat(n)};return Z(t).then((function(e){if(200!==e.status)throw new N.u(I.J.ERROR_MESSAGES.UPDATE_WEBHOOK_STATUS_INVALID_STATUS_CODE,null,e.status,e.request,e,e.config);return Promise.resolve()})).catch((function(e){var n;throw new N.u(e.message,e.stack,null===(n=e.response)||void 0===n||null===(n=n.data)||void 0===n?void 0:n.code,e.request,e.response,e.config)}))};var R=C.AsgardeoSPAClient.getInstance().httpRequest.bind(C.AsgardeoSPAClient.getInstance());const L=function(e){var n={data:e,headers:{Accept:"application/json","Content-Type":"application/json"},method:O.f2.POST,url:"".concat(T.h.getState().config.endpoints.webhooks)};return R(n).then((function(e){if(201!==e.status)throw new N.u(I.J.ERROR_MESSAGES.CREATE_WEBHOOK_INVALID_STATUS_CODE,null,e.status,e.request,e,e.config);return Promise.resolve(e.data)})).catch((function(e){var n;throw new N.u(e.message,e.stack,null===(n=e.response)||void 0===n||null===(n=n.data)||void 0===n?void 0:n.code,e.request,e.response,e.config)}))};var P=t(52087),F=C.AsgardeoSPAClient.getInstance().httpRequest.bind(C.AsgardeoSPAClient.getInstance()),j=C.AsgardeoSPAClient.getInstance().httpRequest.bind(C.AsgardeoSPAClient.getInstance());const V=function(e,n){var t={data:n,method:O.f2.PUT,url:"".concat(T.h.getState().config.endpoints.webhooks,"/").concat(e)};return j(t).then((function(e){if(200!==e.status)throw new N.u(I.J.ERROR_MESSAGES.UPDATE_WEBHOOK_INVALID_STATUS_CODE,null,e.status,e.request,e,e.config);return Promise.resolve(e.data)})).catch((function(e){var n;throw new N.u(e.message,e.stack,null===(n=e.response)||void 0===n||null===(n=n.data)||void 0===n?void 0:n.code,e.request,e.response,e.config)}))};var W=t(96124);const M=function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],t={headers:{Accept:"application/json","Content-Type":"application/json"},method:O.f2.GET,url:"".concat(T.h.getState().config.endpoints.webhooksMetadata,"/event-profiles/").concat(e)},o=(0,W.Z)(n&&e?t:null,{shouldRetryOnError:!1});return{data:o.data,error:o.error,isLoading:o.isLoading,isValidating:o.isValidating,mutate:o.mutate}};const U=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return M(I.J.DEFAULT_EVENT_PROFILE.name,e)};const H=function(e){var n={headers:{Accept:"application/json","Content-Type":"application/json"},method:O.f2.GET,url:"".concat(T.h.getState().config.endpoints.webhooks,"/").concat(e)},t=!(0,E.Z)(e)&&"new"!==e,o=(0,W.Z)(t?n:null,{shouldRetryOnError:!1});return{data:o.data,error:o.error,isLoading:o.isLoading,isValidating:o.isValidating,mutate:o.mutate}};var B=t(58951),D=t(65740);const q=(0,c.forwardRef)(((e,n)=>{var{className:t}=e,r=(0,o.__rest)(e,["className"]);return(0,a.jsx)(D.Z,Object.assign({ref:n,className:(0,i.Z)("oxygen-divider","OxygenDivider-root",t)},r))}));var Y=t(78079),K=t(79438),J=t(51835),z=t.n(J),G=t(27975),$=t.n(G),X=t(55900),Q=t.n(X),ee=t(21555),ne=t.n(ee),te=t(3621),oe=t.n(te),ae=t(5062),re=t.n(ae),ie=t(7294),ce={};ce.styleTagTransform=re(),ce.setAttributes=ne(),ce.insert=Q().bind(null,"head"),ce.domAPI=$(),ce.insertStyleElement=oe();z()(ie.Z,ce);ie.Z&&ie.Z.locals&&ie.Z.locals;var se=t(31958),le=t(66466),ue=t(67197),me=t(41512),de=t(81901),he=t(26154),fe=t(57982);const pe=function(e){var n,t,o=e.channelConfigs,a=e.isReadOnly,r=e.channelSubscriptions,i=void 0===r?[]:r,s=e["data-componentid"],l=void 0===s?"webhook-channel-config-form":s,u=o,m=(0,y.$)().t,d=function(e){var n,t,o=function(e){switch(e){case fe.U.SUBSCRIPTION_ACCEPTED:return{color:"success",icon:"check",iconColor:"green",text:m("webhooks:configForm.channels.status.subscriptionAccepted")};case fe.U.SUBSCRIPTION_ERROR:return{color:"warning",icon:"exclamation triangle",iconColor:"orange",text:m("webhooks:configForm.channels.status.subscriptionError")};case fe.U.UNSUBSCRIPTION_ACCEPTED:return{color:"success",icon:"check",iconColor:"green",text:m("webhooks:configForm.channels.status.unsubscriptionAccepted")};case fe.U.UNSUBSCRIPTION_ERROR:return{color:"warning",icon:"exclamation triangle",iconColor:"orange",text:m("webhooks:configForm.channels.status.unsubscriptionError")};default:return null}}((n=e.channelUri,(null==(t=i.find((function(e){return e.channelUri===n})))?void 0:t.status)||null));return o?c.createElement("span",{className:"channel-status-inline ".concat(o.color)},c.createElement(he.Z,{className:"status-icon",name:o.icon,color:o.iconColor,size:"small"}),o.text):null},h=function(e){return c.createElement(se.Z,{key:e.key,className:"channel-checkbox-container"},c.createElement(se.Z,{className:"checkbox-control"},c.createElement(K.SE,{ariaLabel:e.name,"data-componentid":"".concat(l,"-").concat(e.key,"-checkbox"),name:"channels.".concat(e.key),component:de.Z,disabled:a,label:c.createElement(se.Z,{className:"checkbox-label"},c.createElement(se.Z,{className:"channel-name-container"},c.createElement(le.Z,{variant:"body1",component:"span",className:"channel-name"},e.name),d(e)),c.createElement(le.Z,{variant:"caption",component:"div",className:"channel-description"},e.description))})))};return c.createElement("div",{className:"webhook-channel-config-form"},c.createElement(le.Z,{variant:"h6",className:"heading-container"},m("webhooks:configForm.channels.heading")),c.createElement(le.Z,{variant:"body2",color:"text.secondary",className:"section-description"},m("webhooks:configForm.channels.subHeading")),(n=u.slice(0,Math.ceil(u.length/2)),t=u.slice(Math.ceil(u.length/2)),c.createElement(ue.ZP,{container:!0,spacing:3,className:"channel-grid"},c.createElement(ue.ZP,{item:!0,xs:12,md:6},c.createElement(me.Z,null,n.map((function(e){return h(e)})))),c.createElement(ue.ZP,{item:!0,xs:12,md:6},c.createElement(me.Z,null,t.map((function(e){return h(e)})))))))};var be=t(63537);const ge=(0,c.forwardRef)(((e,n)=>{var{className:t,position:r}=e,c=(0,o.__rest)(e,["className","position"]);return(0,a.jsx)(be.Z,Object.assign({ref:n,position:r,className:(0,i.Z)("oxygen-input-adornment","OxygenInputAdornment-root",t)},c))}));var ve=t(22764),we=t(59673),ke=t(24629),Ee={};Ee.styleTagTransform=re(),Ee.setAttributes=ne(),Ee.insert=Q().bind(null,"head"),Ee.domAPI=$(),Ee.insertStyleElement=oe();z()(ke.Z,Ee);ke.Z&&ke.Z.locals&&ke.Z.locals;function ye(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var o,a,r,i,c=[],s=!0,l=!1;try{if(r=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;s=!1}else for(;!(s=(o=r.call(t)).done)&&(c.push(o.value),c.length!==n);s=!0);}catch(e){l=!0,a=e}finally{try{if(!s&&null!=t.return&&(i=t.return(),Object(i)!==i))return}finally{if(l)throw a}}return c}}(e,n)||function(e,n){if(e){if("string"==typeof e)return xe(e,n);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?xe(e,n):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function xe(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,o=Array(n);t<n;t++)o[t]=e[t];return o}const Se=function(e){var n=e.initialValues,t=e.isCreateFormState,o=e.isReadOnly,a=e.isWebSubHubAdopterMode,r=e["data-componentid"],i=void 0===r?"webhook-endpoint-config-form":r,l=ye((0,c.useState)(!1),2),m=l[0],d=l[1],f=ye((0,c.useState)(!1),2),p=f[0],b=f[1],g=(0,y.$)().t;(0,c.useEffect)((function(){null!=n&&n.id&&!t?b(!1):t&&b(!0)}),[n]);var v,w,E=function(){b(!0)},x=function(){b(!1)};return c.createElement("div",{className:"webhook-endpoint-config-form"},c.createElement("div",{className:"form-field-wrapper"},c.createElement(K.SE,{key:"name",width:16,FormControlProps:{margin:"dense"},ariaLabel:"webhookName",required:!0,"data-componentid":"".concat(i,"-webhook-name"),name:"name",type:"text",label:g("webhooks:configForm.fields.name.label"),placeholder:g("webhooks:configForm.fields.name.placeholder"),helperText:c.createElement(k.kW,{className:"hint",compact:!0},g("webhooks:configForm.fields.name.hint")),component:K.xh,maxLength:100,minLength:0,disabled:o})),c.createElement("div",{className:"form-field-wrapper"},c.createElement(K.SE,{key:"uri",width:16,FormControlProps:{margin:"dense"},ariaLabel:"endpoint",required:!0,"data-componentid":"".concat(i,"-webhook-endpointUri"),name:"endpoint",type:"text",label:g("webhooks:configForm.fields.endpoint.label"),placeholder:g("webhooks:configForm.fields.endpoint.placeholder"),helperText:c.createElement(k.kW,{className:"hint",compact:!0},g("webhooks:configForm.fields.endpoint.hint")),component:K.xh,maxLength:100,minLength:0,disabled:o}),c.createElement(ve.gN,{name:"endpoint",subscription:{value:!0}},(function(e){var n;return(null===(n=e.input.value)||void 0===n?void 0:n.startsWith("http://"))?c.createElement(s,{severity:"warning",className:"endpoint-uri-alert","data-componentid":"".concat(i,"-endpoint-uri-alert")},c.createElement(we.c,{i18nKey:g("webhooks:configForm.fields.endpoint.validations.notHttps")})):null}))),c.createElement("div",{className:"form-field-wrapper"},p?c.createElement("div",{className:"box-field"},c.createElement(c.Fragment,null,c.createElement(K.SE,{key:"secret",className:"text-field-container",width:16,FormControlProps:{margin:"dense"},ariaLabel:"secret",required:t||p,"data-componentid":"".concat(i,"-secret-property-field"),name:"secret",type:m?"text":"password",InputProps:{endAdornment:(v=m,w=function(){return d(!m)},c.createElement(ge,{position:"end"},c.createElement(he.Z,{link:!0,className:"list-icon reset-field-to-default-adornment",size:"small",color:"grey",name:v?"eye slash":"eye","data-componentid":"".concat(i,"-secret-property-view-button"),onClick:w})))},label:g("webhooks:configForm.fields.secret.label"),placeholder:g("webhooks:configForm.fields.secret.placeholder"),helperText:c.createElement(k.kW,{className:"hint-text",compact:!0},g("webhooks:configForm.fields.secret.hint.common"),g(t?a?"webhooks:configForm.fields.secret.hint.createWebSubHubMode":"webhooks:configForm.fields.secret.hint.create":"webhooks:configForm.fields.secret.hint.update")),component:K.xh,maxLength:100,minLength:0,disabled:o})),!t&&c.createElement(h,{onClick:x,variant:"outlined",size:"small",className:"secondary-button","data-componentid":"".concat(i,"-cancel-edit-secret-button")},g("webhooks:configForm.buttons.cancel"))):c.createElement(s,{className:"alert-nutral",icon:!1},c.createElement(u,{className:"alert-title","data-componentid":"".concat(i,"-secret-info-box-title")},c.createElement(we.c,{i18nKey:g("webhooks:configForm.fields.secret.info.title"),components:{strong:c.createElement("strong",null)}})),c.createElement(we.c,{i18nKey:g(a?"webhooks:configForm.fields.secret.info.messageWebSubHubMode":"webhooks:configForm.fields.secret.info.message")}),!a&&c.createElement("div",null,c.createElement(h,{onClick:E,variant:"outlined",size:"small",className:"secondary-button","data-componentid":"".concat(i,"-change-secret-button"),disabled:o},g("webhooks:configForm.buttons.changeSecret"))))))};var Ae=t(34194),Ce=function(e,n,t){var o={},a=function(e,n){return null!=e&&e.trim()?I.J.WEBHOOK_NAME_REGEX.test(e)?void 0:n("webhooks:configForm.fields.name.validations.invalid"):n("webhooks:configForm.fields.name.validations.empty")}(null==e?void 0:e.name,t);a&&(o.name=a);var r=function(e,n){return null!=e&&e.trim()?Ae.I.url(e,{domain:{allowUnicode:!0,minDomainSegments:1,tlds:!1},scheme:["https","http"]})?void 0:n("webhooks:configForm.fields.endpoint.validations.invalid"):n("webhooks:configForm.fields.endpoint.validations.empty")}(null==e?void 0:e.endpoint,t);r&&(o.endpoint=r);var i=function(e,n,t){return!n||null!=e&&e.trim()?null!=e&&e.trim()&&!I.J.WEBHOOK_SECRET_REGEX.test(e)?t("webhooks:configForm.fields.secret.validations.invalid"):void 0:t("webhooks:configForm.fields.secret.validations.empty")}(null==e?void 0:e.secret,n,t);i&&(o.secret=i);var c=function(e,n){if(!Object.values(e||{}).some(Boolean))return n("webhooks:configForm.channels.validations.empty")}(null==e?void 0:e.channels,t);return c&&(o.channels=c),o},Te=t(84931),Ne={};Ne.styleTagTransform=re(),Ne.setAttributes=ne(),Ne.insert=Q().bind(null,"head"),Ne.domAPI=$(),Ne.insertStyleElement=oe();z()(Te.Z,Ne);Te.Z&&Te.Z.locals&&Te.Z.locals;const Oe=function(e){var n=e.initialValues,t=e.channelConfigs,o=e.channelSubscriptions,a=e.isLoading,r=e.isReadOnly,i=e.isCreateFormState,s=e.onSubmit,l=e.isSubmitting,u=e.hideSubmitButton,d=e.isWebSubHubAdopterMode,f=e["data-componentid"],p=void 0===f?"webhook-config-form":f,b=(0,y.$)().t,g=function(){return a?c.createElement(m.Z,{className:"placeholder-box"},c.createElement(Y.Z,{variant:"rectangular",height:7,width:"30%"}),c.createElement(Y.Z,{variant:"rectangular",height:28}),c.createElement(Y.Z,{variant:"rectangular",height:7,width:"90%"}),c.createElement(Y.Z,{variant:"rectangular",height:7})):c.createElement(c.Fragment,null,c.createElement(Se,{initialValues:n,isCreateFormState:i,isReadOnly:r,isWebSubHubAdopterMode:d,"data-componentid":"".concat(p,"-endpoint-config-form")}),c.createElement(q,{className:"divider-container"}),c.createElement(pe,{channelConfigs:t,channelSubscriptions:o,isReadOnly:r,"data-componentid":"".concat(p,"-channel-config-form")}))};return c.createElement(m.Z,null,c.createElement(K.vy,{onSubmit:function(e){null==s||s(e)},validate:function(e){return Ce(e,i,b)},initialValues:n,render:function(e){var n=e.handleSubmit,t=e.submitting,o=e.invalid;return c.createElement(m.Z,{component:"form",onSubmit:n},c.createElement(k.pJ,{className:"form-wrapper",padded:"very","data-componentid":"".concat(p,"-section")},c.createElement(m.Z,{className:"form-container with-max-width"},g(),!a&&!u&&c.createElement(h,{size:"medium",variant:"contained",type:"submit",className:"button-container","data-componentid":"".concat(p,"-primary-button"),loading:l||t,disabled:r||o},b(i?"webhooks:configForm.buttons.create":"webhooks:configForm.buttons.update")))))}}))};var Ie=t(18982),Ze=t(7238),_e=t(67071),Re=t(72765),Le={};Le.styleTagTransform=re(),Le.setAttributes=ne(),Le.insert=Q().bind(null,"head"),Le.domAPI=$(),Le.insertStyleElement=oe();z()(Re.Z,Le);Re.Z&&Re.Z.locals&&Re.Z.locals;function Pe(e){return Pe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Pe(e)}function Fe(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function je(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?Fe(Object(t),!0).forEach((function(n){Ve(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Fe(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function Ve(e,n,t){return(n=function(e){var n=function(e,n){if("object"!=Pe(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var o=t.call(e,n||"default");if("object"!=Pe(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===n?String:Number)(e)}(e,"string");return"symbol"==Pe(n)?n:n+""}(n))in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function We(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var o,a,r,i,c=[],s=!0,l=!1;try{if(r=(t=t.call(e)).next,0===n){if(Object(t)!==t)return;s=!1}else for(;!(s=(o=r.call(t)).done)&&(c.push(o.value),c.length!==n);s=!0);}catch(e){l=!0,a=e}finally{try{if(!s&&null!=t.return&&(i=t.return(),Object(i)!==i))return}finally{if(l)throw a}}return c}}(e,n)||function(e,n){if(e){if("string"==typeof e)return Me(e,n);var t={}.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Me(e,n):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Me(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,o=Array(n);t<n;t++)o[t]=e[t];return o}const Ue=function(e){var n,t,o,a=e["data-componentid"],r=void 0===a?"webhook-edit-page":a,i=(0,x.v9)((function(e){var n;return null===(n=e.config.ui.features)||void 0===n?void 0:n.webhooks})),l=(0,y.$)().t,d=(0,k.fQ)().getLink,f=(0,Ie.Z)(),p=f.navigateToWebhookEditById,b=f.navigateToWebhooksList,C=(0,g.EV)(null==i||null===(n=i.scopes)||void 0===n?void 0:n.update),Z=(0,g.EV)(null==i||null===(t=i.scopes)||void 0===t?void 0:t.create),R=(0,g.EV)(null==i||null===(o=i.scopes)||void 0===o?void 0:o.delete),j=(0,c.useMemo)((function(){var e=v.m.location.pathname.split("/");return e[e.length-1]}),[v.m.location.pathname]),W=!j||"new"===j||""===j,M=We((0,c.useState)(!1),2),D=M[0],q=M[1],Y=We((0,c.useState)(!1),2),K=Y[0],J=Y[1],z=We((0,c.useState)(!1),2),G=z[0],$=z[1],X=We((0,c.useState)(!1),2),Q=X[0],ee=X[1],ne=We((0,c.useState)(!1),2),te=ne[0],oe=ne[1],ae=We((0,c.useState)(!1),2),re=ae[0],ie=ae[1],ce=(0,w.cr)(i,I.J.FEATURE_DICTIONARY.get("SESSION_EVENT_HANDLER")),se=(0,w.cr)(i,I.J.FEATURE_DICTIONARY.get("TOKEN_EVENT_HANDLER")),le=H(j),ue=le.data,me=le.isLoading,de=le.error,he=le.mutate,pe=U(),be=pe.data,ge=pe.isLoading,ve=pe.error,we=(0,B.Z)(),ke=we.data,Ee=we.isLoading,ye=we.error,xe=(0,_e.L)(),Se=(0,_e.F)(),Ae=me||ge||Ee,Ce=(0,c.useMemo)((function(){if(!be)return[];var e=Ve(Ve({},I.J.WEBHOOKS_SESSION_EVENT_SCHEMA,ce),I.J.WEBHOOKS_TOKEN_EVENT_SCHEMA,se);return function(e){return e.channels.map((function(e){return{channelUri:e.uri,description:e.description,key:e.name,name:e.name}}))}(be).map((function(e){var n,t;return{channelUri:e.channelUri,description:null!==(n=e.description)&&void 0!==n?n:"",key:e.key,name:null!==(t=e.name)&&void 0!==t?t:""}})).filter((function(n){return!1!==e[n.channelUri]}))}),[be,ce,se]),Te=(0,c.useMemo)((function(){var e={channels:{},endpoint:"",id:"",name:"",secret:""};if(0===Ce.length)return e;var n=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){return!1};Ce.forEach((function(t){e.channels[t.key]=n(t.channelUri)}))};if(ue&&!W){var t=je(je({},e),{},{endpoint:ue.endpoint,id:ue.id,name:ue.name,secret:ue.secret||""});return n((function(e){var n;return(null===(n=ue.channelsSubscribed)||void 0===n?void 0:n.some((function(n){return n.channelUri===e})))||!1})),je(je({},t),{},{channels:e.channels})}return n(),e}),[ue,W,Ce]),Ne=(0,c.useCallback)((function(){return!(null==ke||!ke.adapter)&&Ze.ZT.isWebSubHub(ke.adapter)}),[ke]),Re=(0,c.useCallback)((function(){return W?!Z:!!Ne()||!C}),[W,Z,C,Ne]),Le=(0,c.useCallback)((function(){return!W&&C}),[W,C]),Pe=(0,c.useCallback)((function(){return!(Ae||W||(0,E.Z)(ue))&&!!R}),[Ae,W,ue,R]),Fe=(0,c.useCallback)((function(){return!(!Ne()||!ue)&&(ue.status===fe.v.ACTIVE||ue.status===fe.v.PARTIALLY_ACTIVE)}),[Ne,ue]);(0,c.useEffect)((function(){ue&&(ue.status===fe.v.ACTIVE||ue.status===fe.v.PARTIALLY_ACTIVE?q(!0):ue.status!==fe.v.INACTIVE&&ue.status!==fe.v.PARTIALLY_INACTIVE||q(!1))}),[ue]),(0,c.useEffect)((function(){de&&Se(de,"fetchWebhook")}),[de,Se]),(0,c.useEffect)((function(){ve&&Se(ve,"fetchEventProfile")}),[ve,Se]),(0,c.useEffect)((function(){ye&&Se(ye,"fetchWebhooksMetadata")}),[ye,Se]);var Me=(0,c.useCallback)((function(e){var n=function(e,n){var t=[];return n.forEach((function(n){e.channels[n.key]&&t.push(n.channelUri)})),t}(e,Ce);if(W){if(!Z)return;var t={channelsSubscribed:n,endpoint:e.endpoint||"",eventProfile:{name:be.profile,uri:be.uri},name:e.name,secret:e.secret,status:D?fe.v.ACTIVE:fe.v.INACTIVE};$(!0),L(t).then((function(e){xe("createWebhook"),p(e.id)})).catch((function(e){Se(e,"createWebhook")})).finally((function(){$(!1)}))}else{if(!C)return;var o={channelsSubscribed:n,endpoint:e.endpoint||"",eventProfile:{name:be.profile,uri:be.uri},name:e.name,status:D?fe.v.ACTIVE:fe.v.INACTIVE};e.secret&&""!==e.secret.trim()&&(o.secret=e.secret),$(!0),V(j,o).then((function(){xe("updateWebhook"),he()})).catch((function(e){Se(e,"updateWebhook")})).finally((function(){$(!1)}))}}),[Ce,W,Z,C,be,D,j,xe,Se,he,p]),Ue=(0,c.useCallback)((function(e,n){if(C||W){var t=!!n.checked;if(!W&&j&&ue){var o=t?"activate":"deactivate";ee(!0),_(j,o).then((function(){q(t),xe("updateWebhookStatus",{status:t?"active":"inactive"}),he()})).catch((function(e){q(!t),Se(e,"updateWebhookStatus")})).finally((function(){ee(!1)}))}else q(t)}}),[C,W,j,ue,xe,Se,he]),He=(0,c.useCallback)((function(){if(j&&ue&&C){var e=ue.status===fe.v.PARTIALLY_ACTIVE?"subscription":"unsubscription";ie(!0),function(e){var n={headers:{Accept:"application/json","Content-Type":"application/json"},method:O.f2.POST,url:"".concat(T.h.getState().config.endpoints.webhooks,"/").concat(e,"/retry")};return F(n).then((function(e){if(200!==e.status)throw new N.u(I.J.ERROR_MESSAGES.RETRY_WEBHOOK_INVALID_STATUS_CODE,null,e.status,e.request,e,e.config);return Promise.resolve(e.data)})).catch((function(e){throw new N.u(e.message,e.stack,e.code,e.request,e.response,e.config)}))}(j).then((function(){xe("retryWebhookState",{requestType:e}),he()})).catch((function(e){Se(e,"retryWebhookState")})).finally((function(){ie(!1)}))}}),[j,ue,C,xe,Se,he]),Be=(0,c.useCallback)((function(){R&&(oe(!0),(0,P.Z)(j).then((function(){xe("deleteWebhook"),b()})).catch((function(e){Se(e,"deleteWebhook")})).finally((function(){oe(!1),J(!1)})))}),[R,j,xe,Se,b]),De=(0,c.useCallback)((function(){b()}),[b]),qe=(0,c.useCallback)((function(){if(!ue)return null;switch(ue.status){case fe.v.PARTIALLY_ACTIVE:return{message:l("webhooks:statusBanner.pendingActivation.message"),severity:"warning",title:l("webhooks:statusBanner.pendingActivation.title")};case fe.v.PARTIALLY_INACTIVE:return{message:l("webhooks:statusBanner.pendingDeactivation.message"),severity:"warning",title:l("webhooks:statusBanner.pendingDeactivation.title")};default:return null}}),[ue,l]),Ye=(0,c.useCallback)((function(){return ue&&(ue.status===fe.v.PARTIALLY_ACTIVE||ue.status===fe.v.PARTIALLY_INACTIVE)?c.createElement(m.Z,{sx:{display:"flex",gap:1,mt:2}},c.createElement(h,{onClick:He,variant:"outlined",className:"button-container","data-componentid":"".concat(r,"-retry-button"),disabled:!Le()||re,loading:re},l("webhooks:statusBanner.buttons.retry"))):null}),[ue,He,Le,re,l,r]),Ke=(0,c.useCallback)((function(){return c.createElement(S.Z,{label:l(D?"webhooks:common.status.active":"webhooks:common.status.inactive"),toggle:!0,onChange:Ue,checked:D,readOnly:!C||Q&&!W,disabled:!C||Q&&!W,"data-componentId":"".concat(r,"-webhook-enable-toggle")})}),[D,Ue,C,Q,W,l,r]),Je=(0,c.useCallback)((function(){var e=Ke();if(W||!Ne())return e;if(!ue)return e;var n=qe(),t=ue.status===fe.v.PARTIALLY_ACTIVE||ue.status===fe.v.PARTIALLY_INACTIVE;return c.createElement(m.Z,{sx:{mb:3},className:"webhook-status-section"},c.createElement(m.Z,{sx:{mb:t?2:0}},e),!Ae&&n&&t&&c.createElement(s,{severity:n.severity,sx:{mb:2},icon:!1},c.createElement(u,null,n.title),n.message,Ye()))}),[W,Ne,ue,Ae,qe,Ke,Ye]),ze=(0,c.useCallback)((function(){var e=W?"webhooks:pages.create.heading":Ne()?"webhooks:pages.edit.headingWebSubHubMode":"webhooks:pages.edit.heading";return c.createElement(c.Fragment,null,l(e))}),[W,Ne,l,d]),Ge=(0,c.useCallback)((function(){var e=W?"webhooks:pages.create.subHeading":Ne()?"webhooks:pages.edit.subHeadingWebSubHubMode":"webhooks:pages.edit.subHeading";return c.createElement(c.Fragment,null,l(e),c.createElement(k.eb,{link:d("develop.webhooks.learnMore"),showEmptyLink:!1},l("common:learnMore")))}),[W,Ne,l,d]),$e=(0,c.useCallback)((function(){return Pe()?c.createElement(c.Fragment,null,c.createElement(k.v9,{sectionHeader:l("webhooks:dangerZone.heading")},c.createElement(k.cN,{"data-componentid":"".concat(r,"-danger-zone"),actionTitle:l("webhooks:dangerZone.delete.actionTitle"),header:l("webhooks:dangerZone.delete.heading"),subheader:l("webhooks:dangerZone.delete.subHeading"),isButtonDisabled:Fe(),onActionClick:function(){R&&!Fe()&&J(!0)}})),c.createElement(k.cV,{primaryActionLoading:te,"data-componentid":"".concat(r,"-delete-confirmation-modal"),onClose:function(){return J(!1)},type:"negative",open:K,assertionHint:l("webhooks:confirmations.delete.assertionHint"),assertionType:"checkbox",primaryAction:l("common:confirm"),secondaryAction:l("common:cancel"),onSecondaryActionClick:function(){return J(!1)},onPrimaryActionClick:Be,closeOnDimmerClick:!1},c.createElement(k.cV.Header,{"data-componentid":"".concat(r,"-delete-confirmation-modal-header")},l("webhooks:confirmations.delete.heading")),c.createElement(k.cV.Message,{"data-componentid":"".concat(r,"-delete-confirmation-modal-message"),attached:!0,negative:!0},l("webhooks:confirmations.delete.message")),c.createElement(k.cV.Content,{"data-componentid":"".concat(r,"-delete-confirmation-modal-content")},l("webhooks:confirmations.delete.content")))):null}),[Pe,l,r,R,te,K,Be,Fe]);return c.createElement(k.Xg,{title:ze(),description:Ge(),backButton:{"data-componentid":"".concat(r,"-webhooks-page-back-button"),onClick:De,text:l("webhooks:goBackToWebhooks")},bottomMargin:!1,contentTopMargin:!0,pageHeaderMaxWidth:!1,"data-componentid":"".concat(r,"-webhooks-page-layout")},Je(),c.createElement(A.Z,{className:"grid-form"},c.createElement(A.Z.Row,{columns:1},c.createElement(A.Z.Column,{width:16},c.createElement(Oe,{initialValues:Te,channelConfigs:Ce,channelSubscriptions:(null==ue?void 0:ue.channelsSubscribed)||[],isLoading:Ae,isReadOnly:Re(),isCreateFormState:W,onSubmit:Me,isSubmitting:G||te,hideSubmitButton:Ne()&&!W,isWebSubHubAdopterMode:Ne()})))),$e())}},17199:(e,n,t)=>{t.d(n,{Z:()=>c});var o=t(92336),a=t(31549),r=t(31958),i=t(14517);const c=(0,t(44194).forwardRef)(((e,n)=>{var{className:t}=e,c=(0,o.__rest)(e,["className"]);return(0,a.jsx)(r.Z,Object.assign({ref:n,className:(0,i.Z)("oxygen-box","OxygenBox-root",t)},c))}))},78079:(e,n,t)=>{t.d(n,{Z:()=>c});var o=t(92336),a=t(31549),r=t(23800),i=t(14517);const c=(0,t(44194).forwardRef)(((e,n)=>{var{className:t}=e,c=(0,o.__rest)(e,["className"]);return(0,a.jsx)(r.Z,Object.assign({ref:n,className:(0,i.Z)("oxygen-skeleton","OxygenSkeleton-root",t)},c))}))},7294:(e,n,t)=>{t.d(n,{Z:()=>c});var o=t(81611),a=t.n(o),r=t(83948),i=t.n(r)()(a());i.push([e.id,".webhook-channel-config-form .heading-container{margin-bottom:8px !important}.webhook-channel-config-form .section-description{margin-top:0;margin-bottom:24px}.webhook-channel-config-form .channel-checkbox-container{margin-bottom:24px}.webhook-channel-config-form .channel-checkbox-container .MuiFormControlLabel-root{align-items:flex-start;margin:0;width:100%}.webhook-channel-config-form .channel-checkbox-container .MuiFormControlLabel-labelPlacementEnd .MuiFormControlLabel-label{padding-top:0;margin-top:0;line-height:1;width:100%}.webhook-channel-config-form .channel-checkbox-container .checkbox-control{padding:0;margin:0;display:flex;align-items:flex-start;width:100%}.webhook-channel-config-form .channel-checkbox-container .checkbox-control .MuiCheckbox-root{padding:0;margin:0;margin-right:8px;flex-shrink:0}.webhook-channel-config-form .channel-checkbox-container .checkbox-label{width:100%}.webhook-channel-config-form .channel-checkbox-container .checkbox-label .channel-name-container{display:flex;align-items:flex-start;gap:8px;margin-bottom:4px;width:100%;min-height:1.2em}.webhook-channel-config-form .channel-checkbox-container .checkbox-label .channel-name-container .channel-name{line-height:1.2;margin:0;padding:0;font-size:14px;flex:1;min-width:0;word-wrap:break-word;overflow-wrap:break-word;-webkit-hyphens:auto;-ms-hyphens:auto;hyphens:auto}.webhook-channel-config-form .channel-checkbox-container .checkbox-label .channel-name-container .channel-status-inline{display:flex;align-items:center;gap:4px;font-style:italic;font-size:.875rem;flex-shrink:0;white-space:nowrap}.webhook-channel-config-form .channel-checkbox-container .checkbox-label .channel-name-container .channel-status-inline.success{color:var(--oxygen-palette-success-main)}.webhook-channel-config-form .channel-checkbox-container .checkbox-label .channel-name-container .channel-status-inline.warning{color:var(--oxygen-palette-success-main)}.webhook-channel-config-form .channel-checkbox-container .checkbox-label .channel-name-container .channel-status-inline .status-icon{padding:1px}.webhook-channel-config-form .channel-checkbox-container .checkbox-label .channel-description{color:rgba(0,0,0,.6);font-size:12.25px;line-height:1.4;margin-top:4px;word-wrap:break-word;overflow-wrap:break-word;-webkit-hyphens:auto;-ms-hyphens:auto;hyphens:auto;width:100%}.webhook-channel-config-form .channel-checkbox-container .channel-grid .MuiGrid-container{gap:24px}.webhook-channel-config-form .channel-checkbox-container .channel-grid .MuiGrid-item{min-width:0}",""]);const c=i},84931:(e,n,t)=>{t.d(n,{Z:()=>c});var o=t(81611),a=t.n(o),r=t(83948),i=t.n(r)()(a());i.push([e.id,".form-wrapper .form-container{margin-top:0px;margin-bottom:0px}.form-wrapper .box-container{background-color:#f9fafb;border-radius:8px;padding:30px}.form-wrapper .box-container .box-field{margin-top:20px;margin-left:10px;margin-right:10px}.form-wrapper .text-field-container{margin-top:8px;margin-bottom:8px}.form-wrapper .select-field-container{margin-bottom:8px}.form-wrapper .hint-text{margin-top:0px;margin-bottom:8px}.form-wrapper .divider-container{margin-top:20px;margin-bottom:20px}.form-wrapper .heading-container{margin-top:20px;margin-bottom:20px}.form-wrapper .button-container{margin-top:30px}.form-wrapper .alert-title{font-weight:100}.form-wrapper .secondary-button{font-size:.875rem;padding:6px 12px;min-height:32px;margin-top:10px}.form-wrapper .placeholder{border-radius:8px;margin-bottom:8px}.form-wrapper .placeholder.label{height:20px;max-width:100px}.form-wrapper .placeholder.text-field{height:40px}.form-wrapper .placeholder-box>*{margin-bottom:8px}",""]);const c=i},24629:(e,n,t)=>{t.d(n,{Z:()=>c});var o=t(81611),a=t.n(o),r=t(83948),i=t.n(r)()(a());i.push([e.id,".webhook-endpoint-config-form .form-field-wrapper{padding:14px 0}.webhook-endpoint-config-form .form-field-wrapper:first-child{padding-top:0}.webhook-endpoint-config-form .form-field-wrapper:last-child{padding-bottom:0}.webhook-endpoint-config-form .alert-nutral,.webhook-endpoint-config-form .MuiAlert-root{margin-top:0;margin-bottom:0}.webhook-endpoint-config-form .endpoint-uri-alert{margin-top:10px;margin-bottom:0}.heading-container{margin-top:20px;margin-bottom:20px;font-weight:normal}.alert-nutral{background-color:var(--oxygen-palette-grey-100)}",""]);const c=i},72765:(e,n,t)=>{t.d(n,{Z:()=>c});var o=t(81611),a=t.n(o),r=t(83948),i=t.n(r)()(a());i.push([e.id,".grid-form{margin-top:20px !important;margin-bottom:20px !important}.webhook-status-section{margin:0}.webhook-status-section .secondary-button{height:35px}.webhook-status-section .MuiAlert-root{padding-bottom:14px;margin-bottom:0}",""]);const c=i}}]);