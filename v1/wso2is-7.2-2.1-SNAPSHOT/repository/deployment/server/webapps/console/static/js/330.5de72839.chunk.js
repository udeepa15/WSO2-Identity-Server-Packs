"use strict";(self.webpackChunk_wso2is_console=self.webpackChunk_wso2is_console||[]).push([[330],{80777:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(44194),a=n(74185);const r=function(){var e=(0,o.useContext)(a.Z);if(void 0===e)throw new Error("UseBrandingPreference must be used within a BrandingPreferenceProvider");return e}},60330:(e,t,n)=>{n.r(t),n.d(t,{default:()=>Pe});var o=n(55007),a=n(59827),r=n(15031),i=n(77742),l=n(38818),c=n(86105),s=n(6833),m=n(82406),u=n(20494),p=n(44194),d=n(10479),f=n(47245),g=n(21257),v=n(2292),b=n(96124),y=n(76271),E=n(43939);function h(e){return h="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},h(e)}function T(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,_(o.key),o)}}function S(e,t,n){return t&&T(e.prototype,t),n&&T(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function A(e,t,n){return(t=_(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _(e){var t=function(e,t){if("object"!=h(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=h(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==h(t)?t:t+""}var L=S((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}));A(L,"DEFAULT_CONTENT_TYPE","text/html; charset=UTF-8"),A(L,"DEAFULT_LOCALE","en-US"),A(L,"DEAFULT_LOCALE_FORMATTED","en_US"),A(L,"FEATURE_DICTIONARY",(new Map).set("EMAIL_TEMPLATES_CREATE","emailTemplates.create").set("EMAIL_TEMPLATES_UPDATE","emailTemplates.update").set("EMAIL_TEMPLATES_DELETE","emailTemplates.delete").set("EMAIL_TEMPLATES_READ","emailTemplates.read"));var w=v.AsgardeoSPAClient.getInstance().httpRequest.bind(v.AsgardeoSPAClient.getInstance()).bind(v.AsgardeoSPAClient.getInstance()),O=n(65612),F=n(50342),x=n(79438),j=function(e){var t,n=e.isEmailTemplatesListLoading,a=e.selectedEmailTemplate,i=e.selectedLocale,l=e.onTemplateChanged,c=e.onSubmit,s=e.onDeleteRequested,m=e.readOnly,g=e["data-componentid"],v=void 0===g?"email-customization-form":g,b=(0,d.$)().t,y=(0,u.fQ)().getLink,E=(0,f.v9)((function(e){return e.config.ui.features}));return n?p.createElement(u.pO,null):p.createElement(p.Fragment,null,p.createElement(x.vy,{keepDirtyOnReinitialize:!1,initialValues:{emailFooter:null==a?void 0:a.footer,emailSubject:null==a?void 0:a.subject},onSubmit:c,"data-componentid":v,render:function(e){var t=e.onSubmit;return p.createElement("form",{id:"email-customization-content-form",onSubmit:t},p.createElement(O.Z,{rowSpacing:2,container:!0},p.createElement(O.Z,{xs:8},p.createElement(x.SE,{key:"emailSubject",width:16,ariaLabel:"Email Subject Input",required:!0,"data-componentid":"".concat(v,"-email-subject"),name:"emailSubject",type:"text",helperText:p.createElement(u.kW,null,p.createElement(F.Z,{variant:"inherit"},b("extensions:develop.emailTemplates.form.inputs.subject.hint"))),label:b("extensions:develop.emailTemplates.form.inputs.subject.label"),placeholder:b("extensions:develop.emailTemplates.form.inputs.subject.placeholder"),component:x.xh,maxLength:255,minLength:1,readOnly:m}),p.createElement(u.X6,{as:"h6"},b("extensions:develop.emailTemplates.form.inputs.body.label")),p.createElement(u.v0,{type:"info",content:p.createElement(p.Fragment,null,b("extensions:develop.emailTemplates.form.inputs.body.hint"),p.createElement(u.eb,{link:y("develop.emailCustomization.form.emailBody.learnMore")},b("common:learnMore")))})),p.createElement(O.Z,{xs:16},p.createElement(u.pq,{lint:!0,allowFullScreen:!0,smart:!0,controlledFullScreenMode:!1,language:"htmlmixed",sourceCode:null==a?void 0:a.body,lineWrapping:!0,onChange:function(e,t,n){l({body:e.getValue()})},height:"500px",theme:"light",translations:{copyCode:b("common:copyToClipboard"),exitFullScreen:b("common:exitFullScreen"),goFullScreen:b("common:goFullScreen")},"data-componentId":"".concat(v,"-email-body-editor"),readOnly:m})),p.createElement(O.Z,{xs:8},p.createElement(x.SE,{key:"emailFooter",width:16,ariaLabel:"Email Footer Input",required:!1,"data-componentid":"".concat(v,"-email-footer"),name:"emailFooter",type:"text",helperText:p.createElement(u.kW,null,p.createElement(F.Z,{variant:"inherit"},b("extensions:develop.emailTemplates.form.inputs.footer.hint"))),label:b("extensions:develop.emailTemplates.form.inputs.footer.label"),placeholder:b("extensions:develop.emailTemplates.form.inputs.footer.placeholder"),component:x.xh,maxLength:255,minLength:1,readOnly:m}))),p.createElement(x.lP,{subscription:{values:!0},onChange:function(e){var t=e.values;l({footer:t.emailFooter,subject:t.emailSubject})}}))}}),p.createElement(o.di,{when:null==E||null===(t=E.emailTemplates)||void 0===t||null===(t=t.scopes)||void 0===t?void 0:t.delete},p.createElement(u.cN,{"data-componentid":"".concat(v,"-revert-email-provider-config"),actionTitle:b("extensions:develop.emailTemplates.dangerZone.action"),header:b("extensions:develop.emailTemplates.dangerZone.heading"),subheader:b("extensions:develop.emailTemplates.dangerZone.message"),isButtonDisabled:i===r.b.DEFAULT_FALLBACK_LANGUAGE,buttonDisableHint:b("extensions:develop.emailTemplates.dangerZone.actionDisabledHint"),onActionClick:s})))},C=n(28077),P=n(80777),k=n(17473),R=n(16590),U=n(64732),D=n(60826);function z(e){return z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},z(e)}function M(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,I(o.key),o)}}function I(e){var t=function(e,t){if("object"!=z(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=z(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==z(t)?t:t+""}var N,V,Z,B=function(){return e=function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)},n=[{key:"getTemplateBody",value:function(e,t,n,o,a){var r,i,l,c=o;if(!(null==t||null===(r=t.theme[null==t||null===(i=t.theme)||void 0===i?void 0:i.activeTheme])||void 0===r||null===(r=r.images)||void 0===r||null===(r=r.logo)||void 0===r||!r.imgURL)||(c=c.replace(/alt="{{organization.logo.altText}}"/g,"").replace(/src="{{organization.logo.img}}"/g,"")),!t)return c.replace(/{{organization.color.background}}/g,this.brandingFallBackValues.background_color).replace(/{{organization.color.primary}}/g,this.brandingFallBackValues.primary_color).replace(/{{organization.theme.background.color}}/g,this.brandingFallBackValues.light_background_color).replace(/{{organization.theme.border.color}}/g,this.brandingFallBackValues.light_border_color).replace(/{{organization.font}}/g,this.brandingFallBackValues.font_style).replace(/{{organization.font.color}}/g,this.brandingFallBackValues.font_color).replace(/{{organization.button.font.color}}/g,this.brandingFallBackValues.button_font_color).replace(/{{organization-name}}/g,e).replace(/{{organization.logo.img}}/g,this.brandingFallBackValues.light_logo_url);var s=k.t.migrateThemePreference(t,{theme:a}),m=s.organizationDetails,u=m.copyrightText,p=m.supportEmail,d=m.displayName,f=s.theme,g=f[f.activeTheme],v=f.activeTheme===D.gf.DARK?this.brandingFallBackValues.dark_logo_url:this.brandingFallBackValues.light_logo_url;return c=c.replace(/{{organization.color.background}}/g,g.colors.background.body.main).replace(/{{organization.color.primary}}/g,g.colors.primary.main).replace(/{{organization.theme.background.color}}/g,g.colors.background.surface.main?g.colors.background.surface.main:f.activeTheme===D.gf.DARK?"#111111":"#FFFFFF").replace(/{{organization.theme.border.color}}/g,g.colors.outlined.default?g.colors.outlined.default:f.activeTheme===D.gf.DARK?"#333333":"transparent").replace(/{{organization.font}}/g,g.typography.font.fontFamily).replace(/{{organization.font.color}}/g,g.colors.text.primary).replace(/{{organization.button.font.color}}/g,g.buttons.primary.base.font.color).replace(/{{organization-name}}/g,d||e).replace(/{{organization.logo.img}}/g,g.images.logo.imgURL||v).replace(/{{organization.logo.altText}}/g,g.images.logo.altText).replace(/{{organization.copyright.text}}/g,null!==(l=n&&(0,U.Z)(n.copyright))&&void 0!==l?l:u).replace(/{{organization.support.mail}}/g,p)}}],(t=null)&&M(e.prototype,t),n&&M(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,t,n}();function G(e){return G="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},G(e)}function q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function Q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?q(Object(n),!0).forEach((function(t){K(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):q(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function K(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=G(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=G(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==G(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,a,r,i,l=[],c=!0,s=!1;try{if(r=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(o=r.call(n)).done)&&(l.push(o.value),l.length!==t);c=!0);}catch(e){s=!0,a=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(s)throw a}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Y(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Y(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=Array(t);n<t;n++)o[n]=e[n];return o}N=B,Z={background_color:"#F8F9FA",button_font_color:"#FFFFFF",copyright_text:"&#169; YYYY WSO2 LLC.",dark_background_color:"#111111",dark_border_color:"#333333",dark_logo_url:"",font_color:"#231F20",font_style:"Montserrat",light_background_color:"#FFFFFF",light_border_color:"transparent",light_logo_url:"",primary_color:"#FF7300"},(V=I(V="brandingFallBackValues"))in N?Object.defineProperty(N,V,{value:Z,enumerable:!0,configurable:!0,writable:!0}):N[V]=Z;var H=function(e){var t=e.emailTemplate,n=e["data-componentid"],o=(0,P.Z)(),a=o.preference,r=o.customText,i=$((0,p.useState)(!1),2)[1],l=$((0,p.useState)(C.H.DEFAULT_PREFERENCE.theme),2),c=l[0],s=l[1],m=(0,f.v9)((function(e){var t;return null==e||null===(t=e.organization)||void 0===t||null===(t=t.organization)||void 0===t?void 0:t.name})),d=(0,f.v9)((function(e){var t;return null===(t=e.config.ui.theme)||void 0===t?void 0:t.name})),g=(0,p.useMemo)((function(){return null!=t&&t.body?B.getTemplateBody(m,null==a?void 0:a.preference,r,null==t?void 0:t.body,c):""}),[null==t?void 0:t.body,m,null==a?void 0:a.preference,c]);return(0,p.useEffect)((function(){d&&k.t.getPredefinedThemePreferences(d).then((function(e){s(Q(Q({},c),e))}))}),[d]),p.createElement("div",{className:"email-template-preview","data-componentid":n},p.createElement(u.hv,{isReady:i,"data-componentid":"".concat(n,"-iframe"),className:"email-template-preview-iframe"},p.createElement("div",{dangerouslySetInnerHTML:{__html:R.Encode.forHtml(g)},"data-componentid":"".concat(n,"-iframe-body-div")})))};H.defaultProps={"data-componentid":"email-customization-preview"};var W=n(85686),X=n(9788),J=n(19980),ee=n(91970),te=n(68509),ne=n(59673),oe=n(51835),ae=n.n(oe),re=n(27975),ie=n.n(re),le=n(55900),ce=n.n(le),se=n(21555),me=n.n(se),ue=n(3621),pe=n.n(ue),de=n(5062),fe=n.n(de),ge=n(14431),ve={};ve.styleTagTransform=fe(),ve.setAttributes=me(),ve.insert=ce().bind(null,"head"),ve.domAPI=ie(),ve.insertStyleElement=pe();ae()(ge.Z,ve);ge.Z&&ge.Z.locals&&ge.Z.locals;const be=function(){var e=(0,f.v9)((function(e){var t;return null===(t=e.config.deployment.extensions)||void 0===t?void 0:t.contactUsUrl}));return p.createElement(ee.Z,{className:"email-template-premium-banner oxygen-chip-premium",severity:"warning",icon:!1},p.createElement(ne.c,{i18nKey:"emailTemplates.updateTemplate.tags.premium.info",className:"email-template-premium-text"},"Unlock email template customization with our ",p.createElement("b",null,"Paid plans"),".",p.createElement(te.Z,{href:e}," Contact Us")," to upgrade."))};var ye=function(e){var t=e["data-componentid"],n=e.isSaveButtonLoading,o=e.onSaveButtonClick,a=(0,W.Z)().tierName,r=(0,d.$)().t,i=(0,f.v9)((function(e){var t;return null==e||null===(t=e.config)||void 0===t||null===(t=t.ui)||void 0===t?void 0:t.disableEmailTemplateForFreeTier}));return p.createElement(J.Z,{className:"email-customization-footer",attached:"bottom",padded:!0,"data-componentid":t},i&&a===X.R.FREE&&p.createElement(J.Z,{basic:!0},p.createElement(be,null)),p.createElement(u.KM,{size:"small",loading:n,onClick:function(e,t){o(e,t)},ariaLabel:"Email Templates form save button","data-componentid":"".concat(t,"-save-button")},r("common:save")))};ye.defaultProps={"data-componentid":"email-customization-footer"};const Ee=ye;var he=n(89141);function Te(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,a,r,i,l=[],c=!0,s=!1;try{if(r=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(o=r.call(n)).done)&&(l.push(o.value),l.length!==t);c=!0);}catch(e){s=!0,a=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(s)throw a}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Se(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Se(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Se(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=Array(t);n<t;n++)o[n]=e[n];return o}var Ae=function(e){var t=e.selectedEmailTemplateId,n=e.selectedEmailTemplateDescription,o=e.selectedLocale,a=e.emailTemplatesList,r=e.onTemplateSelected,i=e.onLocaleChanged,l=e["data-componentid"],c=(0,d.$)().t,s=Te((0,p.useState)(void 0),2),m=s[0],u=s[1],g=(0,f.v9)((function(e){return e.global.supportedI18nLanguages})),v=(0,p.useMemo)((function(){return null==a?void 0:a.map((function(e){return{text:e.displayName,value:e.id}}))}),[a]);return(0,p.useEffect)((function(){if(g){var e=[];Object.keys(g).map((function(t){e.push({key:g[t].code,text:p.createElement("div",null,p.createElement("i",{className:g[t].flag+" flag"}),g[t].name,", ",g[t].code),value:g[t].code})})),u(e)}}),[g]),p.createElement(J.Z,{className:"mb-4 p-4","data-componentid":l,padded:"very"},p.createElement(x.l0,{id:"email-customization-header-form",uncontrolledForm:!0,onSubmit:function(){}},p.createElement(he.Z,null,p.createElement(he.Z.Column,{mobile:16,computer:8},p.createElement(x.gN.Dropdown,{ariaLabel:"Email Template Dropdown",name:"selectedEmailTemplate",label:c("extensions:develop.emailTemplates.form.inputs.template.label"),options:v,required:!0,"data-componentid":"".concat(l,"-email-template-list"),hint:null!=n?n:null,placeholder:c("extensions:develop.emailTemplates.form.inputs.template.placeholder"),value:t,listen:r})),p.createElement(he.Z.Column,{mobile:16,computer:8},p.createElement(x.gN.Dropdown,{ariaLabel:"Email Template Locale Dropdown",name:"selectedEmailTemplateLocale",label:c("extensions:develop.emailTemplates.form.inputs.locale.label"),options:m,required:!0,"data-componentid":"".concat(l,"-email-template-locale"),placeholder:c("extensions:develop.emailTemplates.form.inputs.locale.placeholder"),defaultValue:o,value:o,listen:i})))))};Ae.defaultProps={"data-componentid":"email-customization-header"};const _e=Ae;function Le(e){return Le="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Le(e)}function we(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function Oe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?we(Object(n),!0).forEach((function(t){Fe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):we(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Fe(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=Le(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t||"default");if("object"!=Le(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Le(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function xe(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,a,r,i,l=[],c=!0,s=!1;try{if(r=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(o=r.call(n)).done)&&(l.push(o.value),l.length!==t);c=!0);}catch(e){s=!0,a=e}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(s)throw a}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return je(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?je(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function je(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=Array(t);n<t;n++)o[n]=e[n];return o}var Ce=function(e){var t,n,v,h=e["data-componentid"],T=xe((0,p.useState)([]),2),S=T[0],A=T[1],_=xe((0,p.useState)(),2),O=_[0],F=_[1],x=xe((0,p.useState)(),2),C=x[0],P=x[1],k=xe((0,p.useState)(r.b.DEFAULT_FALLBACK_LANGUAGE),2),R=k[0],U=k[1],D=xe((0,p.useState)(),2),z=D[0],M=D[1],I=xe((0,p.useState)(),2),N=I[0],V=I[1],Z=xe((0,p.useState)(!1),2),B=Z[0],G=Z[1],q=xe((0,p.useState)(!1),2),Q=q[0],K=q[1],$=xe((0,p.useState)(!1),2),Y=$[0],W=$[1],X=xe((0,p.useState)(!1),2),J=X[0],ee=X[1],te=xe((0,p.useState)(!1),2),ne=te[0],oe=te[1],ae=xe((0,p.useState)(),2),re=ae[0],ie=ae[1],le=(0,f.v9)((function(e){return e.config.deployment.extensions.emailTemplates})),ce=(0,f.v9)((function(e){var t;return null==e||null===(t=e.config)||void 0===t||null===(t=t.ui)||void 0===t?void 0:t.enableCustomEmailTemplates})),se=(0,f.v9)((function(e){var t;return null==e||null===(t=e.config)||void 0===t||null===(t=t.ui)||void 0===t||null===(t=t.features)||void 0===t?void 0:t.emailTemplates})),me=(0,f.v9)((function(e){var t;return null==e||null===(t=e.auth)||void 0===t?void 0:t.allowedScopes})),ue=(0,f.v9)((function(e){return e.config.ui.features})),pe=(0,f.I0)(),de=(0,d.$)().t,fe=(0,u.fQ)().getLink,ge=(0,o.EV)(null==se||null===(t=se.scopes)||void 0===t?void 0:t.update),ve=(0,o.EV)(null==se||null===(n=se.scopes)||void 0===n?void 0:n.create),be=(0,p.useMemo)((function(){return!(0,c.cr)(se,L.FEATURE_DICTIONARY.get("EMAIL_TEMPLATES_UPDATE"))||!ge}),[se,me]),ye=(0,p.useMemo)((function(){return(0,c.cr)(se,L.FEATURE_DICTIONARY.get("EMAIL_TEMPLATES_CREATE"))&&ve}),[se,me]),he=(0,g.z)().isSubOrganization,Te=(0,i.Z)(l.Z.INVITED_USER_REGISTRATION).data,Se=function(){var e={headers:{Accept:"application/json","Content-Type":"application/json"},method:s.f2.GET,url:"".concat(y.h.getState().config.endpoints.emailManagement,"/template-types")},t=(0,b.Z)(e),n=t.data,o=t.error;return{data:n,error:o,isLoading:!o&&!n,isValidating:t.isValidating,mutate:t.mutate}}(),Ae=Se.data,Le=Se.isLoading,we=Se.error,Fe=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:r.b.DEFAULT_FALLBACK_LANGUAGE,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=t.replace("-","_"),l={headers:{Accept:"application/json","Content-Type":"application/json"},method:s.f2.GET,url:y.h.getState().config.endpoints.emailManagement+"/template-types/".concat(e,"/org-templates/").concat(i)};o&&(l.params={resolve:!0}),n&&(l.url=y.h.getState().config.endpoints.emailManagement+"/template-types/".concat(e,"/system-templates/").concat(L.DEAFULT_LOCALE_FORMATTED));var c=(0,b.Z)(a?l:null,{onErrorRetry:function(e){e.response.status}}),m=c.data,u=c.error;return{data:m,error:u,isLoading:!u&&!m,isValidating:c.isValidating,mutate:c.mutate}}(O,R,J,ne,!!O),je=Fe.data,Ce=Fe.isLoading,Pe=Fe.error,ke=Fe.mutate;(0,p.useEffect)((function(){var e,t,n=["askpassword","resendaskpassword"],o=Ae?Ae.filter((function(e){var t,o=(null===(t=e.displayName)||void 0===t?void 0:t.toLowerCase())||"";return!((null==Te||!Te.isEnabled)&&o.includes("orchestrated"))&&((null==Te||!Te.isEnabled||!n.includes(o))&&(!!ce||!(null==le||!le.find((function(t){return t.id===e.id})))))})).map((function(e){var t=null==le?void 0:le.find((function(t){return t.id===e.id}));return Oe(Oe({},e),{},{description:(null==t?void 0:t.description)||"".concat(e.displayName," Template"),displayName:(null==t?void 0:t.displayName)||e.displayName})})):[];(A(o),O)||(F(null==o||null===(e=o[0])||void 0===e?void 0:e.id),P(null==o||null===(t=o[0])||void 0===t?void 0:t.description))}),[Ae]),(0,p.useEffect)((function(){M(Oe({},je)),W(!1),je&&Object.keys(je).length>0&&V(Oe({},je))}),[je]),(0,p.useEffect)((function(){var e,t;we&&(we.response.data.description?pe((0,m.V_)({description:null===(e=we.response)||void 0===e||null===(e=e.data)||void 0===e?void 0:e.description,level:s.QU.ERROR,message:null!==(t=we.response.data.message)&&void 0!==t?t:de("extensions:develop.emailTemplates.notifications.getEmailTemplateList.error.message")})):pe((0,m.V_)({description:de("extensions:develop.emailTemplates.notifications.getEmailTemplateList.error.description"),level:s.QU.ERROR,message:de("extensions:develop.emailTemplates.notifications.getEmailTemplateList.error.message")})))}),[we]),(0,p.useEffect)((function(){if(Pe&&O&&Pe!==re){if(ie(Pe),404===Pe.response.status)return W(!0),he()&&!ne?void oe(!0):J||R!==L.DEAFULT_LOCALE?ye?void G(!0):(V(void 0),void K(!0)):void ee(!0);var e,t;if(Pe.response.data.description)pe((0,m.V_)({description:null===(e=Pe.response)||void 0===e||null===(e=e.data)||void 0===e?void 0:e.description,level:s.QU.ERROR,message:null!==(t=Pe.response.data.message)&&void 0!==t?t:de("extensions:develop.emailTemplates.notifications.getEmailTemplate.error.message")}));else pe((0,m.V_)({description:de("extensions:develop.emailTemplates.notifications.getEmailTemplate.error.description"),level:s.QU.ERROR,message:de("extensions:develop.emailTemplates.notifications.getEmailTemplate.error.message")}))}}),[Pe,J,ne]),(0,p.useEffect)((function(){var e=window.location.hash;if(e.startsWith("#templateId=")){var t,n=e.split("=")[1];F(n),P(null==S||null===(t=S.find((function(e){return e.id===n})))||void 0===t?void 0:t.description)}}),[window.location.hash]);var Re,Ue=function(){var e=Oe(Oe({},z),{},{id:R.replace("-","_")});null!=e&&e.contentType||(e.contentType=L.DEFAULT_CONTENT_TYPE),J||ne?function(e,t){var n={data:{body:t.body,contentType:t.contentType,footer:t.footer,locale:t.id,subject:t.subject},headers:{Accept:"application/json","Content-Type":"application/json"},method:s.f2.POST,url:y.h.getState().config.endpoints.emailManagement+"/template-types/".concat(e,"/org-templates")};return w(n).then((function(e){if(200!==e.status&&201!==e.status)throw new E.u("Error occurred while creating the email template.",null,e.status,e.request,e,e.config);return Promise.resolve(e.data)})).catch((function(e){var t;throw new E.u("Error occurred while creating the email template.",e.stack,null===(t=e.response)||void 0===t||null===(t=t.data)||void 0===t?void 0:t.code,e.request,e.response,e.config)}))}(O,e).then((function(e){pe((0,m.V_)({description:de("extensions:develop.emailTemplates.notifications.updateEmailTemplate.success.description"),level:s.QU.SUCCESS,message:de("extensions:develop.emailTemplates.notifications.updateEmailTemplate.success.message")})),ee(!1),oe(!1)})).catch((function(e){var t;pe((0,m.V_)({description:de("extensions:develop.emailTemplates.notifications.updateEmailTemplate.error.description"),level:s.QU.ERROR,message:null!==(t=e.message)&&void 0!==t?t:de("extensions:develop.emailTemplates.notifications.updateEmailTemplate.error.message")}))})).finally((function(){return ke()})):function(e,t){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:r.b.DEFAULT_FALLBACK_LANGUAGE).replace("-","_"),o={data:{body:t.body,contentType:t.contentType,footer:t.footer,subject:t.subject},headers:{Accept:"application/json","Content-Type":"application/json"},method:s.f2.PUT,url:y.h.getState().config.endpoints.emailManagement+"/template-types/".concat(e,"/org-templates/").concat(n)};return w(o).then((function(e){if(200!==e.status&&201!==e.status)throw new E.u("Error occurred while updating the email template.",null,e.status,e.request,e,e.config);return Promise.resolve(e.data)})).catch((function(e){var t;throw new E.u("Error occurred while updating the email template.",e.stack,null===(t=e.response)||void 0===t||null===(t=t.data)||void 0===t?void 0:t.code,e.request,e.response,e.config)}))}(O,e,R).then((function(e){pe((0,m.V_)({description:de("extensions:develop.emailTemplates.notifications.updateEmailTemplate.success.description"),level:s.QU.SUCCESS,message:de("extensions:develop.emailTemplates.notifications.updateEmailTemplate.success.message")})),ee(!1),oe(!1)})).catch((function(e){var t;pe((0,m.V_)({description:de("extensions:develop.emailTemplates.notifications.updateEmailTemplate.error.description"),level:s.QU.ERROR,message:null!==(t=e.message)&&void 0!==t?t:de("extensions:develop.emailTemplates.notifications.updateEmailTemplate.error.message")}))})).finally((function(){return ke()})),W(!1)},De=function(){var e,t,n,o;(e=O,t=R,n=t.replace("-","_"),o={headers:{Accept:"application/json","Content-Type":"application/json"},method:s.f2.DELETE,url:y.h.getState().config.endpoints.emailManagement+"/template-types/".concat(e,"/org-templates/").concat(n)},w(o).then((function(e){if(204!==e.status)throw new E.u("Error occurred while deleting the email template.",null,e.status,e.request,e,e.config);return e})).catch((function(e){var t;throw new E.u("Error occurred while deleting the email template.",e.stack,null===(t=e.response)||void 0===t||null===(t=t.data)||void 0===t?void 0:t.code,e.request,e.response,e.config)}))).then((function(e){pe((0,m.V_)({description:de("extensions:develop.emailTemplates.notifications.deleteEmailTemplate.success.description"),level:s.QU.SUCCESS,message:de("extensions:develop.emailTemplates.notifications.deleteEmailTemplate.success.message")})),ee(!0),oe(!1)})).catch((function(e){var t;pe((0,m.V_)({description:de("extensions:develop.emailTemplates.notifications.deleteEmailTemplate.error.description"),level:s.QU.ERROR,message:null!==(t=e.message)&&void 0!==t?t:de("extensions:develop.emailTemplates.notifications.deleteEmailTemplate.error.message")}))})).finally((function(){U(r.b.DEFAULT_FALLBACK_LANGUAGE)}))};return p.createElement(a.Z,null,p.createElement(u.Xg,{title:de("extensions:develop.emailTemplates.page.header"),pageTitle:"Email Templates",description:p.createElement(p.Fragment,null,de("extensions:develop.emailTemplates.page.description"),p.createElement(u.eb,{link:fe("develop.emailCustomization.learnMore")},de("common:learnMore"))),titleTextAlign:"left",bottomMargin:!1,"data-componentid":h},p.createElement(_e,{selectedEmailTemplateId:O,selectedEmailTemplateDescription:C,selectedLocale:R,emailTemplatesList:S,onTemplateSelected:function(e){var t;W(!1),ee(!1),oe(!1),V(void 0),U(r.b.DEFAULT_FALLBACK_LANGUAGE),F(e),P(null==S||null===(t=S.find((function(t){return t.id===e})))||void 0===t?void 0:t.description)},onLocaleChanged:function(e){V(Oe({},z)),W(!1),ee(!1),oe(!1),U(e)}}),p.createElement(u.M$,{attached:"top",secondary:!1,pointing:!1,panes:(Re=[],Re.push({menuItem:de("extensions:develop.emailTemplates.tabs.preview.label"),render:function(){return p.createElement(u.M$.Pane,{className:"email-template-resource-tab-pane",attached:"bottom","data-componentid":"email-customization-template-preview"},p.createElement(H,{emailTemplate:z||N}))}}),Re.push({menuItem:de("extensions:develop.emailTemplates.tabs.content.label"),render:function(){return p.createElement(u.M$.Pane,{className:"email-template-resource-tab-pane",attached:"bottom","data-componentid":"email-customization-template-content"},p.createElement(j,{isEmailTemplatesListLoading:Le||Ce,selectedEmailTemplate:N,selectedLocale:R,onTemplateChanged:function(e){return function(e){M(Oe(Oe({},z),e))}(e)},onSubmit:Ue,onDeleteRequested:De,readOnly:be||Y&&!ye}))}}),Re),onTabChange:function(){V(z)},"data-componentid":"".concat(h,"-forms")}),p.createElement(o.di,{when:null==ue||null===(v=ue.emailTemplates)||void 0===v||null===(v=v.scopes)||void 0===v?void 0:v.update},(!Y||ye)&&p.createElement(Ee,{isSaveButtonLoading:Le||Ce,onSaveButtonClick:Ue})),p.createElement(u.cV,{type:"info",open:B,primaryAction:de("common:confirm"),secondaryAction:de("common:cancel"),onSecondaryActionClick:function(){return M(void 0),V(void 0),void G(!1)},onPrimaryActionClick:function(){return M(N),G(!1),ee(!0),void oe(!1)},"data-componentid":"".concat(h,"-replicate-previous-template-confirmation-modal"),closeOnDimmerClick:!1},p.createElement(u.cV.Header,{"data-componentid":"".concat(h,"-replicate-previous-template-confirmation-modal-header")},de("extensions:develop.emailTemplates.modal.replicateContent.header")),p.createElement(u.cV.Message,{attached:!0,info:!0,"data-componentid":"".concat(h,"-replicate-previous-template-confirmation-modal-message")},de("extensions:develop.emailTemplates.modal.replicateContent.message"))),p.createElement(u.cV,{type:"info",open:Q,primaryAction:de("common:okay"),onPrimaryActionClick:function(){K(!1)},"data-componentid":"".concat(h,"-update-template-from-root-org-modal"),closeOnDimmerClick:!0},p.createElement(u.cV.Header,{"data-componentid":"".concat(h,"-update-template-from-root-org-modal-header")},de("extensions:develop.emailTemplates.modal.updateFromRootOrg.header")),p.createElement(u.cV.Message,{attached:!0,info:!0,"data-componentid":"".concat(h,"-update-template-from-root-org-modal-message")},de("extensions:develop.emailTemplates.modal.updateFromRootOrg.message")),p.createElement(u.cV.Content,{"data-testid":"".concat(h,"-update-template-from-root-org-modal-content")},de("extensions:develop.emailTemplates.modal.updateFromRootOrg.content")))))};Ce.defaultProps={"data-componentid":"email-customization-page"};const Pe=Ce},14431:(e,t,n)=>{n.d(t,{Z:()=>l});var o=n(81611),a=n.n(o),r=n(83948),i=n.n(r)()(a());i.push([e.id,".email-template-premium-banner{margin-top:2px;font-weight:100}.email-template-premium-banner .email-template-premium-banner-link{cursor:pointer}",""]);const l=i}}]);