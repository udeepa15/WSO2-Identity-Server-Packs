"use strict";(self.webpackChunk_wso2is_console=self.webpackChunk_wso2is_console||[]).push([[3961],{63961:(e,t,n)=>{n.r(t),n.d(t,{ApplicationsSettingsForm:()=>R,default:()=>y});var i=n(55007),a=n(60486),o=n(40838),s=n(6833),r=n(82406),l=n(79438),c=n(20494),p=n(44194),d=n(10479),u=n(47245),f=n(6567),g=n(2292),m=n(76271),h=g.AsgardeoSPAClient.getInstance().httpRequest.bind(g.AsgardeoSPAClient.getInstance()),S=n(96124);function v(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,a,o,s,r=[],l=!0,c=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(i=o.call(n)).done)&&(r.push(i.value),r.length!==t);l=!0);}catch(e){c=!0,a=e}finally{try{if(!l&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(c)throw a}}return r}}(e,t)||function(e,t){if(e){if("string"==typeof e)return b(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?b(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=Array(t);n<t;n++)i[n]=e[n];return i}var E="applications-settings",R=function(e){var t,n=e.mandateSSA,g=e.authenticationRequired,b=e.ssaJwks,R=e.dcrEndpoint,y=e.enableFapiEnforcement,k=e["data-componentid"],C=void 0===k?"applications-settings-page":k,A=(0,u.I0)(),w=(0,d.$)().t,J=(0,c.fQ)().getLink,L=(0,u.v9)((function(e){return e.config.ui.features.dynamicClientRegistration})),O=v((0,p.useState)(g),2),I=O[0],q=void 0===I||I,x=O[1],F=v((0,p.useState)(n),2),P=F[0],_=void 0===P?!q:P,T=F[1],V=v((0,p.useState)(y),2),j=V[0],M=V[1],U=v((0,p.useState)(b),2),D=U[0],N=U[1],Q=v((0,p.useState)(R),2),B=Q[0],$=Q[1],H=v((0,p.useState)(!1),2),W=H[0],z=H[1],G=(0,i.EV)(null==L||null===(t=L.scopes)||void 0===t?void 0:t.update),K=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t={headers:{Accept:"application/json","Content-Type":"application/json"},method:s.f2.GET,url:"".concat(m.h.getState().config.endpoints.dcrConfiguration)},n=(0,S.Z)(e?t:null),i=n.data,a=n.error;return{data:i,error:a,isLoading:!a&&!i,isValidating:n.isValidating,mutate:n.mutate}}(),X=K.data,Z=K.error,Y=K.isLoading;(0,p.useEffect)((function(){X&&(T(null==X?void 0:X.mandateSSA),x(null==X?void 0:X.authenticationRequired),M(null==X?void 0:X.enableFapiEnforcement),N(null==X?void 0:X.ssaJwks))}),[X]),(0,p.useEffect)((function(){var e;Z&&(null!==(e=Z.response)&&void 0!==e&&null!==(e=e.data)&&void 0!==e&&e.description?A((0,r.V_)({description:Z.response.data.description,level:s.QU.ERROR,message:w("console:develop.pages.applicationsSettings.notifications.genericError.message")})):A((0,r.V_)((0,r.V_)({description:w("console:develop.pages.applicationsSettings.notifications.genericError.description"),level:s.QU.ERROR,message:w("console:develop.pages.applicationsSettings.notifications.genericError.message")}))))}),[Z]),(0,p.useEffect)((function(){void 0===R&&(0,f.qt)().then((function(e){$(e.dynamicClientRegistrationEndpoint)})).catch((function(){A((0,r.V_)({description:w("applications:notifications.fetchOIDCIDPConfigs.genericError.description"),level:s.QU.ERROR,message:w("applications:notifications.fetchOIDCIDPConfigs.genericError.message")}))}))}));var ee=function(e){return w("console:develop.pages.applicationsSettings.notifications.error.description",{description:e.response.data.description})},te=function(e){z(!0);var t=[{operation:"REPLACE",path:"/authenticationRequired",value:e.authenticationRequired},{operation:"REPLACE",path:"/enableFapiEnforcement",value:e.enableFapiEnforcement},{operation:"REPLACE",path:"/mandateSSA",value:e.mandateSSA}];null!=e.ssaJwks&&t.push({operation:"REPLACE",path:"/ssaJwks",value:e.ssaJwks}),function(e){var t={data:e,headers:{Accept:"application/json","Content-Type":"application/json"},method:s.f2.PATCH,url:m.h.getState().config.endpoints.dcrConfiguration};return h(t).then((function(e){return 200!==e.status?Promise.reject(new Error("Failed to update DCR Configuration.")):Promise.resolve(e.data)})).catch((function(e){return Promise.reject(e)}))}(t).then((function(){A((0,r.V_)({description:w("console:develop.pages.applicationsSettings.notifications.success.description"),level:s.QU.SUCCESS,message:w("console:develop.pages.applicationsSettings.notifications.success.message")}))})).catch((function(e){!function(e){var t;null!=e&&null!==(t=e.response)&&void 0!==t&&null!==(t=t.data)&&void 0!==t&&t.detail?A((0,r.V_)({description:ee(e),level:s.QU.ERROR,message:w("console:develop.pages.applicationsSettings.notifications.error.message")})):A((0,r.V_)({description:w("console:develop.pages.applicationsSettings.notifications.genericError.description"),level:s.QU.ERROR,message:w("console:develop.pages.applicationsSettings.notifications.genericError.message")}))}(e)})).finally((function(){z(!1)}))};return Y?p.createElement(c.pJ,{padded:"very"},p.createElement(c.pO,{inline:"centered",active:!0})):p.createElement(c.Xg,{title:w("console:develop.pages.applicationsSettings.title"),description:p.createElement(p.Fragment,null,w("console:develop.pages.applicationsSettings.subTitle"),p.createElement(c.eb,{link:J("develop.applications.applicationsSettings.dcr.learnMore")},w("console:develop.pages.applicationsSettings.learnMore"))),backButton:{"data-componentid":"".concat(C,"-page-back-button"),onClick:function(){o.m.push(a.$.getPaths().get("APPLICATIONS"))},text:w("console:develop.pages.applicationsSettings.backButton")},bottomMargin:!1,contentTopMargin:!0,pageHeaderMaxWidth:!0,"data-componentid":"".concat(C,"-page-layout")},p.createElement(c.pJ,{padded:"very"},p.createElement(l.l0,{id:E,uncontrolledForm:!1,onSubmit:function(e){te(e)},initialValues:{authenticationRequired:q,dcrEndpoint:B,enableFapiEnforcement:j,mandateSSA:_,ssaJwks:D},validate:function(e){var t={ssaJwks:void 0};return _&&!e.ssaJwks&&(t.ssaJwks=w("applications:forms.applicationsSettings.fields.ssaJwks.validations.empty")),t},"data-componentid":"".concat(C,"-form")},p.createElement(l.gN.Input,{ariaLabel:"DCR Endpoint",inputType:"text",name:"dcrEndpoint",label:w("applications:forms.applicationsSettings.fields.dcrEndpoint.label"),hint:w("applications:forms.applicationsSettings.fields.dcrEndpoint.hint"),required:!1,readOnly:!0,maxLength:150,minLength:10,width:16,listen:null,"data-componentid":"".concat(C,"-dcr-endpoint-url")},p.createElement(c.OR,{value:B})),p.createElement(l.gN.Checkbox,{ariaLabel:"Require Authentication",name:"authenticationRequired",label:w("applications:forms.applicationsSettings.fields.authenticationRequired.label"),hint:p.createElement(p.Fragment,null,w("applications:forms.applicationsSettings.fields.authenticationRequired.hint"),p.createElement(c.eb,{link:J("develop.applications.applicationsSettings.dcr.authenticationRequired.learnMore")},w("console:develop.pages.applicationsSettings.learnMore"))),tabIndex:3,width:16,listen:function(e){x(e),e||T(!0)},readOnly:!G,"data-componentid":"".concat(C,"-authenticationRequired-checkbox")}),p.createElement(l.gN.Checkbox,{ariaLabel:"Mandate SSA",name:"mandateSSA",label:w("applications:forms.applicationsSettings.fields.mandateSSA.label"),hint:w("applications:forms.applicationsSettings.fields.mandateSSA.hint"),tabIndex:3,width:16,readOnly:!G||!q,listen:function(e){return T(e)},"data-componentid":"".concat(C,"-mandateSSA-checkbox")}),p.createElement(l.gN.Input,{ariaLabel:"JWKS Endpoint",inputType:"url",name:"ssaJwks",label:w("applications:forms.applicationsSettings.fields.ssaJwks.label"),placeholder:w("applications:forms.applicationsSettings.fields.ssaJwks.placeholder"),hint:w("applications:forms.applicationsSettings.fields.ssaJwks.hint"),required:_||!q,maxLength:150,minLength:10,width:16,readOnly:!G,"data-componentid":"".concat(C,"-ssaJwks-url")}),p.createElement(l.gN.Checkbox,{ariaLabel:"Enforce Fapi",name:"enableFapiEnforcement",label:w("applications:forms.applicationsSettings.fields.enforceFapi.label"),hint:w("applications:forms.applicationsSettings.fields.enforceFapi.hint"),tabIndex:3,width:16,listen:function(e){return M(e)},readOnly:!G,"data-componentid":"".concat(C,"-enableFapiEnforcement-checkbox")}),p.createElement(l.gN.Button,{form:E,size:"small",buttonType:"primary_btn",ariaLabel:"DCR Configuration update button",name:"update-button",disabled:W||!G,loading:W,label:w("common:update"),"data-componentid":"".concat(C,"-submit-button")}))))};const y=R}}]);