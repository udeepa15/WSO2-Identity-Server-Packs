"use strict";(self.webpackChunk_wso2is_console=self.webpackChunk_wso2is_console||[]).push([[1790],{9779:(e,t,n)=>{n.d(t,{A:()=>i,H:()=>o});var l=n(7231),o=function(e,t,n){var l=t.shift(),i=n.find((function(e){return e.name===l}));return i||(i={key:e.resourcePath,name:l,title:e.displayName},n.push(i)),t.length&&o(e,t,i.children||(i.children=[])),n},i=function(e,t){return!(!e||!t)&&(e===l.nL.IMPERSONATOR_ROLE_NAME&&t===l.nL.MY_ACCOUNT_APP_NAME)}},33519:(e,t,n)=>{n.d(t,{u:()=>m});var l=n(17901),o=n(29571),i=n(32637),r=n(32463),a=n(16199),c=n(48934),s=n(20494),u=n(44194),d=n(10479),m=function(e){var t,n=e.isOpen,m=e.onClose,p=e.selectedRole,v=e["data-componentid"],f=(0,d.$)().t;return u.createElement(s.cV,{onClose:function(){return m()},type:"negative",open:n,secondaryAction:f("common:close"),onSecondaryActionClick:function(){return m()},"data-testid":v,closeOnDimmerClick:!1},u.createElement(s.cV.Header,{"data-testid":"".concat(v,"-header")},f("roles:list.confirmations.deleteItemError.header")),u.createElement(s.cV.Message,{attached:!0,negative:!0,"data-testid":"".concat(v,"-message")},f("roles:list.confirmations.deleteItemError.message")),u.createElement(s.cV.Content,{"data-testid":"".concat(v,"-content")},u.createElement("span",null,f("roles:list.confirmations.deleteItemError.content")),u.createElement(o.Z,{hidden:!0}),u.createElement(i.Z,null,u.createElement(r.Z,null,u.createElement(a.Z,null,u.createElement(l.sB,null)),u.createElement(c.Z,{primary:null==p||null===(t=p.audience)||void 0===t?void 0:t.display})))))};m.defaultProps={"data-componentid":"role-delete-error-confirmation-modal"}},11790:(e,t,n)=>{n.r(t),n.d(t,{default:()=>M});var l=n(55007),o=n(6567),i=n(25134),r=n(60486),a=n(54715),c=n(90302),s=n(40838),u=n(21257),d=n(6833),m=n(82406),p=n(20494),v=n(44194),f=n(10479),y=n(47245),h=n(26154),E=n(47625),g=n(9183),R=n(79282),A=n(64961),I=n(36940),L=n(86105),b=n(12638),C=n(37077),O=n(9779),S=n(33519),P=n(7231);function T(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var l,o,i,r,a=[],c=!0,s=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(l=i.call(n)).done)&&(a.push(l.value),a.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=n.return&&(r=n.return(),Object(r)!==r))return}finally{if(s)throw o}}return a}}(e,t)||function(e,t){if(e){if("string"==typeof e)return _(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,l=Array(t);n<t;n++)l[n]=e[n];return l}var N=function(e){var t=e.handleRoleDelete,n=e.onEmptyListPlaceholderActionClick,o=e.onSearchQueryClear,i=e.roleList,a=e.searchQuery,c=e["data-componentid"],u=(0,f.$)().t,d=(0,y.v9)((function(e){var t;return null==e||null===(t=e.auth)||void 0===t?void 0:t.allowedScopes})),m=(0,y.v9)((function(e){var t;return null==e||null===(t=e.config)||void 0===t||null===(t=t.ui)||void 0===t||null===(t=t.features)||void 0===t?void 0:t.userRoles})),E=(0,y.v9)((function(e){var t;return null==e||null===(t=e.config)||void 0===t||null===(t=t.ui)||void 0===t||null===(t=t.features)||void 0===t?void 0:t.userRolesV3})),g=(0,y.v9)((function(e){var t;return null==e||null===(t=e.config)||void 0===t||null===(t=t.ui)||void 0===t?void 0:t.administratorRoleDisplayName})),R=(0,y.v9)((function(e){return e.config.ui.features})),_=(0,y.v9)((function(e){var t;return null==e||null===(t=e.config)||void 0===t||null===(t=t.ui)||void 0===t||null===(t=t.features)||void 0===t||null===(t=t.userRolesV3)||void 0===t?void 0:t.enabled})),N=(0,y.v9)((function(e){var t;return null==e||null===(t=e.config)||void 0===t||null===(t=t.ui)||void 0===t?void 0:t.isSystemRolesEditAllowed})),k=(0,v.useMemo)((function(){var e;return!(0,L.cr)(m,P.nL.FEATURE_DICTIONARY.get("ROLE_UPDATE"))||!(0,L.Xr)(m,null==m||null===(e=m.scopes)||void 0===e?void 0:e.update,d)}),[m,d]),w=(0,v.useMemo)((function(){var e,t;return _?null==E||null===(e=E.scopes)||void 0===e?void 0:e.create:null==R||null===(t=R.userRoles)||void 0===t||null===(t=t.scopes)||void 0===t?void 0:t.create}),[_,E,R]),D=T((0,v.useState)(!1),2),M=D[0],U=D[1],V=T((0,v.useState)(),2),Z=V[0],x=V[1],Q=T((0,v.useState)(!1),2),F=Q[0],j=Q[1],z=function(e){s.m.push(r.$.getPaths().get("ROLE_EDIT").replace(":id",e))};return v.createElement(v.Fragment,null,v.createElement(p.wQ,{loadingStateOptions:{imageType:"square"},actions:[{hidden:function(e){var t;return null==e||null===(t=e.meta)||void 0===t?void 0:t.systemRole},icon:function(){return k?"eye":"pencil alternate"},onClick:function(e,t){return!k&&z(null==t?void 0:t.id)},popupText:function(){return u(k?"common:view":"common:edit")},renderer:"semantic-icon"},{hidden:function(e){var t,n,l,o,i=null==e||null===(t=e.properties)||void 0===t?void 0:t.some((function(e){return(null==e?void 0:e.name)===P.nL.IS_SHARED_ROLE&&"true"===(null==e?void 0:e.value)}));return(null==e||null===(n=e.meta)||void 0===n?void 0:n.systemRole)||(null==e?void 0:e.displayName)===I.nL.ADMIN_ROLE||(null==e?void 0:e.displayName)===I.nL.ADMIN_GROUP||(null==e?void 0:e.displayName)===g||!(0,L.cr)(m,P.nL.FEATURE_DICTIONARY.get("ROLE_DELETE"))||!(0,L.Xr)(m,null==m||null===(l=m.scopes)||void 0===l?void 0:l.delete,d)||i||(0,O.A)(null==e?void 0:e.displayName,null==e||null===(o=e.audience)||void 0===o?void 0:o.display)},icon:function(){return"trash alternate"},onClick:function(e,t){!function(e){var t;x(e),(null==e||null===(t=e.audience)||void 0===t||null===(t=t.type)||void 0===t?void 0:t.toUpperCase())===P.cv.APPLICATION?j(!0):U(!0)}(t)},popupText:function(){return u("roles:list.popups.delete",{type:"Role"})},renderer:"semantic-icon"}],columns:[{allowToggleVisibility:!1,dataIndex:"name",id:"name",key:"name",render:function(e){var t,n=null==e||null===(t=e.properties)||void 0===t?void 0:t.some((function(e){return(null==e?void 0:e.name)===P.nL.IS_SHARED_ROLE&&"true"===(null==e?void 0:e.value)}));return v.createElement(b.Z,{image:!0,as:"h6",className:"header-with-icon","data-componentid":"".concat(c,"-item-heading")},v.createElement(p.JT,{image:v.createElement(p.Xo,{name:null==e?void 0:e.displayName[0],size:"mini","data-componentid":"".concat(c,"-item-image-inner")}),size:"mini",spaced:"right","data-componentid":"".concat(c,"-item-image")}),v.createElement(b.Z.Content,null,null==e?void 0:e.displayName,n&&v.createElement(C.Z,{size:"mini"},u("roles:list.labels.shared"))))},title:u("roles:list.columns.name")},{allowToggleVisibility:!1,dataIndex:"audience",id:"audience",key:"audience",render:function(e){return(null==e?void 0:e.audience)&&v.createElement(C.Z,{size:"mini"},e.audience.type,e.audience.type.toUpperCase()===P.cv.APPLICATION?" | ".concat(e.audience.display," "):"")},title:v.createElement("div",{className:"pl-3"},u("roles:list.columns.audience"))},{allowToggleVisibility:!1,dataIndex:"action",id:"actions",key:"actions",textAlign:"right",title:null}],data:null==i?void 0:i.Resources,onRowClick:function(e,t){var n;!N&&null!=t&&null!==(n=t.meta)&&void 0!==n&&n.systemRole||z(null==t?void 0:t.id)},placeholders:a&&0===(null==i?void 0:i.totalResults)?v.createElement(p.$J,{"data-componentid":"".concat(c,"-search-empty-placeholder"),action:v.createElement(p.Qj,{"data-componentid":"".concat(c,"-search-empty-placeholder-clear-button"),onClick:o},u("roles:list.emptyPlaceholders.search.action")),image:(0,A.jF)().emptySearch,imageSize:"tiny",title:u("roles:list.emptyPlaceholders.search.title"),subtitle:[u("roles:list.emptyPlaceholders.search.subtitles.0",{searchQuery:a}),u("roles:list.emptyPlaceholders.search.subtitles.1")]}):0===(null==i?void 0:i.totalResults)?v.createElement(p.$J,{"data-componentid":"".concat(c,"-empty-list-empty-placeholder"),action:v.createElement(l.di,{when:w},v.createElement(p.KM,{"data-componentid":"".concat(c,"-empty-list-empty-placeholder-add-button"),onClick:n},v.createElement(h.Z,{name:"add"}),u("roles:list.emptyPlaceholders.emptyRoleList.action",{type:"Role"}))),image:(0,A.jF)().newList,imageSize:"tiny",title:u("roles:list.emptyPlaceholders.emptyRoleList.title",{type:"role"}),subtitle:[u("roles:list.emptyPlaceholders.emptyRoleList.subtitles.0",{type:"roles"}),u("roles:list.emptyPlaceholders.emptyRoleList.subtitles.1",{type:"role"}),u("roles:list.emptyPlaceholders.emptyRoleList.subtitles.2",{type:"role"})]}):null,"data-componentid":c}),M&&v.createElement(p.cV,{"data-componentid":"".concat(c,"-delete-item-confirmation-modal"),onClose:function(){return U(!1)},type:"negative",open:M,assertionHint:u("roles:list.confirmations.deleteItem.assertionHint"),assertionType:"checkbox",primaryAction:u("common:confirm"),secondaryAction:u("common:cancel"),onSecondaryActionClick:function(){return U(!1)},onPrimaryActionClick:function(){t(Z),U(!1)},closeOnDimmerClick:!1},v.createElement(p.cV.Header,null,u("roles:list.confirmations.deleteItem.header")),v.createElement(p.cV.Message,{attached:!0,negative:!0},u("roles:list.confirmations.deleteItem.message",{type:"role"})),v.createElement(p.cV.Content,null,u("roles:list.confirmations.deleteItem.content",{type:"role"}))),F&&v.createElement(S.u,{isOpen:F,onClose:function(){j(!1),x(void 0)},selectedRole:Z,"data-componentid":"".concat(c,"-role-delete-error-confirmation-modal")}))};function k(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var l,o,i,r,a=[],c=!0,s=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(l=i.call(n)).done)&&(a.push(l.value),a.length!==t);c=!0);}catch(e){s=!0,o=e}finally{try{if(!c&&null!=n.return&&(r=n.return(),Object(r)!==r))return}finally{if(s)throw o}}return a}}(e,t)||function(e,t){if(e){if("string"==typeof e)return w(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?w(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,l=Array(t);n<t;n++)l[n]=e[n];return l}N.defaultProps={"data-componentid":"role-mgt-roles-list"};var D=function(e){var t=e["data-componentid"],n=(0,y.I0)(),A=(0,f.$)().t,I=(0,p.fQ)().getLink,L=(0,u.z)().organizationType,b=(0,y.v9)((function(e){return e.config.ui.features})),C=(0,y.v9)((function(e){var t;return null==e||null===(t=e.config)||void 0===t||null===(t=t.ui)||void 0===t||null===(t=t.features)||void 0===t?void 0:t.userRolesV3})),O=(0,y.v9)((function(e){var t;return null==e||null===(t=e.config)||void 0===t||null===(t=t.ui)||void 0===t||null===(t=t.features)||void 0===t||null===(t=t.userRolesV3)||void 0===t?void 0:t.enabled})),S=k((0,v.useState)(c.r.DEFAULT_RESOURCE_LIST_ITEM_LIMIT),2),T=S[0],_=S[1],w=k((0,v.useState)(0),2),D=w[0],M=w[1],U=k((0,v.useState)(void 0),2),V=U[0],Z=U[1],x=k((0,v.useState)(!1),2),Q=x[0],F=x[1],j=L===a.$.SUBORGANIZATION,z=(0,o.Ok)(null,null,null,"name eq Console").data,$=(0,v.useMemo)((function(){var e,t;return O?null==C||null===(e=C.scopes)||void 0===e?void 0:e.create:null==b||null===(t=b.userRoles)||void 0===t||null===(t=t.scopes)||void 0===t?void 0:t.create}),[O,C,b]),H=(0,v.useMemo)((function(){var e;return null==z||null===(e=z.applications[0])||void 0===e?void 0:e.id}),[z]),G=(0,R.Z)(T,D,function(e){return"audience.value ne ".concat(H).concat(e?" and ".concat(e):"")}(V),"users,groups,permissions,associatedApplications"),X=G.data,B=G.isLoading,J=G.error,Y=G.mutate,q=[{key:void 0,text:A("roles:list.filterOptions.all"),value:void 0},{key:P.nL.ROLE_AUDIENCE_APPLICATION_FILTER,text:A("roles:list.filterOptions.applicationRoles"),value:P.nL.ROLE_AUDIENCE_APPLICATION_FILTER},{key:P.nL.ROLE_AUDIENCE_ORGANIZATION_FILTER,text:A("roles:list.filterOptions.organizationRoles"),value:P.nL.ROLE_AUDIENCE_ORGANIZATION_FILTER}];(0,v.useEffect)((function(){J&&K({description:A("roles:notifications.fetchRoles.genericError.description"),level:d.QU.ERROR,message:A("roles:notifications.fetchRoles.genericError.message")})}),[J]);var K=function(e){n((0,m.V_)(e))},W=function(){s.m.push(r.$.getPaths().get("ROLE_CREATE"))};return v.createElement(p.Xg,{action:!B&&(null==X?void 0:X.totalResults)>0?v.createElement(l.di,{when:$},v.createElement(p.KM,{"data-componentid":"".concat(t,"-add-button"),onClick:function(){return W()}},v.createElement(h.Z,{"data-componentid":"".concat(t,"-add-button-icon"),name:"add"}),A("roles:list.buttons.addButton",{type:"Role"}))):null,title:A("pages:roles.title"),pageTitle:A("pages:roles.title"),description:v.createElement(v.Fragment,null,A("pages:roles.subTitle"),v.createElement(p.eb,{link:I("develop.applications.roles.learnMore")},A("common:learnMore")))},v.createElement(p.PS,{advancedSearch:v.createElement(i.n,{"data-componentid":"".concat(t,"-list-advanced-search"),onFilter:function(e){"displayName sw "!==e?Z(e):Y()},filterAttributeOptions:[{key:0,text:A("roles:list.filterAttirbutes.name"),value:"displayName"},{key:1,text:A("roles:list.filterAttirbutes.audience"),value:"audience.type"}],filterAttributePlaceholder:A("roles:advancedSearch.form.inputs.filterAttribute.placeholder"),filterConditionsPlaceholder:A("roles:advancedSearch.form.inputs.filterCondition.placeholder"),filterValuePlaceholder:A("roles:advancedSearch.form.inputs.filterValue.placeholder"),placeholder:A("roles:advancedSearch.placeholder"),defaultSearchAttribute:"displayName",defaultSearchOperator:"co",triggerClearQuery:Q}),currentListSize:null==X?void 0:X.itemsPerPage,listItemLimit:T,onItemsPerPageDropdownChange:function(e,t){_(t.value)},onPageChange:function(e,t){var n=(t.activePage-1)*T+1;M(n)},showTopActionPanel:(null==X?void 0:X.totalResults)>0||0!==(null==V?void 0:V.length),rightActionPanel:v.createElement(E.Z,{"data-componentid":"".concat(t,"-list-filters-dropdown"),selection:!0,options:q,placeholder:A("roles:list.buttons.filterDropdown"),onChange:function(e,t){Z(t.value)}}),showPagination:!0,totalPages:Math.ceil((null==X?void 0:X.totalResults)/T),totalListSize:null==X?void 0:X.totalResults,isLoading:B},v.createElement(N,{handleRoleDelete:function(e){(0,g.iy)(e.id).then((function(){K({description:A("roles:notifications.deleteRole.success.description"),level:d.QU.SUCCESS,message:A("roles:notifications.deleteRole.success.message")}),Y()})).catch((function(e){e.response&&e.response.data&&e.response.data.detail?K({description:e.response.data.detail,level:d.QU.ERROR,message:A("roles:notifications.deleteRole.error.message")}):K({description:A("roles:notifications.deleteRole.genericError.description"),level:d.QU.ERROR,message:A("roles:notifications.deleteRole.genericError.message")})}))},onEmptyListPlaceholderActionClick:function(){return W()},onSearchQueryClear:function(){F(!Q),Z(null)},roleList:X,searchQuery:V,isSubOrg:j})))};D.defaultProps={"data-componentid":"roles-mgt"};const M=D}}]);