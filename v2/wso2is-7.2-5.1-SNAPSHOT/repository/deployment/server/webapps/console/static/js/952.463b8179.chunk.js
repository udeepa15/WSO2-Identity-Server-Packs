"use strict";(self.webpackChunk_wso2is_console=self.webpackChunk_wso2is_console||[]).push([[952],{50281:(e,t,n)=>{n.d(t,{Z:()=>l});var r=n(96124),o=n(76271),i=n(6833);const l=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n={headers:{Accept:"application/json","Content-Type":"application/json"},method:i.f2.GET,url:o.h.getState().config.endpoints.rulesMetaData+"?flow=".concat(e)},l=(0,r.Z)(t?n:null);return{data:l.data,error:l.error,isLoading:l.isLoading,isValidating:l.isValidating,mutate:l.mutate}}},39715:(e,t,n)=>{n.d(t,{Z:()=>re});var r=n(86989),o=n(82160),i=n(18365),l=n(46435),u=n(62782),a=n(65612),c=n(22939),s=n(70988),d=n(50342),f=n(17901),p=n(44194),m=n(10479),v=n(91970),b=n(99925),y=n(74822),h=n(97434),g=n(21073),E=n(68509),x=n(7603),O=n(20494),S=n(55495),A=n(59673),I=n(96124),j=n(76271),Z=n(6833);const w=function(e,t){var n={headers:{Accept:"application/json","Content-Type":"application/json"},method:Z.f2.GET,url:j.h.getState().config.endpoints.apiRoot+e},r=(0,I.Z)(t?n:null);return{data:r.data,error:r.error,isLoading:r.isLoading,isValidating:r.isValidating,mutate:r.mutate}};var R=n(44597),k=n(40656),P=n(51835),C=n.n(P),M=n(27975),T=n.n(M),N=n(55900),V=n.n(N),D=n(21555),L=n.n(D),F=n(3621),z=n.n(F),U=n(5062),W=n.n(U),$=n(63206),B={};B.styleTagTransform=W(),B.setAttributes=L(),B.insert=V().bind(null,"head"),B.domAPI=T(),B.insertStyleElement=z();C()($.Z,B);$.Z&&$.Z.locals&&$.Z.locals;function _(e){return _="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_(e)}function K(){return K=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)({}).hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},K.apply(null,arguments)}function q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function G(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?q(Object(n),!0).forEach((function(t){H(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):q(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function H(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=_(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=_(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==_(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function X(e){return function(e){if(Array.isArray(e))return Y(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Q(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function J(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,l,u=[],a=!0,c=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;a=!1}else for(;!(a=(r=i.call(n)).done)&&(u.push(r.value),u.length!==t);a=!0);}catch(e){c=!0,o=e}finally{try{if(!a&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(c)throw o}}return u}}(e,t)||Q(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Q(e,t){if(e){if("string"==typeof e)return Y(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Y(e,t):void 0}}function Y(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}const ee=function(e){var t=e["data-componentid"],n=void 0===t?"rules-component-condition":t,i=e.readonly,a=e.rule,d=a.rules,I=(0,R.o)(),j=I.addNewRuleConditionExpression,Z=I.conditionExpressionsMeta,P=I.updateConditionExpression,C=I.removeRuleConditionExpression,M=I.hidden,T=(0,m.$)().t,N=(0,S.Z)((function(e,t,n,r,o,i){P(e,t,n,r,o,i)}),300),V=function(e){var t=e["data-componentid"],n=void 0===t?"rules-condition-expression-input-value":t,r=e.valueReferenceAttribute,o=e.valueDisplayAttribute,l=e.resourceDetails,u=e.resourceType,a=e.initialResourcesLoadUrl,c=e.filterBaseResourcesUrl,s=e.ruleId,d=e.conditionId,m=e.expressionId,v=e.shouldFetch,b=e.hiddenResources,g=void 0===b?[]:b,O=J((0,p.useState)(null),2),S=O[0],A=O[1],I=J((0,p.useState)(null),2),j=I[0],Z=I[1],R=J((0,p.useState)([]),2),P=R[0],C=R[1],M=J((0,p.useState)(!1),2),V=M[0],D=M[1],L="more-items",F="clear-option",z=j?null==c?void 0:c.replace("filter=","filter=name+sw+".concat(j)):a,U=w(a,v),W=U.data,$=void 0===W?[]:W,B=U.isLoading,_=w(z,v),q=_.data,H=void 0===q?[]:q,Q=_.isLoading;(0,p.useEffect)((function(){l&&(A(l[r]||null),Z(l[o]||null))}),[l]),(0,p.useEffect)((function(){if(j&&z){if(H&&Array.isArray(H[u])){var e=H[u].filter((function(e){return!g.includes(e[r])})).map((function(e){return{id:e[r],label:e[o]}}));C(e)}}else if($&&Array.isArray($[u])){var t=$[u].filter((function(e){return!g.includes(e[r])})).map((function(e){return{id:e[r],label:e[o]}}));C(t)}}),[j,$,H,z]);var Y=(null==H?void 0:H.totalResults)>(null==H?void 0:H.count);return p.createElement(y.Z,{className:"autocomplete",disabled:i,"data-componentid":n,open:V,onOpen:function(){return D(!0)},onClose:function(){return D(!1)},options:[].concat(X(P),X(Y?[{id:L,isDisabled:!0,label:T("rules:fields.autocomplete.moreItemsMessage")}]:[]),X(j?[{id:F,isDisabled:!1,label:T("rules:fields.autocomplete.clearFilterActionText")}]:[])),filterOptions:function(e){return e},getOptionLabel:function(e){return e.label||""},value:l?{id:S,label:j}:null,isOptionEqualToValue:function(e,t){return(null==t?void 0:t.id)&&e.id===t.id},loading:Q,onChange:function(e,t){if(null==t||!t.isDisabled)return(null==t?void 0:t.id)===F?(Z(""),void setTimeout((function(){return D(!0)}),0)):void(t&&N(t.id,s,d,m,k.O.Value,!0))},inputValue:j,onInputChange:function(e,t){Z(t)},renderInput:function(e){return p.createElement(x.Z,K({},e,{variant:"outlined",placeholder:T("rules:fields.autocomplete.placeholderText"),value:j,InputProps:G(G({},e.InputProps),{},{endAdornment:p.createElement(p.Fragment,null,B||Q?p.createElement(h.Z,{color:"inherit",size:20}):null,e.InputProps.endAdornment)})}))},renderOption:function(e,t){return t.id===L?p.createElement("li",K({},e,{className:"MuiAutocomplete-moreItemsAvailableMessage",key:t.id}),t.label):t.id===F?p.createElement("li",K({},e,{key:t.id}),p.createElement(E.Z,{className:"MuiAutocomplete-clearFilterLink"},p.createElement(f.XH,{className:"icon"})," ",p.createElement("span",{className:"text"},t.label))):p.createElement("li",e,t.label)}})},D=function(e){var t,n,r,o=e["data-componentid"],l=void 0===o?"rules-condition-expression-input-value":o,u=e.ruleId,a=e.conditionId,d=e.setIsResourceMissing,f=e.expressionValue,m=e.expressionId,v=e.expressionField,b=e.findMetaValuesAgainst,h=e.initialResourcesLoadUrl,g=e.filterBaseResourcesUrl,E=e.hiddenResources,S=void 0===E?[]:E,A=J((0,p.useState)(null),2),I=A[0],j=A[1],Z=J((0,p.useState)(""),2),R=Z[0],C=Z[1],M=J((0,p.useState)([]),2),D=M[0],L=M[1],F=J((0,p.useState)(null),2),z=F[0],U=F[1],W=(null==b||null===(t=b.value)||void 0===t?void 0:t.valueReferenceAttribute)||"id",$=(null==b||null===(n=b.value)||void 0===n?void 0:n.valueDisplayAttribute)||"name",B=!1;"application"===v?(r="applications",B=!0):"claim"===v&&(B=!1);var _=w(h,!0),q=_.data,H=_.isLoading,X=w("/".concat(r,"/").concat(f),B),Q=X.data,Y=X.isLoading,ee=X.error;if((0,p.useEffect)((function(){Y||(ee?(d(!0),j(null)):j(Q))}),[Y,ee]),(0,p.useEffect)((function(){if("claim"===v&&q){var e=null==q?void 0:q.filter((function(e){return!S.includes(e[W])})).map((function(e){return{id:e[W],label:e[$]}})),t=null==e?void 0:e.sort((function(e,t){return e.label>t.label?1:-1})),n=(o=t,i=new Set(["http://wso2.org/claims/roles","http://wso2.org/claims/applicationRoles"]),null==o?void 0:o.filter((function(e){return!i.has(null==e?void 0:e.id)}))),r=n.find((function(e){return e.id===f}));L(n),C(r?r.label:""),U(r?r.id:null)}var o,i}),[q]),!H&&q){if("claim"==v)return p.createElement(y.Z,{loading:H,fullWidth:!0,"aria-label":"Attribute selection",className:"pt-2",componentsProps:{paper:{elevation:2},popper:{modifiers:[{enabled:!1,name:"flip"},{enabled:!1,name:"preventOverflow"}]}},inputValue:R,value:z?{id:z,label:R}:null,onInputChange:function(e,t,n){C("reset"!==n?t:"")},onChange:function(e,t){t&&(U(null==t?void 0:t.id),C(null==t?void 0:t.label),N(t.id,u,a,m,k.O.Value,!0))},options:D,getOptionLabel:function(e){return null==e?void 0:e.label},isOptionEqualToValue:function(e,t){return(null==t?void 0:t.id)&&e.id===t.id},renderOption:function(e,t){return p.createElement("li",K({},e,{key:t.id}),p.createElement("div",{className:"multiline"},p.createElement("div",null,null==t?void 0:t.label),p.createElement("div",null,p.createElement(O.EK,{className:"description",compact:!0,withBackground:!1},null==t?void 0:t.id))))},renderInput:function(e){return p.createElement(x.Z,K({},e,{variant:"outlined",placeholder:T("rules:fields.autocomplete.placeholderText"),value:R,InputProps:G({},e.InputProps)}))},key:"autocompleteSearchWithList","data-componentid":"".concat(l,"-select-attributes")});if("applications"==r){var te,ne;if(""===f)N(null===(ne=q[r][0])||void 0===ne?void 0:ne.id,u,a,m,k.O.Value,!1);return q.totalResults>q.count?p.createElement(V,{conditionId:a,ruleId:u,expressionId:m,expressionValue:f,resourceDetails:I,resourceType:r,valueReferenceAttribute:W,valueDisplayAttribute:$,initialResourcesLoadUrl:h,filterBaseResourcesUrl:g,shouldFetch:B,hiddenResources:S}):p.createElement(s.Z,{disabled:i,value:f,"data-componentid":l,onChange:function(e){P(e.target.value,u,a,m,k.O.Value,!0)}},null===(te=q[r])||void 0===te?void 0:te.filter((function(e){return!S.includes(e[W])})).map((function(e,t){return p.createElement(c.Z,{value:e[W],key:"".concat(m,"-").concat(t)},e[$])})))}}},L=function(e){var t=e["data-componentid"],n=void 0===t?"rules-condition-expression-input-value":t,r=e.findMetaValuesAgainst,o=e.ruleId,l=e.conditionId,u=e.expressionField,a=e.expressionId,d=e.expressionValue,f=e.metaValue,m=e.setIsResourceMissing,v=e.hiddenResources,b=void 0===v?[]:v,y=e.hiddenValues,h=void 0===y?[]:y;if("input"===(null==f?void 0:f.inputType))return p.createElement(x.Z,{disabled:i,value:d,"data-componentid":n,onChange:function(e){N(e.target.value,o,l,a,k.O.Value,!0)}});if("options"===(null==f?void 0:f.inputType)){var g,E,O;if((null==f||null===(g=f.values)||void 0===g?void 0:g.length)>1)return""===d&&N(null==f?void 0:f.values[0].name,o,l,a,k.O.Value,!1),p.createElement(s.Z,{disabled:i,value:d,"data-componentid":n,onChange:function(e){P(e.target.value,o,l,a,k.O.Value,!0)}},null===(O=f.values)||void 0===O?void 0:O.filter((function(e){return!h.includes(e.name)})).map((function(e,t){return p.createElement(c.Z,{value:e.name,key:"".concat(a,"-").concat(t)},e.displayName)})));if((null==f||null===(E=f.links)||void 0===E?void 0:E.length)>=1){var S,A,I=null==f||null===(S=f.links.find((function(e){return"values"===e.rel})))||void 0===S?void 0:S.href,j=null==f||null===(A=f.links.find((function(e){return"filter"===e.rel})))||void 0===A?void 0:A.href;return"application"===u&&I&&j||"claim"===u&&I?p.createElement(D,{ruleId:o,conditionId:l,setIsResourceMissing:m,expressionField:u,expressionId:a,expressionValue:d,findMetaValuesAgainst:r,initialResourcesLoadUrl:I,filterBaseResourcesUrl:j,hiddenResources:b}):null}return null}return null},F=function(e){var t,n=e["data-componentid"],a=void 0===n?"rules-condition-expression":n,d=e.expression,m=e.ruleId,y=e.conditionId,h=e.index,g=e.isConditionLast,E=e.isConditionExpressionRemovable,x=e.hiddenConditions,O=void 0===x?[]:x,S=e.hiddenResources,I=void 0===S?[]:S,w=e.hiddenValues,R=void 0===w?[]:w,M=J((0,p.useState)(!1),2),N=M[0],V=M[1],D=Z.find((function(e){var t;return(null==e||null===(t=e.field)||void 0===t?void 0:t.name)===d.field}));return p.createElement(r.Z,{sx:{position:"relative"},key:h,className:"box-container","data-componentid":a},N&&p.createElement(v.Z,{severity:"warning",className:"alert-warning",sx:{mb:2},"data-componentid":"rules-condition-expression-alert"},p.createElement(b.Z,{className:"alert-title"},p.createElement(A.c,{i18nKey:T("actions:fields.rules.alerts.resourceNotFound.title")},"The resource linked to this rule is no longer available.")),p.createElement(A.c,{i18nKey:T("actions:fields.rules.alerts.resourceNotFound.description")},"Please update to a valid resource.")),p.createElement(u.Z,{fullWidth:!0,size:"small"},p.createElement(s.Z,{disabled:i,value:d.field,"data-componentid":"rules-condition-expression-input-field-select",onChange:function(e){P(e.target.value,m,y,d.id,k.O.Field,!0),P("",m,y,d.id,k.O.Value,!0)}},null==Z?void 0:Z.filter((function(e){var t;return!O.includes(null===(t=e.field)||void 0===t?void 0:t.name)})).map((function(e,t){var n,r;return p.createElement(c.Z,{value:null===(n=e.field)||void 0===n?void 0:n.name,key:"".concat(d.id,"-").concat(t)},null===(r=e.field)||void 0===r?void 0:r.displayName)})))),p.createElement(u.Z,{sx:{mb:1,minWidth:120,mt:1},size:"small"},p.createElement(s.Z,{disabled:i,value:d.operator,"data-componentid":"rules-condition-expression-input-operator-select",onChange:function(e){P(e.target.value,m,y,d.id,k.O.Operator,!0)}},null==D||null===(t=D.operators)||void 0===t?void 0:t.map((function(e,t){return p.createElement(c.Z,{value:e.name,key:"".concat(d.id,"-").concat(t)},e.displayName)})))),p.createElement(u.Z,{fullWidth:!0,size:"small"},p.createElement(L,{conditionId:y,expressionField:d.field,expressionId:d.id,expressionValue:d.value,findMetaValuesAgainst:D,metaValue:null==D?void 0:D.value,ruleId:m,setIsResourceMissing:V,hiddenResources:I,hiddenValues:R})),(!i||i&&!g)&&p.createElement(u.Z,{sx:{mt:1},size:"small"},p.createElement(o.Z,{disabled:i,size:"small",variant:"contained",color:"secondary",onClick:function(){j(m,y,k.E.And,d.id)},className:"add-button",startIcon:i?null:p.createElement(f.pO,null)},T("rules:buttons.and"))),E&&!i&&p.createElement(l.Z,{"aria-label":"delete",size:"small",sx:{position:"absolute"},className:"remove-button",onClick:function(){return C(m,d.id)}},p.createElement(f.V_,{className:"remove-button-icon"})))};return p.createElement("div",{"data-componentid":n},null==d?void 0:d.map((function(e,t){var n,l,u;return(null==a?void 0:a.condition)===k.E.Or&&p.createElement(p.Fragment,{key:t},e.condition===k.E.And&&p.createElement(p.Fragment,null,null===(n=e.expressions)||void 0===n?void 0:n.map((function(t,n){return p.createElement(r.Z,{sx:{mt:2},key:n},e.expressions.length===n+1,p.createElement(F,{expression:t,ruleId:a.id,conditionId:e.id,index:n,isConditionLast:e.expressions.length===n+1,isConditionExpressionRemovable:e.expressions.length>1||a.rules.length>1,hiddenConditions:M.conditions,hiddenResources:M.resources,hiddenValues:M.values}))}))),(!i&&(null===(l=e.expressions)||void 0===l?void 0:l.length)>0||i&&(null===(u=e.expressions)||void 0===u?void 0:u.length)!==t)&&p.createElement(g.Z,{sx:{mb:1,mt:2}},p.createElement(o.Z,{disabled:i,size:"small",variant:"contained",color:"secondary",onClick:function(){return j(a.id,e.id,k.E.Or)},startIcon:i?null:p.createElement(f.pO,null)},T("rules:buttons.or"))))})))};var te=n(65058),ne={};ne.styleTagTransform=W(),ne.setAttributes=L(),ne.insert=V().bind(null,"head"),ne.domAPI=T(),ne.insertStyleElement=z();C()(te.Z,ne);te.Z&&te.Z.locals&&te.Z.locals;const re=function(e){var t,n,v=e["data-componentid"],b=void 0===v?"rules-render-component":v,y=e.disableLastRuleDelete,h=void 0===y||y,g=e.disableClearRule,E=void 0!==g&&g,x=e.readonly,O=void 0!==x&&x,S=(0,R.o)(),A=S.isMultipleRules,I=S.ruleExecuteCollection,j=S.ruleExecutionsMeta,Z=S.addNewRule,w=S.clearRule,k=S.removeRule,P=S.updateRulesFallbackExecution,C=S.updateRuleExecution,M=(0,m.$)().t;return p.createElement("div",{className:"rules-component","data-componentid":b},A&&!O&&p.createElement(r.Z,{sx:{mb:2}},p.createElement(o.Z,{size:"small",variant:"contained",color:"secondary",onClick:Z,startIcon:p.createElement(f.pO,null)},M("rules:buttons.newRule"))),null==I||null===(t=I.rules)||void 0===t?void 0:t.map((function(e,t){var n,r,m;return p.createElement(i.Z,{sx:{mb:2,position:"relative"},key:t},p.createElement(a.Z,{container:!0,alignItems:"center",sx:{mb:2}},p.createElement(a.Z,null,p.createElement(d.Z,{variant:"body2"},M("rules:texts.execute"))),null!=j&&j.executions?p.createElement(a.Z,null,p.createElement(u.Z,{sx:{m:1,minWidth:120},size:"small"},p.createElement(s.Z,{disabled:O,value:e.execution,onChange:function(t){return C(t,e.id)}},null==j||null===(n=j.executions)||void 0===n?void 0:n.map((function(t,n){return p.createElement(c.Z,{value:t.name,key:"".concat(e.id,"-").concat(n)},t.displayName)}))))):p.createElement(a.Z,null,p.createElement(u.Z,{sx:{mb:1,minWidth:0,mt:1},size:"small"},"\xa0")),p.createElement(a.Z,null,p.createElement(d.Z,{variant:"body2"},M("rules:texts.if")))),p.createElement(ee,{rule:e,readonly:O}),(null==I||null===(r=I.rules)||void 0===r?void 0:r.length)>1||!h&&!O&&p.createElement(l.Z,{color:"error","aria-label":"delete",size:"small",className:"delete-button",sx:{position:"absolute",right:14,top:14},onClick:function(){return k(e.id)},"data-componentid":"".concat(b,"-delete-rule-button")},p.createElement(f.XH,{className:"delete-button-icon"})),!A&&!E&&!O&&p.createElement(o.Z,{"aria-label":"Clear rule",disabled:O,variant:"outlined",size:"small",className:"clear-button ".concat((null==I||null===(m=I.rules)||void 0===m?void 0:m.length)>1||!h?"has-delete-button":""),sx:{position:"absolute",right:14,top:14},onClick:function(){return w(e.id)},"data-componentid":"".concat(b,"-clear-rule-button")},M("rules:buttons.clearRule")))})),A&&p.createElement(i.Z,{sx:{mb:2,position:"relative"}},p.createElement(a.Z,{container:!0,alignItems:"center"},p.createElement(a.Z,null,p.createElement(d.Z,{variant:"body2"},"Else Execute")),p.createElement(a.Z,null,p.createElement(u.Z,{sx:{m:1,minWidth:120},size:"small"},p.createElement(s.Z,{value:null==I?void 0:I.fallbackExecution,onChange:function(e){return P(e)},disabled:O},null==j||null===(n=j.fallbackExecutions)||void 0===n?void 0:n.map((function(e,t){return p.createElement(c.Z,{value:e.name,key:"".concat(t)},e.displayName)}))))))))}},67518:(e,t,n)=>{n.d(t,{Z:()=>o});var r=(0,n(44194).createContext)(void 0);r.displayName="RulesContext";const o=r},44597:(e,t,n)=>{n.d(t,{Z:()=>l,o:()=>i});var r=n(44194),o=n(67518),i=function(){var e=(0,r.useContext)(o.Z);if(!e)throw new Error("useRulesContext must be used within a RulesProvider");return e};const l=i},40656:(e,t,n)=>{n.d(t,{E:()=>r,O:()=>o});var r=function(e){return e.And="AND",e.Or="OR",e}({}),o=function(e){return e.Field="field",e.Operator="operator",e.Value="value",e}({})},921:(e,t,n)=>{n.d(t,{h:()=>N,u:()=>T});var r=n(44194),o=n(78768),i=n(67518),l=n(40656);function u(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,l,u=[],a=!0,c=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;a=!1}else for(;!(a=(r=i.call(n)).done)&&(u.push(r.value),u.length!==t);a=!0);}catch(e){c=!0,o=e}finally{try{if(!a&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(c)throw o}}return u}}(e,t)||function(e,t){if(e){if("string"==typeof e)return a(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}var s=function(e){if(Array.isArray(e))return e.map(s);if("object"===c(e)&&null!==e){var t=Object.fromEntries(Object.entries(e).map((function(e){var t=u(e,2),n=t[0],r=t[1];return[n,s(r)]})));return"id"in t||(t.id=(0,o.Z)()),t}return e};const d=s;function f(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,l,u=[],a=!0,c=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;a=!1}else for(;!(a=(r=i.call(n)).done)&&(u.push(r.value),u.length!==t);a=!0);}catch(e){c=!0,o=e}finally{try{if(!a&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(c)throw o}}return u}}(e,t)||function(e,t){if(e){if("string"==typeof e)return p(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function m(e){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m(e)}var v=function(e){return Array.isArray(e)?e.map(v):"object"===m(e)&&null!==e?Object.fromEntries(Object.entries(e).filter((function(e){return"id"!==f(e,1)[0]})).map((function(e){var t=f(e,2),n=t[0],r=t[1];return[n,v(r)]}))):e};const b=v;var y=["isRuleInstanceTouched"],h=["isRuleInstanceTouched"];function g(e){return g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},g(e)}function E(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}function x(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?x(Object(n),!0).forEach((function(t){S(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function S(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=g(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=g(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==g(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const A=function(e){var t;if(arguments.length>1&&void 0!==arguments[1]&&arguments[1])t=O(O({},e),{},{rules:null==e?void 0:e.rules.map((function(e){e.isRuleInstanceTouched;return E(e,y)}))});else{var n=e;n.isRuleInstanceTouched;t=E(n,h)}return b(t)};function I(e){return I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},I(e)}function j(e){return function(e){if(Array.isArray(e))return R(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||w(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Z(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,l,u=[],a=!0,c=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;a=!1}else for(;!(a=(r=i.call(n)).done)&&(u.push(r.value),u.length!==t);a=!0);}catch(e){c=!0,o=e}finally{try{if(!a&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(c)throw o}}return u}}(e,t)||w(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function w(e,t){if(e){if("string"==typeof e)return R(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?R(e,t):void 0}}function R(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function k(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function P(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?k(Object(n),!0).forEach((function(t){C(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function C(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=I(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=I(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==I(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var M={ruleInstance:void 0},T=function(){var e,t;return M.ruleInstance?M.ruleInstance.isMultipleRules?A(Object.freeze(M.ruleInstance),!0):(null===(e=M.ruleInstance)||void 0===e||null===(e=e.rules)||void 0===e?void 0:e.length)>0?A(null===(t=Object.freeze(M.ruleInstance))||void 0===t?void 0:t.rules[0]):null:null},N=function(e){var t,n=e.children,u=e.initialData,a=e.isMultipleRules,c=void 0!==a&&a,s=e.conditionExpressionsMetaData,f=e.ruleExecutionMetaData,p=e.hidden,m=void 0===p?{conditions:[],resources:[],values:[]}:p,v=d(u);!v||null!==(t=v)&&void 0!==t&&t.fallbackExecution||(v=P(P({},c&&{fallbackExecution:""}),{},{rules:[v]}));var b=Z((0,r.useState)(null!=v?v:void 0),2),y=b[0],h=b[1],g=null!=s?s:void 0,E=null!=f?f:void 0;M.ruleInstance=P(P({},y),{},{isMultipleRules:c}),(0,r.useEffect)((function(){!u&&g&&h((function(e){var t;return P(P(P({},e),c&&{fallbackExecution:null==f||null===(t=f.fallbackExecutions)||void 0===t||null===(t=t[0])||void 0===t?void 0:t.name}),{},{rules:[S()]})}))}),[g]);var x=function(){var e,t;return{field:null==s||null===(e=s[0])||void 0===e||null===(e=e.field)||void 0===e?void 0:e.name,id:(0,o.Z)(),operator:null==s||null===(t=s[0])||void 0===t||null===(t=t.operators)||void 0===t||null===(t=t[0])||void 0===t?void 0:t.name,value:""}},O=function(e){return{condition:e,expressions:[x()],id:(0,o.Z)()}},S=function(){return{condition:l.E.Or,id:(0,o.Z)(),isRuleInstanceTouched:!1,rules:[O(l.E.And)]}};return r.createElement(i.Z.Provider,{value:{addNewRule:function(){h((function(e){return P(P({},e),{},{rules:[].concat(j(null==e?void 0:e.rules),[S()])})}))},addNewRuleConditionExpression:function(e,t,n,r){h((function(o){var i;return P(P({},o),{},{rules:null==o||null===(i=o.rules)||void 0===i?void 0:i.map((function(o){var i;return o.id===e?P(P({},o),{},{isRuleInstanceTouched:!0,rules:null===(i=o.rules)||void 0===i?void 0:i.flatMap((function(e){return n===l.E.Or?e.id===t?[e,O(l.E.And)]:[e]:P(P({},e),{},{expressions:e.expressions.flatMap((function(e){return e.id===r?[e,x()]:[e]}))})}))}):o}))})}))},clearRule:function(e){h((function(t){var n;return P(P({},t),{},{rules:null==t||null===(n=t.rules)||void 0===n?void 0:n.map((function(t){return t.id===e?S():t}))})}))},conditionExpressionsMeta:g,hidden:m,isMultipleRules:c,removeRule:function(e){h((function(t){var n;return P(P({},t),{},{rules:null==t||null===(n=t.rules)||void 0===n?void 0:n.filter((function(t){return(null==t?void 0:t.id)!==e}))})}))},removeRuleConditionExpression:function(e,t){h((function(n){var r;return P(P({},n),{},{rules:null==n||null===(r=n.rules)||void 0===r?void 0:r.map((function(n){var r;return n.id===e?P(P({},n),{},{isRuleInstanceTouched:!0,rules:null===(r=n.rules)||void 0===r?void 0:r.flatMap((function(e){var n=e.expressions.filter((function(e){return e.id!==t}));return 0===n.length?[]:[P(P({},e),{},{expressions:n})]}))}):n}))})}))},ruleExecuteCollection:y,ruleExecutionsMeta:E,ruleInstance:function(){if(y){var e;if(c)return A(y,!0);if((null===(e=y.rules)||void 0===e?void 0:e.length)>0)return A(y.rules[0],c)}return null}(),updateConditionExpression:function(e,t,n,r,o,i){h((function(l){var u;return P(P({},l),{},{rules:null==l||null===(u=l.rules)||void 0===u?void 0:u.map((function(l){var u;return l.id===t?P(P({},l),{},{rules:null===(u=l.rules)||void 0===u?void 0:u.map((function(t){return t&&t.id===n?P(P({},t),{},{expressions:t.expressions.map((function(t){return t.id===r?P(P({},t),{},C({},o,e)):t}))}):t}))},i&&{isRuleInstanceTouched:!0}):l}))})}))},updateRuleExecution:function(e,t){var n=e.target.value;h((function(e){var r;return P(P({},e),{},{rules:null==e||null===(r=e.rules)||void 0===r?void 0:r.map((function(e){return e.id===t?P(P({},e),{},{execution:n,isRuleInstanceTouched:!0}):e}))})}))},updateRulesFallbackExecution:function(e){var t=e.target.value;h((function(e){return P(P({},e),{},{fallbackExecution:t})}))}}},n)}},63206:(e,t,n)=>{n.d(t,{Z:()=>u});var r=n(81611),o=n.n(r),i=n(83948),l=n.n(i)()(o());l.push([e.id,".MuiAutocomplete-listbox .MuiAutocomplete-moreItemsAvailableMessage{color:#666;font-style:italic;padding:5px 15px 5px;pointer-events:none}.MuiAutocomplete-listbox .MuiAutocomplete-clearFilterLink{font-style:italic;padding:5px 0;cursor:pointer}.MuiAutocomplete-listbox .MuiAutocomplete-clearFilterLink>.icon{margin-right:3px}.MuiAutocomplete-listbox .MuiAutocomplete-clearFilterLink>span.text{text-decoration:underline}.MuiAutocomplete-listbox .MuiAutocomplete-clearFilterLink:hover>span.text,.MuiAutocomplete-listbox .MuiAutocomplete-clearFilterLink:hover{text-decoration:none}",""]);const u=l},65058:(e,t,n)=>{n.d(t,{Z:()=>u});var r=n(81611),o=n.n(r),i=n(83948),l=n.n(i)()(o());l.push([e.id,".rules-component .box-container{background-color:#f9fafb;border-radius:8px;padding:20px}.rules-component .remove-button{font-size:1rem;width:25px;height:25px;min-height:25px;right:-10px;top:-10px}.rules-component .remove-button .remove-button-icon{font-size:1rem}.rules-component .clear-button{margin-right:10px;margin-top:5px}.rules-component .clear-button.has-delete-button{margin-right:60px}.rules-component .delete-button{font-size:1rem;width:40px;height:40px;min-height:30px;right:25px;top:20px}.rules-component .delete-button .delete-button-icon{font-size:1.2rem}",""]);const u=l}}]);