"use strict";(self.webpackChunk_wso2is_console=self.webpackChunk_wso2is_console||[]).push([[1726,4755],{41726:(e,t,n)=>{n.r(t),n.d(t,{AttributeMappings:()=>D,default:()=>N});var i=n(6894),a=n(64961),r=n(60486),l=n(40838),c=n(51021),o=n(21257),u=n(10319),s=n(58613),d=n(6833),m=n(82406),f=n(20494),p=n(76004),E=n.n(p),g=n(44194),v=n(10479),h=n(47245),b=n(93682),A=n(14755),I=n(12252),y=n(99116);function S(e){return function(e){if(Array.isArray(e))return M(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||T(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function C(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,a,r,l,c=[],o=!0,u=!1;try{if(r=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;o=!1}else for(;!(o=(i=r.call(n)).done)&&(c.push(i.value),c.length!==t);o=!0);}catch(e){u=!0,a=e}finally{try{if(!o&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(u)throw a}}return c}}(e,t)||T(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function T(e,t){if(e){if("string"==typeof e)return M(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?M(e,t):void 0}}function M(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=Array(t);n<t;n++)i[n]=e[n];return i}var D=function(e){var t,n,p=e["data-testid"],M=e.match.params,D=M.type,N=M.customAttributeMappingID,R=(0,h.I0)(),Q=(0,h.v9)((function(e){return e.config.ui.listAllAttributeDialects})),_=(0,h.v9)((function(e){var t;return null==e||null===(t=e.config)||void 0===t||null===(t=t.ui)||void 0===t?void 0:t.userSchemaURI})),U=(0,v.$)().t,L=(0,f.fQ)().getLink,B=(0,o.z)().isSubOrganization,w=C((0,g.useState)(!0),2),O=w[0],x=w[1],Z=C((0,g.useState)(null),2),k=Z[0],P=Z[1],H=C((0,g.useState)([]),2),j=H[0],X=H[1],$=C((0,g.useState)(!0),2),z=$[0],V=$[1],G=C((0,g.useState)(!0),2),F=G[0],J=G[1],Y=(0,s.Z)().userStoresList,q=(0,h.v9)((function(e){var t;return null==e||null===(t=e.config)||void 0===t||null===(t=t.ui)||void 0===t||null===(t=t.features)||void 0===t?void 0:t.agents})),K=(0,g.useMemo)((function(){return null==Y?void 0:Y.some((function(e){return e.id===u.Rp}))}),[Y]);(0,g.useEffect)((function(){te(),J(!1)}),[F]),(0,g.useEffect)((function(){k&&k.length>0&&z&&(W(k.map((function(e){return e.id}))),V(!1))}),[k,z]);var W=function(e,t,n,a,r){var l=[];e.forEach((function(e){l.push((0,i.gR)(e,{filter:r,limit:t,offset:n,sort:a}))})),E().all(l).then((function(e){var t=[];e.forEach((function(e){t.push.apply(t,S(e.map((function(e){return e.mappedLocalClaimURI}))))})),X(t)})).catch((function(e){var t,n;R((0,m.V_)({description:(null===(t=e[0])||void 0===t||null===(t=t.response)||void 0===t||null===(t=t.data)||void 0===t?void 0:t.description)||U("claims:dialects.notifications.fetchExternalClaims.genericError.description",{type:(0,y.i)(D)}),level:d.QU.ERROR,message:(null===(n=e[0])||void 0===n||null===(n=n.response)||void 0===n||null===(n=n.data)||void 0===n?void 0:n.message)||U("claims:dialects.notifications.fetchExternalClaims.genericError.message")}))})).finally((function(){return x(!1)}))},ee=function(){var e;switch(D){case I.QN.AGENT:return U("claims:attributeMappings.agent.heading");case I.QN.OIDC:return U("claims:attributeMappings.oidc.heading");case I.QN.SCIM:return U("claims:attributeMappings.scim.heading");case I.QN.AXSCHEMA:return U("claims:attributeMappings.axschema.heading");case I.QN.EIDAS:return U("claims:attributeMappings.eidas.heading");case I.QN.OTHERS:return k&&(null===(e=k[0])||void 0===e?void 0:e.dialectURI);default:return U("claims:attributeMappings.custom.heading")}},te=function(e,t,n,a){x(!0),(0,i.jp)({filter:a,limit:e,offset:t,sort:n}).then((function(e){var t=e.filter((function(e){return Q?"local"!==e.id&&e.id!==I.QN.ATTRIBUTE_DIALECT_IDS.get("XML_SOAP")&&e.id!=I.QN.ATTRIBUTE_DIALECT_IDS.get("OPENID_NET"):e.id!=I.QN.ATTRIBUTE_DIALECT_IDS.get("LOCAL")&&e.id!=I.QN.ATTRIBUTE_DIALECT_IDS.get("AXSCHEMA")&&e.id!=I.QN.ATTRIBUTE_DIALECT_IDS.get("EIDAS_LEGAL")&&e.id!=I.QN.ATTRIBUTE_DIALECT_IDS.get("EIDAS_NATURAL")&&e.id!=I.QN.ATTRIBUTE_DIALECT_IDS.get("OPENID_NET")&&e.id!=I.QN.ATTRIBUTE_DIALECT_IDS.get("XML_SOAP")&&(c.rk.attributeMappings.showSCIMCore1||"urn:scim:schemas:core:1.0"!==e.dialectURI)}));null!=q&&q.enabled&&K||(t=t.filter((function(e){return e.id!=I.QN.ATTRIBUTE_DIALECT_IDS.get("SCIM2_FOR_AGENTS")})));var n=[];if(t.forEach((function(e){I.QN.OIDC_MAPPING.includes(e.dialectURI)?D===I.QN.OIDC&&n.push(e):Object.values(I.QN.SCIM_TABS).map((function(e){return e.uri})).includes(e.dialectURI)?D===I.QN.SCIM&&n.push(e):I.QN.AXSCHEMA_MAPPING===e.dialectURI?D===I.QN.AXSCHEMA&&n.push(e):Object.values(I.QN.EIDAS_TABS).map((function(e){return e.uri})).includes(e.dialectURI)?D===I.QN.EIDAS&&n.push(e):D===I.QN.OTHERS&&N===e.id&&n.push(e)})),D===I.QN.SCIM&&c.rk.showCustomDialectInSCIM){var i,a=null===(i=t)||void 0===i?void 0:i.find((function(e){return e.dialectURI===_}));a&&n.push(a)}P(n)})).catch((function(e){var t,n;R((0,m.V_)({description:(null==e||null===(t=e.response)||void 0===t||null===(t=t.data)||void 0===t?void 0:t.description)||U("claims:dialects.notifications.fetchDialects.genericError.description"),level:d.QU.ERROR,message:(null==e||null===(n=e.response)||void 0===n||null===(n=n.data)||void 0===n?void 0:n.message)||U("claims:dialects.notifications.fetchDialects.genericError.message")}))})).finally((function(){x(!1)}))};return g.createElement(f.Xg,{isLoading:O,title:ee(),pageTitle:ee(),description:function(){switch(D){case I.QN.AGENT:return g.createElement(g.Fragment,null,U("claims:attributeMappings.agent.description"),g.createElement(f.eb,{link:L("manage.attributes.oidcAttributes.learnMore")},U("common:learnMore")));case I.QN.OIDC:return g.createElement(g.Fragment,null,U("claims:attributeMappings.oidc.description"),g.createElement(f.eb,{link:L("manage.attributes.oidcAttributes.learnMore")},U("common:learnMore")));case I.QN.SCIM:return g.createElement(g.Fragment,null,U("claims:attributeMappings.scim.description"),g.createElement(f.eb,{link:L("manage.attributes.scimAttributes.learnMore")},U("common:learnMore")));case I.QN.AXSCHEMA:return U("claims:attributeMappings.axschema.description");case I.QN.EIDAS:return U("claims:attributeMappings.eidas.description");default:return U("claims:attributeMappings.custom.description")}}(),"data-testid":"".concat(p,"-page-layout"),image:function(){var e;switch(D){case I.QN.OIDC:return g.createElement(f.dn,{verticalAlign:"middle",rounded:!0,icon:(0,a.r2)().oidc,spaced:"right",size:"tiny",floated:"left",transparent:!0});case I.QN.SCIM:return g.createElement(f.dn,{verticalAlign:"middle",rounded:!0,icon:(0,a.r2)().scim,spaced:"right",size:"tiny",floated:"left"});case I.QN.AXSCHEMA:return g.createElement(f.dn,{verticalAlign:"middle",rounded:!0,icon:(0,a.r2)().axschema,spaced:"right",size:"tiny",floated:"left"});case I.QN.EIDAS:return g.createElement(f.dn,{verticalAlign:"middle",rounded:!0,icon:(0,a.r2)().eidas,spaced:"right",size:"tiny",floated:"left"});case I.QN.OTHERS:return g.createElement(b.Z,{floated:"left",verticalAlign:"middle",rounded:!0,centered:!0,size:"tiny"},g.createElement(f.Xo,null),g.createElement("span",{className:"claims-letter"},k&&(null===(e=k[0])||void 0===e?void 0:e.dialectURI.charAt(0).toUpperCase())));default:return g.createElement(b.Z,{floated:"left",verticalAlign:"middle",rounded:!0,centered:!0,size:"tiny"},g.createElement(f.Xo,null),g.createElement("span",{className:"claims-letter"},"C"))}}(),backButton:{onClick:function(){l.m.push(r.$.getPaths().get("CLAIM_DIALECTS"))},text:U("claims:local.pageLayout.local.back")}},(null==k?void 0:k.length)>1?g.createElement(f.M$,{panes:function(){if(D===I.QN.SCIM){var e,t=[],n=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=T(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,a=function(){};return{s:a,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,l=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return l=e.done,e},e:function(e){c=!0,r=e},f:function(){try{l||null==n.return||n.return()}finally{if(c)throw r}}}}(I.QN.SCIM_TABS);try{var i=function(){var n=e.value;if(c.k9.scim.core1Schema===n.uri&&c.k9.hideCore1Schema)return 0;if(B()&&I.QN.AGENT_SCIM_SCHEMA_MAPPING.includes(n.uri))return 0;var i=null==k?void 0:k.find((function(e){return e.dialectURI===n.uri}));i&&t.push({menuItem:n.name,render:function(){return g.createElement(f.M$.Pane,{controlledSegmentation:!0,attached:!1},g.createElement(A.default,{id:i.id,attributeUri:n.uri,attributeType:D,mappedLocalClaims:j,updateMappedClaims:V,updateDialects:J,isAttributeButtonEnabled:n.isAttributeButtonEnabled,attributeButtonText:U(n.attributeButtonText)}))}})};for(n.s();!(e=n.n()).done;)i()}catch(l){n.e(l)}finally{n.f()}if(c.rk.showCustomDialectInSCIM){var a=null==k?void 0:k.find((function(e){return e.dialectURI===_}));t.push({menuItem:"Custom Schema",render:function(){return g.createElement(f.M$.Pane,{controlledSegmentation:!0,attached:!1},g.createElement(A.default,{id:null==a?void 0:a.id,attributeType:D,attributeUri:_,mappedLocalClaims:j,updateMappedClaims:V,updateDialects:J,isAttributeButtonEnabled:!0,attributeButtonText:U("claims:external.pageLayout.edit.attributePrimaryAction")}))}})}return t}if(D===I.QN.EIDAS){var r=[];return I.QN.EIDAS_TABS.forEach((function(e){var t=null==k?void 0:k.find((function(t){return t.dialectURI===e.uri}));t&&r.push({menuItem:e.name,render:function(){return g.createElement(f.M$.Pane,{controlledSegmentation:!0,attached:!1},g.createElement(A.default,{id:t.id,attributeUri:e.uri,attributeType:D,mappedLocalClaims:j,updateMappedClaims:V,updateDialects:J,isAttributeButtonEnabled:e.isAttributeButtonEnabled,attributeButtonText:e.attributeButtonText}))}})})),r}return null==k?void 0:k.map((function(e){return{menuItem:e.dialectURI,render:function(){return g.createElement(f.M$.Pane,{controlledSegmentation:!0,attached:!1},g.createElement(A.default,{id:e.id,attributeType:D,attributeUri:e.dialectURI,mappedLocalClaims:j,updateMappedClaims:V,updateDialects:J,isAttributeButtonEnabled:!0,attributeButtonText:U("claims:external.pageLayout.edit.attributePrimaryAction")}))}}}))}(),"data-testid":"".concat(p,"-tabs")}):g.createElement(A.default,{id:k&&(null===(t=k[0])||void 0===t?void 0:t.id),attributeType:D,attributeUri:k&&(null===(n=k[0])||void 0===n?void 0:n.dialectURI),mappedLocalClaims:j,updateMappedClaims:V,updateDialects:J,isAttributeButtonEnabled:!0,attributeButtonText:U("claims:external.pageLayout.edit.attributePrimaryAction")}))};D.defaultProps={"data-testid":"edit-attribute-mappings"};const N=D},14755:(e,t,n)=>{n.r(t),n.d(t,{default:()=>T});var i=n(55007),a=n(6894),r=n(60486),l=n(40838),c=n(79408),o=n(51021),u=n(6833),s=n(82406),d=n(20494),m=n(44194),f=n(10479),p=n(47245),E=n(89141),g=n(12638),v=n(41193),h=n(62508),b=n(31302),A=n(12252),I=n(99116);function y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,a,r,l,c=[],o=!0,u=!1;try{if(r=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;o=!1}else for(;!(o=(i=r.call(n)).done)&&(c.push(i.value),c.length!==t);o=!0);}catch(e){u=!0,a=e}finally{try{if(!o&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(u)throw a}}return c}}(e,t)||function(e,t){if(e){if("string"==typeof e)return S(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?S(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function S(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=Array(t);n<t;n++)i[n]=e[n];return i}var C=function(e){var t,n=e.attributeType,S=e.attributeUri,C=e.mappedLocalClaims,T=e.isAttributeButtonEnabled,M=e.attributeButtonText,D=e.updateMappedClaims,N=e.updateDialects,R=e["data-testid"],Q=e.id,_=y((0,m.useState)(null),2),U=_[0],L=_[1],B=y((0,m.useState)(void 0),2),w=B[0],O=B[1],x=y((0,m.useState)(!0),2),Z=x[0],k=x[1],P=y((0,m.useState)(!1),2),H=P[0],j=P[1],X=(0,p.I0)(),$=(0,f.$)().t,z=(0,p.v9)((function(e){return e.config.ui.features})),V=function(e){(0,a.vR)(null!=e?e:Q).then((function(e){L(e)})).catch((function(e){X((0,s.V_)({description:(null==e?void 0:e.description)||$("claims:dialects.notifications.fetchADialect.genericError.description"),level:u.QU.ERROR,message:(null==e?void 0:e.message)||$("claims:dialects.notifications.fetchADialect.genericError.message")}))}))},G=function(e,t,i,r){Q&&k(!0),Q&&O(void 0),Q&&(0,a.gR)(Q,{filter:r,limit:e,offset:t,sort:i}).then((function(e){O((0,c.f)(e,"claimURI",!0))})).catch((function(e){var t,i;X((0,s.V_)({description:(null==e||null===(t=e.response)||void 0===t||null===(t=t.data)||void 0===t?void 0:t.description)||$("claims:dialects.notifications.fetchExternalClaims.genericError.description",{type:(0,I.i)(n)}),level:u.QU.ERROR,message:(null==e||null===(i=e.response)||void 0===i||null===(i=i.data)||void 0===i?void 0:i.message)||$("claims:dialects.notifications.fetchExternalClaims.genericError.message")}))})).finally((function(){k(!1)}))};(0,m.useEffect)((function(){if(!Q)return L(null),void O(void 0);V(),G()}),[Q]);var F=function(e){(0,a.Nx)(e).then((function(){l.m.push(r.$.getPaths().get("CLAIM_DIALECTS")),X((0,s.V_)({description:$("claims:dialects.notifications.deleteDialect.success.description",{type:(0,I.i)(n,!0)}),level:u.QU.SUCCESS,message:$("claims:dialects.notifications.deleteDialect.success.message")}))})).catch((function(e){X((0,s.V_)({description:(null==e?void 0:e.description)||$("claims:dialects.notifications.deleteDialect.genericError.description",{type:(0,I.i)(n,!0)}),level:u.QU.ERROR,message:(null==e?void 0:e.message)||$("claims:dialects.notifications.deleteDialect.genericError.message")}))}))};return m.createElement(m.Fragment,null,o.rk.attributeMappings.editAttributeMappingDetails&&m.createElement(m.Fragment,null,m.createElement(E.Z,null,m.createElement(E.Z.Row,{columns:1},m.createElement(E.Z.Column,{width:16},m.createElement(g.Z,{as:"h4"},$("claims:dialects.pageLayout.edit.updateDialectURI",{type:(0,I.i)(n,!0)})),m.createElement(d.pJ,null,Z?m.createElement(v.Z,null,m.createElement(v.Z.Line,{length:"short"}),m.createElement(v.Z.Line,{length:"medium"})):m.createElement(b.T8,{dialect:U,"data-testid":"".concat(R,"-edit-dialect-details"),attributeType:n,onUpdate:function(e){V(e)}}))))),m.createElement(h.Z,{hidden:!0}),m.createElement(E.Z,{columns:1},m.createElement(E.Z.Column,{width:16},m.createElement(g.Z,{as:"h4"},$("claims:dialects.pageLayout.edit.updateExternalAttributes",{type:(0,I.i)(n,!0)})))),m.createElement(h.Z,{hidden:!0}),m.createElement(h.Z,{hidden:!0})),m.createElement(b._v,{dialectID:Q,isLoading:Z,claims:w,update:G,"data-testid":"".concat(R,"-edit-external-claims"),attributeType:n,attributeUri:S,mappedLocalClaims:C,updateMappedClaims:D,updateDialects:N,isAttributeButtonEnabled:T,attributeButtonText:M}),m.createElement(h.Z,{hidden:!0}),o.rk.attributeMappings.showDangerZone&&(null==U?void 0:U.id)&&!A.QN.SYSTEM_DIALECTS.includes(null==U?void 0:U.id)&&m.createElement(E.Z,null,m.createElement(E.Z.Row,{columns:1},m.createElement(E.Z.Column,{width:16},m.createElement(i.di,{when:null==z||null===(t=z.oidcScopes)||void 0===t||null===(t=t.scopes)||void 0===t?void 0:t.delete},m.createElement(d.v9,{sectionHeader:$("common:dangerZone"),"data-testid":"".concat(R,"-danger-zone-group")},m.createElement(d.cN,{actionTitle:$("claims:dialects.dangerZone.actionTitle",{type:(0,I.i)(n,!0,!0)}),header:$("claims:dialects.dangerZone.header",{type:(0,I.i)(n,!0)}),subheader:$("claims:dialects.dangerZone.subheader",{type:(0,I.i)(n)}),onActionClick:function(){return j(!0)},"data-testid":"".concat(R,"-dialect-delete-danger-zone")})))))),o.rk.attributeMappings.showDangerZone&&H&&m.createElement(d.cV,{onClose:function(){return j(!1)},type:"negative",open:H,assertion:U.dialectURI,assertionHint:$("claims:dialects.confirmations.hint"),assertionType:"checkbox",primaryAction:$("claims:dialects.confirmations.action"),secondaryAction:$("common:cancel"),onSecondaryActionClick:function(){return j(!1)},onPrimaryActionClick:function(){return F(U.id)},"data-testid":"".concat(R,"-delete-confirmation-modal"),closeOnDimmerClick:!1},m.createElement(d.cV.Header,{"data-testid":"".concat(R,"-delete-confirmation-modal-header")},$("claims:dialects.confirmations.header")),m.createElement(d.cV.Message,{attached:!0,negative:!0,"data-testid":"".concat(R,"-delete-confirmation-modal-message")},$("claims:dialects.confirmations.message")),m.createElement(d.cV.Content,{"data-testid":"".concat(R,"-delete-confirmation-modal-content")},$("claims:dialects.confirmations.content",{type:(0,I.i)(n)}))))};C.defaultProps={attributeType:A.QN.OTHERS,"data-testid":"external-dialect-edit"};const T=C}}]);