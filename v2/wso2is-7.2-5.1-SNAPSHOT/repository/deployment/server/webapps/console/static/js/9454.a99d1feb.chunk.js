"use strict";(self.webpackChunk_wso2is_console=self.webpackChunk_wso2is_console||[]).push([[9454],{79454:(e,t,n)=>{n.r(t),n.d(t,{Saml2ConfigurationPage:()=>U,default:()=>V});var a,i=n(55007),o=n(60486),r=n(40838),l=n(43939),s=n(6833),c=n(82406),u=n(16590),d=n(79438),m=n(20494),f=n(34194),g=n(44194),E=n(10479),C=n(47245),_=n(89141),R=n(41193),p=n(62508),v=n(41206),h=n(2292),S=n(45532),O=n(96124),y=n(60507);function b(e){return b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},b(e)}function L(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,I(a.key),a)}}function A(e,t,n){return t&&L(e.prototype,t),n&&L(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function w(e,t,n){return(t=I(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function I(e){var t=function(e,t){if("object"!=b(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var a=n.call(e,t||"default");if("object"!=b(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==b(t)?t:t+""}var T=A((function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}));a=T,w(T,"SAML2_CONFIG_FETCH_ERROR_CODE","SMC-00001"),w(T,"SAML2_CONFIG_FETCH_INVALID_STATUS_CODE_ERROR_CODE","SMC-00002"),w(T,"SAML2_CONFIG_UPDATE_ERROR_CODE","SMC-00003"),w(T,"SAML2_CONFIG_REVERT_ERROR_CODE","SMC-00004"),w(T,"SAML2_CONFIG_REVERT_INVALID_STATUS_CODE_ERROR_CODE","SMC-00005"),w(T,"SAML2_CONFIG_FIELD_MIN_LENGTH",0),w(T,"ErrorMessages",{SAML2_CONFIG_FETCH_ERROR_CODE:new y.O(a.SAML2_CONFIG_FETCH_ERROR_CODE,"An error occurred while fetching the saml2 configurations.","Error while fetching the saml2 configurations",null),SAML2_CONFIG_FETCH_INVALID_STATUS_CODE_ERROR_CODE:new y.O(a.SAML2_CONFIG_FETCH_INVALID_STATUS_CODE_ERROR_CODE,"Received an invalid status code while fetching the saml2 configurations.","Invalid Status Code while fetching the saml2 configurations",null),SAML2_CONFIG_REVERT_ERROR_CODE:new y.O(a.SAML2_CONFIG_REVERT_ERROR_CODE,"An error occurred while reverting the saml2 configurations.","Error while reverting the saml2 configurations",null),SAML2_CONFIG_REVERT_INVALID_STATUS_CODE_ERROR_CODE:new y.O(a.SAML2_CONFIG_REVERT_INVALID_STATUS_CODE_ERROR_CODE,"Received an invalid status code while reverting the saml2 configurations.","Invalid Status Code while reverting the saml2 configurations",null),SAML2_CONFIG_UPDATE_ERROR_CODE:new y.O(a.SAML2_CONFIG_UPDATE_ERROR_CODE,"An error occurred while updating the saml2 configurations.","Error while updating the saml2 configurations",null)});var N=h.AsgardeoSPAClient.getInstance().httpRequest.bind(h.AsgardeoSPAClient.getInstance());function M(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,i,o,r,l=[],s=!0,c=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;s=!1}else for(;!(s=(a=o.call(n)).done)&&(l.push(a.value),l.length!==t);s=!0);}catch(e){c=!0,i=e}finally{try{if(!s&&null!=n.return&&(r=n.return(),Object(r)!==r))return}finally{if(c)throw i}}return l}}(e,t)||function(e,t){if(e){if("string"==typeof e)return D(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?D(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function D(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=Array(t);n<t;n++)a[n]=e[n];return a}var U=function(e){var t,n,a,h,y,b,L=e["data-componentid"],A=(0,g.useRef)(null),w=(0,g.useRef)(null),I=(0,g.useRef)(),D=null===(t=(0,C.v9)((function(e){var t;return null==e||null===(t=e.config)||void 0===t||null===(t=t.ui)||void 0===t||null===(t=t.features)||void 0===t?void 0:t.governanceConnectors})).deprecatedFeaturesToShow)||void 0===t?void 0:t.find((function(e){return"saml2"===(null==e?void 0:e.name)})),U=(0,C.v9)((function(e){return e.config.ui.features})),V=!(0,i.EV)(null==U||null===(n=U.governanceConnectors)||void 0===n||null===(n=n.scopes)||void 0===n?void 0:n.update),F=(0,C.I0)(),P=(0,E.$)().t,Z=M((0,g.useState)(!1),2),G=Z[0],k=Z[1],j=M((0,g.useState)(void 0),2),H=j[0],x=j[1],q=M((0,g.useState)(""),2),Q=q[0],z=q[1],$=M((0,g.useState)(!1),2),B=$[0],J=$[1],K=(a={headers:{Accept:"application/json","Content-Type":"application/json"},method:s.f2.GET,url:S.D.getServiceResourceEndpoints().saml2Configurations},h=(0,O.Z)(a),y=h.data,b=h.error,{data:y,error:b,isLoading:!b&&!y,isValidating:h.isValidating,mutate:h.mutate}),W=K.data,X=K.isLoading,Y=K.mutate,ee=K.error;(0,g.useEffect)((function(){var e,t;W instanceof l.u||ee?te():W&&(x({enableMetadataSigning:null!==(e=W.enableMetadataSigning)&&void 0!==e&&e,metadataValidityPeriod:null!==(t=W.metadataValidityPeriod)&&void 0!==t?t:0}),z(W.destinationURLs.length>0?W.destinationURLs.toString():""))}),[W]);var te=function(){F((0,c.V_)({description:P("saml2Config:notifications.getConfiguration.error.description"),level:s.QU.ERROR,message:P("saml2Config:notifications.getConfiguration.error.message")}))},ne=function(){k(!0),function(){var e={headers:{Accept:"application/json","Content-Type":"application/json"},method:s.f2.DELETE,url:S.D.getServiceResourceEndpoints().saml2Configurations};return N(e).then((function(e){if(204!==e.status)throw new l.u(T.ErrorMessages.SAML2_CONFIG_REVERT_INVALID_STATUS_CODE_ERROR_CODE.getErrorMessage(),null,e.status,e.request,e,e.config);return Promise.resolve()})).catch((function(e){var t,n=T.ErrorMessages.SAML2_CONFIG_REVERT_ERROR_CODE.getErrorMessage();throw new l.u(n,e.stack,null===(t=e.response)||void 0===t||null===(t=t.data)||void 0===t?void 0:t.code,e.request,e.response,e.config)}))}().then((function(){F((0,c.V_)({description:P("saml2Config:notifications.revertConfiguration.success.description"),level:s.QU.SUCCESS,message:P("saml2Config:notifications.revertConfiguration.success.message")}))})).catch((function(){F((0,c.V_)({description:P("saml2Config:notifications.revertConfiguration.error.description"),level:s.QU.ERROR,message:P("saml2Config:notifications.revertConfiguration.error.message")}))})).finally((function(){k(!1),Y()}))};return g.createElement(m.Xg,{title:P("saml2Config:title"),pageTitle:P("saml2Config:title"),description:P("saml2Config:description"),backButton:{onClick:function(){r.m.push(o.$.getPaths().get("LOGIN_AND_REGISTRATION"))},text:P("governanceConnectors:goBackLoginAndRegistration")},bottomMargin:!1,contentTopMargin:!1,"data-componentid":"".concat(L,"-form-layout"),pageHeaderMaxWidth:!0},g.createElement(v.R,{innerRef:A},g.createElement(_.Z,{className:"mt-2"},g.createElement(_.Z.Row,{columns:1},g.createElement(_.Z.Column,{width:16},g.createElement(m.pJ,{className:"form-wrapper",padded:"very"},X?g.createElement(_.Z.Row,{columns:1},g.createElement("div",null,g.createElement("div",{className:"ui card fluid settings-card","data-testid":"".concat(L,"-loading-card")},g.createElement("div",{className:"content no-padding"},g.createElement("div",{className:"header-section"},g.createElement(R.Z,null,g.createElement(R.Z.Header,null,g.createElement(R.Z.Line,{length:"medium"}),g.createElement(R.Z.Line,{length:"full"}))),g.createElement(p.Z,{hidden:!0}))),g.createElement("div",{className:"content extra extra-content"},g.createElement("div",{className:"action-button"},g.createElement(R.Z,null,g.createElement(R.Z.Line,{length:"very short"}))))),g.createElement(p.Z,{hidden:!0}))):g.createElement(g.Fragment,null,g.createElement(d.l0,{key:JSON.stringify(H)||"empty",id:"saml2-config-form",uncontrolledForm:!0,onSubmit:function(e){k(!0),function(e){var t={data:e,headers:{Accept:"application/json","Content-Type":"application/json"},method:s.f2.PATCH,url:S.D.getServiceResourceEndpoints().saml2Configurations};return N(t).then((function(e){if(200!==e.status&&201!==e.status)throw new l.u(T.ErrorMessages.SAML2_CONFIG_FETCH_INVALID_STATUS_CODE_ERROR_CODE.getErrorMessage(),null,e.status,e.request,e,e.config);return Promise.resolve(e.data)})).catch((function(e){var t,n=T.ErrorMessages.SAML2_CONFIG_UPDATE_ERROR_CODE.getErrorMessage();throw new l.u(n,e.stack,null===(t=e.response)||void 0===t||null===(t=t.data)||void 0===t?void 0:t.code,e.request,e.response,e.config)}))}({destinationURLs:null==Q?void 0:Q.split(","),enableMetadataSigning:e.enableMetadataSigning,metadataValidityPeriod:e.metadataValidityPeriod}).then((function(){F((0,c.V_)({description:P("saml2Config:notifications.updateConfiguration.success.description"),level:s.QU.SUCCESS,message:P("saml2Config:notifications.updateConfiguration.success.message")}))})).catch((function(){F((0,c.V_)({description:P("saml2Config:notifications.updateConfiguration.error.description"),level:s.QU.ERROR,message:P("saml2Config:notifications.updateConfiguration.error.message")}))})).finally((function(){k(!1),Y()}))},initialValues:H,enableReinitialize:!0,ref:w,validate:function(e){var t={destinationURLs:void 0,metadataValidityPeriod:void 0};return null!=e&&e.metadataValidityPeriod&&(!f.I.isInteger(e.metadataValidityPeriod)||e.metadataValidityPeriod<0)&&(t.metadataValidityPeriod=P("saml2Config:form.validation.metadataValidityPeriod")),null!=e&&e.destinationURLs&&e.destinationURLs.length>0&&(t.destinationURLs=P("saml2Config:form.validation.destinationURLs")),t},autoComplete:"new-password"},g.createElement(_.Z,null,g.createElement(_.Z.Row,{columns:1,key:3},g.createElement(_.Z.Column,{width:10},g.createElement(d.gN.Checkbox,{ariaLabel:P("saml2Config:form.enableMetadataSigning.label"),name:"enableMetadataSigning",label:P("saml2Config:form.enableMetadataSigning.label"),readOnly:V,"data-componentid":"".concat(L,"-\n                                                                    enable-metadata-signing"),toggle:!0}))),g.createElement(_.Z.Row,{columns:1,key:1},g.createElement(_.Z.Column,{width:10},g.createElement(d.gN.Input,{min:T.SAML2_CONFIG_FIELD_MIN_LENGTH,ariaLabel:P("saml2Config:form.metadataValidityPeriod.label"),inputType:"number",name:"metadataValidityPeriod",label:P("saml2Config:form.metadataValidityPeriod.label"),hint:P("saml2Config:form.metadataValidityPeriod.hint"),value:null==H?void 0:H.metadataValidityPeriod,readOnly:V,minLength:T.SAML2_CONFIG_FIELD_MIN_LENGTH,maxLength:null,"data-componentid":"".concat(L,"-metadata-validity-period"),autoComplete:"new-password"}))),(null==D?void 0:D.deprecatedProperties.includes("destinationURLs.pattern"))&&g.createElement(_.Z.Row,{columns:1,key:2},g.createElement(_.Z.Column,{width:10,key:"destinationUrl"},g.createElement("div",{ref:I}),g.createElement(m.wE,{urlState:Q,setURLState:function(e){var t,n=null==e||null===(t=e.split(","))||void 0===t?void 0:t.toString();z(n)},labelName:P("saml2Config:form.destinationUrl.label"),hint:P("saml2Config:form.destinationUrl.hint"),required:!0,showError:B,setShowError:J,validationErrorMsg:P("saml2Config:form.validation.destinationURLs"),validation:function(e){return!!u.URLUtils.isURLValid(e,!0)||(J(!0),!1)},readOnly:V,addURLTooltip:P("common:addURL"),duplicateURLErrorMessage:P("common:duplicateURLError"),"data-componentid":"".concat(L,"\n                                                                            -destination-url-input"),showPredictions:!1}))))),!V&&g.createElement(g.Fragment,null,g.createElement(p.Z,{hidden:!0}),g.createElement(_.Z.Row,{columns:1,className:"mt-6"},g.createElement(_.Z.Column,{width:10},g.createElement(m.KM,{size:"small",loading:G,onClick:function(){var e;null==w||null===(e=w.current)||void 0===e||e.triggerSubmit()},ariaLabel:"saml2 configuration form update button","data-componentid":"".concat(L,"-update-button")},P("common:update"))))))))),!V&&g.createElement(_.Z.Row,{columns:1,className:"mt-6"},g.createElement(_.Z.Column,{width:16},g.createElement(m.v9,{sectionHeader:P("common:dangerZone")},g.createElement(m.cN,{actionTitle:P("governanceConnectors:dangerZone.actionTitle"),header:P("governanceConnectors:dangerZone.heading"),subheader:P("governanceConnectors:dangerZone.subHeading"),onActionClick:function(){return ne()},"data-testid":"".concat(L,"-danger-zone")})))))))};U.defaultProps={"data-componentid":"saml2-configuration-settings-page"};const V=U}}]);