"use strict";(self.webpackChunk_wso2is_console=self.webpackChunk_wso2is_console||[]).push([[3819],{3819:(e,t,n)=>{n.r(t),n.d(t,{default:()=>M});var r=n(55007),a=n(52820),o=n(60486),i=n(40838),s=n(41355),l=n(48704),c=n(21257),u=n(4717),d=n(47149),m=n(86329),f=n(98499),v=n(82555),p=n(2802),g=n(22669),h=n(58613),y=n(86105),A=n(6833),E=n(82406),S=n(20494),O=n(44194),U=n(10479),b=n(59673),I=n(47245),R=n(26154),_=n(13692);function N(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,i,s=[],l=!0,c=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);l=!0);}catch(e){c=!0,a=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(c)throw a}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return C(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?C(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function C(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}const M=function(e){var t,n,C,M,T=e["data-componentid"],w=void 0===T?"console-administrators-edit-page":T,P=(0,U.$)().t,k=(0,I.I0)(),D=(0,c.z)().isSuperOrganization,G=(0,h.Z)(),L=G.isUserStoreReadOnly,F=G.readOnlyUserStoreNamesList,x=(0,I.v9)((function(e){return e.config.ui.features})),Z=(0,I.v9)((function(e){return e.profile.profileInfo})),j=(0,r.EV)(null==x||null===(t=x.users)||void 0===t||null===(t=t.scopes)||void 0===t?void 0:t.update),$=(0,y.cr)(null==x?void 0:x.users,v._F.FEATURE_DICTIONARY.get("USER_UPDATE")),B=(0,y.cr)(null==x?void 0:x.users,v._F.FEATURE_DICTIONARY.get("USER_SHARED_PROFILES")),V=N((0,O.useState)(A.I),2),z=V[0],Q=V[1],Y=N((0,O.useState)(!1),2),H=Y[0],K=Y[1],W=N((0,O.useState)(!1),2),X=W[0],q=W[1],J=N((0,O.useState)(void 0),2),ee=J[0],te=J[1],ne=N((0,O.useState)(!1),2),re=ne[0],ae=ne[1],oe=(0,O.useMemo)((function(){var e,t,n=(null==z||null===(e=z.userName)||void 0===e?void 0:e.split("/").length)>1?null==z||null===(t=z.userName)||void 0===t?void 0:t.split("/")[0]:l.w.primaryUserstoreName;return L(n)}),[z,F]),ie=!$||!j||oe||(null===(n=z[s.k.scim.systemSchema])||void 0===n?void 0:n.userSourceId)||"true"===(null===(C=z[s.k.scim.systemSchema])||void 0===C?void 0:C.isReadOnlyUser)||(null===(M=z[s.k.scim.systemSchema])||void 0===M?void 0:M.managedOrg)&&!B;(0,O.useEffect)((function(){if(!D){var e=[];(0,u.aA)(d.v.ACCOUNT_MANAGEMENT_CATEGORY_ID).then((function(t){t.map((function(t){t.id!==d.v.ACCOUNT_DISABLING_CONNECTOR_ID&&t.id!==d.v.ADMIN_FORCE_PASSWORD_RESET_CONNECTOR_ID||t.properties.map((function(t){e.push(t)}))})),(0,u.aA)(d.v.USER_ONBOARDING_CONNECTOR_ID).then((function(t){t.map((function(t){t.id===d.v.SELF_SIGN_UP_CONNECTOR_ID&&t.properties.map((function(t){t.name===d.v.ACCOUNT_LOCK_ON_CREATION&&e.push(t)}))})),te(e)}))}))}}),[]),(0,O.useEffect)((function(){var e=i.m.location.pathname.split("/"),t=e[e.length-1];ce(t)}),[]);var se,le,ce=function(e){K(!0),(0,m.M_)(e,null).then((function(e){Q(e)})).catch((function(){})).finally((function(){K(!1)}))},ue=function(e){ce(e),g.QH.isAuthenticatedUser(null==Z?void 0:Z.userName,null==z?void 0:z.userName)&&k((0,a.G)())};return O.createElement(p.Z,null,O.createElement(S.O9,{isLoading:H,title:O.createElement(O.Fragment,null,void 0!==(null==z?void 0:z.active)?O.createElement(O.Fragment,null,null!=z&&z.active?O.createElement(S.GI,{trigger:O.createElement(R.Z,{className:"mr-2 ml-0 vertical-aligned-baseline",size:"small",name:"circle",color:"green"}),content:P("common:enabled"),inverted:!0}):O.createElement(S.GI,{trigger:O.createElement(R.Z,{className:"mr-2 ml-0 vertical-aligned-baseline",size:"small",name:"circle",color:"orange"}),content:P("common:disabled"),inverted:!0}),(0,y.nk)(z,null,"Administrator")):O.createElement(O.Fragment,null,(0,y.nk)(z,null,"Administrator"))),pageTitle:"Edit User",description:P(""+z.emails&&void 0!==z.emails?(se=null==z?void 0:z.emails,le="",se&&Array.isArray(se)&&se.length>0&&(le=se.find((function(e){return"string"==typeof e}))),le):z.userName),image:O.createElement(S.Yt,{editable:!ie,hoverable:!ie,name:(0,y.nk)(z),size:"tiny",image:null==z?void 0:z.profileUrl,onClick:function(){return!ie&&q(!0)}}),loadingStateOptions:{count:5,imageType:"circular"},backButton:{"data-testid":"user-mgt-edit-user-back-button",onClick:function(){i.m.push(o.$.getPaths().get("CONSOLE_SETTINGS")+"#tab=".concat(_.w.ADMINISTRATORS))},text:P("consoleSettings:administrators.edit.backButton")},titleTextAlign:"left",bottomMargin:!1,"data-componentid":w},O.createElement(f.X,{user:z,handleUserUpdate:ue,connectorProperties:ee,isLoading:H,isReadOnly:ie,isReadOnlyUserStore:oe}),X&&O.createElement(S.Oi,{open:X,name:(0,y.nk)(z),emails:(0,y.r1)(null==z?void 0:z.emails),onClose:function(){return q(!1)},closeOnDimmerClick:!1,onCancel:function(){return q(!1)},onSubmit:function(e,t){var n={Operations:[{op:"replace",value:{profileUrl:t}}],schemas:["urn:ietf:params:scim:api:messages:2.0:PatchOp"]};ae(!0),(0,m.gS)(null==z?void 0:z.id,n).then((function(){k((0,E.V_)({description:P("user:profile.notifications.updateProfileInfo.success.description"),level:A.QU.SUCCESS,message:P("user:profile.notifications.updateProfileInfo.success.message")})),ue(null==z?void 0:z.id)})).catch((function(e){e.response&&e.response.data&&(e.response.data.description||e.response.data.detail)?k((0,E.V_)({description:e.response.data.description||e.response.data.detail,level:A.QU.ERROR,message:P("user:profile.notifications.updateProfileInfo.error.message")})):k((0,E.V_)({description:P("user:profile.notifications.updateProfileInfo.genericError.description"),level:A.QU.ERROR,message:P("user:profile.notifications.updateProfileInfo.genericError.message")}))})).finally((function(){q(!1),ae(!1)}))},imageUrl:null==Z?void 0:Z.profileUrl,isSubmitting:re,heading:P("console:common.modals.editAvatarModal.heading"),submitButtonText:P("console:common.modals.editAvatarModal.primaryButton"),cancelButtonText:P("console:common.modals.editAvatarModal.secondaryButton"),translations:{gravatar:{errors:{noAssociation:{content:O.createElement(b.c,{i18nKey:"console:common.modals.editAvatarModal.content.gravatarerrors.noAssociation.content"},"It seems like the selected email is not registered on Gravatar. Sign up for a Gravatar account by visiting\xa0",O.createElement("a",{href:"https://www.gravatar.com"},"Gravatar Official Website"),"\xa0or use one of the following."),header:P("console:common.modals.editAvatarModal.content.gravatar.errors.noAssociation.header")}},heading:P("console:common.modals.editAvatarModal.content.gravatar.heading")},hostedAvatar:{heading:P("console:common.modals.editAvatarModal.content.hostedAvatar.heading"),input:{errors:{http:{content:P("console:common.modals.editAvatarModal.content.hostedAvatar.input.errors.http.content"),header:P("console:common.modals.editAvatarModal.content.hostedAvatar.input.errors.http.header")},invalid:{content:P("console:common.modals.editAvatarModal.content.hostedAvatar.input.errors.invalid.content"),pointing:P("console:common.modals.editAvatarModal.content.hostedAvatar.input.errors.invalid.pointing")}},hint:P("console:common.modals.editAvatarModal.content.hostedAvatar.input.hint"),placeholder:P("console:common.modals.editAvatarModal.content.hostedAvatar.input.placeholder"),warnings:{dataURL:{content:P("console:common.modals.editAvatarModal.content.hostedAvatar.input.warnings.dataURL.content"),header:P("console:common.modals.editAvatarModal.content.hostedAvatar.input.warnings.dataURL.header")}}}},systemGenAvatars:{heading:P("console:common.modals.editAvatarModal.content.systemGenAvatars.heading"),types:{initials:P("console:common.modals.editAvatarModal.content.systemGenAvatars.types.initials")}}}})))}},98499:(e,t,n)=>{n.d(t,{X:()=>R});var r=n(76271),a=n(41355),o=n(21257),i=n(61339),s=n(58613),l=n(86105),c=n(6833),u=n(82406),d=n(20494),m=n(44194),f=n(10479),v=n(47245),p=n(89141),g=n(62508),h=n(9544),y=n(73237),A=n(31463),E=n(13731),S=n(92283),O=n(83953);const U=function(){var e=(0,m.useContext)(O.Z);if(!e)throw new Error("useUserManagement must be used within a UserManagementProvider");return e};function b(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,i,s=[],l=!0,c=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);l=!0);}catch(e){c=!0,a=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(c)throw a}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return I(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?I(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function I(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var R=function(e){var t=e.user,n=e.handleUserUpdate,O=e.connectorProperties,I=e.isLoading,R=e.isReadOnly,_=void 0!==R&&R,N=e.isReadOnlyUserStore,C=void 0!==N&&N,M=(0,f.$)().t,T=U(),w=T.activeTab,P=T.updateActiveTab,k=(0,v.I0)(),D=(0,o.z)().isSuperOrganization,G=(0,s.Z)().isLoading,L=b((0,m.useState)(!1),2),F=L[0],x=L[1],Z=b((0,m.useState)(!1),2),j=Z[0],$=Z[1],B=b((0,m.useState)(!1),2),V=B[0],z=B[1],Q=b((0,m.useState)(!1),2),Y=Q[0],H=Q[1],K=b((0,m.useState)(null),2),W=K[0],X=K[1],q=b((0,m.useState)(!1),2),J=q[0],ee=q[1],te=(0,v.v9)((function(e){var t;return null===(t=e.config.ui.features)||void 0===t?void 0:t.users})),ne=(0,l.cr)(te,S._F.FEATURE_DICTIONARY.get(S.Oq.UserGroups));(0,m.useEffect)((function(){D()&&ae()}),[t]),(0,m.useEffect)((function(){var e;null!==(e=t[a.k.scim.systemSchema])&&void 0!==e&&e.managedOrg&&ee(!0)}),[t]);var re=function(e){k((0,u.V_)(e))},ae=function(){z(!0),(0,i.U)().then((function(e){var n=r.h.getState().profile.profileInfo.userName,a=null==e?void 0:e.realmConfig.adminUser;X(a),n===a&&x(!0),(null==t?void 0:t.userName)===a&&$(!0)})).catch((function(e){H(!0),e.response&&e.response.data&&(e.response.data.description||e.response.data.detail)?k((0,u.V_)({description:e.response.data.description||e.response.data.detail,level:c.QU.ERROR,message:M("users:userSessions.notifications.getAdminUser.error.message")})):k((0,u.V_)({description:M("users:userSessions.notifications.getAdminUser.genericError.description"),level:c.QU.ERROR,message:M("users:userSessions.notifications.getAdminUser.genericError.message")}))})).finally((function(){z(!1)}))},oe=(0,m.useMemo)((function(){var e,r=[];return r.push({menuItem:M("users:editUser.tab.menuItems.0"),render:function(){var e;return m.createElement(d.M$.Pane,{controlledSegmentation:!0,attached:!1},m.createElement(y.I,{adminUsername:W,onAlertFired:re,user:t,handleUserUpdate:n,isReadOnly:_,connectorProperties:O,isReadOnlyUserStoresLoading:G,isReadOnlyUserStore:C,isUserManagedByParentOrg:J,adminUserType:S.lu.INTERNAL,allowDeleteOnly:"true"===(null===(e=t[a.k.scim.systemSchema])||void 0===e?void 0:e.isReadOnlyUser),editUserDisclaimerMessage:m.createElement(p.Z,null,m.createElement(p.Z.Row,{columns:1},m.createElement(p.Z.Column,{mobile:12,tablet:12,computer:6},m.createElement(d.v0,{type:"info",content:M("extensions:manage.users.editUserProfile.disclaimerMessage")}),m.createElement(g.Z,{hidden:!0}))))}))}}),(ne||1!==(null==t||null===(e=t.userName)||void 0===e?void 0:e.split("/").length))&&r.push({menuItem:M("users:editUser.tab.menuItems.1"),render:function(){return m.createElement(d.M$.Pane,{controlledSegmentation:!0,attached:!1},m.createElement(h.V,{onAlertFired:re,user:t,handleUserUpdate:n,isReadOnly:_}))}}),r.push({menuItem:M("users:editUser.tab.menuItems.2"),render:function(){return m.createElement(d.M$.Pane,{controlledSegmentation:!0,attached:!1},m.createElement(A.e,{user:t}))}},{menuItem:M("users:editUser.tab.menuItems.3"),render:function(){return m.createElement(d.M$.Pane,{controlledSegmentation:!0,attached:!1},m.createElement(E.Y,{user:t,showSessionTerminationButton:!V&&!Y&&(j&&F||!j&&F||!j&&!F)}))}}),r}),[t,ne,O,V,Y,j,F,_,G,C,J]);return m.createElement(d.M$,{activeIndex:w,isLoading:I,onTabChange:function(e,t){P(t.activeIndex)},panes:oe})}},83953:(e,t,n)=>{n.d(t,{Z:()=>a});var r=(0,n(44194).createContext)(null);r.displayName="UserManagementContext";const a=r},2802:(e,t,n)=>{n.d(t,{Z:()=>s});var r=n(44194),a=n(83953);function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,i,s=[],l=!0,c=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);l=!0);}catch(e){c=!0,a=e}finally{try{if(!l&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(c)throw a}}return s}}(e,t)||function(e,t){if(e){if("string"==typeof e)return i(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}const s=function(e){var t=e.children,n=o((0,r.useState)(0),2),i=n[0],s=n[1];return r.createElement(a.Z.Provider,{value:{activeTab:i,updateActiveTab:s}},t)}}}]);